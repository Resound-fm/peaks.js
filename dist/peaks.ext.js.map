{"version":3,"file":"peaks.ext.js","sources":["../node_modules/eventemitter3/index.js","../src/cue.js","../src/utils.js","../src/cue-emitter.js","../src/point.js","../src/waveform-points.js","../src/segment.js","../src/waveform-segments.js","../src/keyboard-handler.js","../src/mediaelement-player.js","../src/player.js","../src/default-point-marker.js","../src/default-segment-marker.js","../src/marker-factories.js","../src/scrollbar.js","../src/highlight-layer.js","../src/mouse-drag-handler.js","../src/playhead-layer.js","../src/point-marker.js","../src/points-layer.js","../src/overlay-segment-marker.js","../src/segment-marker.js","../src/waveform-shape.js","../src/segment-shape.js","../src/segments-layer.js","../src/waveform-axis.js","../src/waveform-overview.js","../src/waveform-zoomview.js","../src/view-controller.js","../src/zoom-controller.js","../src/waveform-builder.js","../src/main.js"],"sourcesContent":["'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","/**\n * @file\n *\n * Defines the {@link Cue} class.\n *\n * @module cue\n */\n\n/**\n * A cue represents an event to be triggered at some point on the media\n * timeline.\n *\n * @class\n * @alias Cue\n *\n * @param {Number} time Cue time, in seconds.\n * @param {Number} type Cue mark type, either <code>Cue.POINT</code>,\n *   <code>Cue.SEGMENT_START</code>, or <code>Cue.SEGMENT_END</code>.\n * @param {String} id The id of the {@link Point} or {@link Segment}.\n */\n\nfunction Cue(time, type, id) {\n  this.time = time;\n  this.type = type;\n  this.id = id;\n}\n\n/**\n  * @constant\n  * @type {Number}\n  */\n\nCue.POINT = 0;\nCue.SEGMENT_START = 1;\nCue.SEGMENT_END = 2;\n\n/**\n * Callback function for use with Array.prototype.sort().\n *\n * @static\n * @param {Cue} a\n * @param {Cue} b\n * @return {Number}\n */\n\nCue.sorter = function(a, b) {\n  return a.time - b.time;\n};\n\nexport default Cue;\n","import Konva from 'konva/lib/Core';\n\nfunction zeroPad(number, precision) {\n  number = number.toString();\n\n  while (number.length < precision) {\n    number = '0' + number;\n  }\n\n  return number;\n}\n\n/**\n * Returns a formatted time string.\n *\n * @param {Number} time The time to be formatted, in seconds.\n * @param {Number} precision Decimal places to which time is displayed\n * @returns {String}\n */\n\nexport function formatTime(time, precision) {\n  let result = [];\n\n  const fractionSeconds = Math.floor((time % 1) * Math.pow(10, precision));\n  const seconds = Math.floor(time);\n  const minutes = Math.floor(seconds / 60);\n  const hours = Math.floor(minutes / 60);\n\n  if (hours > 0) {\n    result.push(hours); // Hours\n  }\n  result.push(minutes % 60); // Mins\n  result.push(seconds % 60); // Seconds\n\n  for (let i = 0; i < result.length; i++) {\n    result[i] = zeroPad(result[i], 2);\n  }\n\n  result = result.join(':');\n\n  if (precision > 0) {\n    result += '.' + zeroPad(fractionSeconds, precision);\n  }\n\n  return result;\n}\n\n/**\n * Rounds the given value up to the nearest given multiple.\n *\n * @param {Number} value\n * @param {Number} multiple\n * @returns {Number}\n *\n * @example\n * roundUpToNearest(5.5, 3); // returns 6\n * roundUpToNearest(141.0, 10); // returns 150\n * roundUpToNearest(-5.5, 3); // returns -6\n */\n\nexport function roundUpToNearest(value, multiple) {\n  if (multiple === 0) {\n    return 0;\n  }\n\n  let multiplier = 1;\n\n  if (value < 0.0) {\n    multiplier = -1;\n    value = -value;\n  }\n\n  const roundedUp = Math.ceil(value);\n\n  return multiplier * (((roundedUp + multiple - 1) / multiple) | 0) * multiple;\n}\n\nexport function clamp(value, min, max) {\n  if (value < min) {\n    return min;\n  }\n  else if (value > max) {\n    return max;\n  }\n  else {\n    return value;\n  }\n}\n\nexport function objectHasProperty(object, field) {\n  return Object.prototype.hasOwnProperty.call(object, field);\n}\n\nexport function extend(to, from) {\n  for (const key in from) {\n    if (objectHasProperty(from, key)) {\n      to[key] = from[key];\n    }\n  }\n\n  return to;\n}\n\n/**\n * Checks whether the given array contains values in ascending order.\n *\n * @param {Array<Number>} array The array to test\n * @returns {Boolean}\n */\n\nexport function isInAscendingOrder(array) {\n  if (array.length === 0) {\n    return true;\n  }\n\n  let value = array[0];\n\n  for (let i = 1; i < array.length; i++) {\n    if (value >= array[i]) {\n      return false;\n    }\n\n    value = array[i];\n  }\n\n  return true;\n}\n\n/**\n * Checks whether the given value is a number.\n *\n * @param {Number} value The value to test\n * @returns {Boolean}\n */\n\nexport function isNumber(value) {\n  return typeof value === 'number';\n}\n\n/**\n * Checks whether the given value is a finite number.\n *\n * @param {Number} value The value to test\n * @returns {Boolean}\n */\n\nexport function isFinite(value) {\n  if (typeof value !== 'number') {\n    return false;\n  }\n\n  // Check for NaN and infinity\n  // eslint-disable-next-line no-self-compare\n  if (value !== value || value === Infinity || value === -Infinity) {\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Checks whether the given value is a valid timestamp.\n *\n * @param {Number} value The value to test\n * @returns {Boolean}\n */\n\nexport function isValidTime(value) {\n  return (typeof value === 'number') && Number.isFinite(value);\n}\n\n/**\n * Checks whether the given value is a valid object.\n *\n * @param {Object|Array} value The value to test\n * @returns {Boolean}\n */\n\nexport function isObject(value) {\n  return (value !== null) && (typeof value === 'object')\n    && !Array.isArray(value);\n}\n\n/**\n * Checks whether the given value is a valid string.\n *\n * @param {String} value The value to test\n * @returns {Boolean}\n */\n\nexport function isString(value) {\n  return typeof value === 'string';\n}\n\n/**\n * Checks whether the given value is a valid ArrayBuffer.\n *\n * @param {ArrayBuffer} value The value to test\n * @returns {Boolean}\n */\n\nexport function isArrayBuffer(value) {\n  return Object.prototype.toString.call(value).includes('ArrayBuffer');\n}\n\n/**\n * Checks whether the given value is null or undefined.\n *\n * @param {Object} value The value to test\n * @returns {Boolean}\n */\n\nexport function isNullOrUndefined(value) {\n  return value === undefined || value === null;\n}\n\n/**\n * Checks whether the given value is a function.\n *\n * @param {Function} value The value to test\n * @returns {Boolean}\n */\n\nexport function isFunction(value) {\n  return typeof value === 'function';\n}\n\n/**\n * Checks whether the given value is a boolean.\n *\n * @param {Function} value The value to test\n * @returns {Boolean}\n */\n\nexport function isBoolean(value) {\n  return value === true || value === false;\n}\n\n/**\n * Checks whether the given value is a valid HTML element.\n *\n * @param {HTMLElement} value The value to test\n * @returns {Boolean}\n */\n\nexport function isHTMLElement(value) {\n  return value instanceof HTMLElement;\n}\n\n/**\n * Checks whether the given value is an array\n *\n * @param {Function} value The value to test\n * @returns {Boolean}\n */\n\nexport function isArray(value) {\n  return Array.isArray(value);\n}\n\n/**\n * Checks whether the given value is a valid linear gradient color\n *\n * @param {Function} value The value to test\n * @returns {Boolean}\n */\n\nexport function isLinearGradientColor(value) {\n  return isObject(value) &&\n    objectHasProperty(value, 'linearGradientStart') &&\n    objectHasProperty(value, 'linearGradientEnd') &&\n    objectHasProperty(value, 'linearGradientColorStops') &&\n    isNumber(value.linearGradientStart) &&\n    isNumber(value.linearGradientEnd) &&\n    isArray(value.linearGradientColorStops) &&\n    value.linearGradientColorStops.length === 2;\n}\n\nexport function getMarkerObject(obj) {\n  while (obj.parent !== null) {\n    if (obj.parent instanceof Konva.Layer) {\n      return obj;\n    }\n\n    obj = obj.parent;\n  }\n\n  return null;\n}\n","/**\n * @file\n *\n * Defines the {@link CueEmitter} class.\n *\n * @module cue-emitter\n */\n\nimport Cue from './cue';\nimport { objectHasProperty } from './utils';\n\nconst isHeadless = /HeadlessChrome/.test(navigator.userAgent);\n\nfunction windowIsVisible() {\n  if (isHeadless || navigator.webdriver) {\n    return false;\n  }\n\n  return (typeof document === 'object') &&\n    ('visibilityState' in document) &&\n    (document.visibilityState === 'visible');\n}\n\nconst requestAnimationFrame =\n  window.requestAnimationFrame ||\n  window.mozRequestAnimationFrame ||\n  window.webkitRequestAnimationFrame ||\n  window.msRequestAnimationFrame;\n\nconst cancelAnimationFrame =\n  window.cancelAnimationFrame ||\n  window.mozCancelAnimationFrame ||\n  window.webkitCancelAnimationFrame ||\n  window.msCancelAnimationFrame;\n\nconst eventTypes = {\n  forward: {},\n  reverse: {}\n};\n\nconst EVENT_TYPE_POINT = 0;\nconst EVENT_TYPE_SEGMENT_ENTER = 1;\nconst EVENT_TYPE_SEGMENT_EXIT = 2;\n\neventTypes.forward[Cue.POINT] = EVENT_TYPE_POINT;\neventTypes.forward[Cue.SEGMENT_START] = EVENT_TYPE_SEGMENT_ENTER;\neventTypes.forward[Cue.SEGMENT_END] = EVENT_TYPE_SEGMENT_EXIT;\n\neventTypes.reverse[Cue.POINT] = EVENT_TYPE_POINT;\neventTypes.reverse[Cue.SEGMENT_START] = EVENT_TYPE_SEGMENT_EXIT;\neventTypes.reverse[Cue.SEGMENT_END] = EVENT_TYPE_SEGMENT_ENTER;\n\nconst eventNames = {};\n\neventNames[EVENT_TYPE_POINT] = 'points.enter';\neventNames[EVENT_TYPE_SEGMENT_ENTER] = 'segments.enter';\neventNames[EVENT_TYPE_SEGMENT_EXIT] = 'segments.exit';\n\n/**\n * Given a cue instance, returns the corresponding {@link Point}\n * {@link Segment}.\n *\n * @param {Peaks} peaks\n * @param {Cue} cue\n * @return {Point|Segment}\n * @throws {Error}\n */\n\nfunction getPointOrSegment(peaks, cue) {\n  switch (cue.type) {\n    case Cue.POINT:\n      return peaks.points.getPoint(cue.id);\n\n    case Cue.SEGMENT_START:\n    case Cue.SEGMENT_END:\n      return peaks.segments.getSegment(cue.id);\n\n    default:\n      throw new Error('getPointOrSegment: id not found?');\n  }\n}\n\n/**\n * CueEmitter is responsible for emitting <code>points.enter</code>,\n * <code>segments.enter</code>, and <code>segments.exit</code> events.\n *\n * @class\n * @alias CueEmitter\n *\n * @param {Peaks} peaks Parent {@link Peaks} instance.\n */\n\nfunction CueEmitter(peaks) {\n  this._cues = [];\n  this._peaks = peaks;\n  this._previousTime = -1;\n  this._updateCues = this._updateCues.bind(this);\n  // Event handlers:\n  this._onPlaying = this.onPlaying.bind(this);\n  this._onSeeked = this.onSeeked.bind(this);\n  this._onTimeUpdate = this.onTimeUpdate.bind(this);\n  this._onAnimationFrame = this.onAnimationFrame.bind(this);\n  this._rAFHandle = null;\n  this._activeSegments = {};\n  this._attachEventHandlers();\n}\n\n/**\n * This function is bound to all {@link Peaks} events relating to mutated\n * [Points]{@link Point} or [Segments]{@link Segment}, and updates the\n * list of cues accordingly.\n *\n * @private\n */\n\nCueEmitter.prototype._updateCues = function() {\n  const self = this;\n\n  const points = self._peaks.points.getPoints();\n  const segments = self._peaks.segments.getSegments();\n\n  self._cues.length = 0;\n\n  points.forEach(function(point) {\n    self._cues.push(new Cue(point.time, Cue.POINT, point.id));\n  });\n\n  segments.forEach(function(segment) {\n    self._cues.push(new Cue(segment.startTime, Cue.SEGMENT_START, segment.id));\n    self._cues.push(new Cue(segment.endTime, Cue.SEGMENT_END, segment.id));\n  });\n\n  self._cues.sort(Cue.sorter);\n\n  const time = self._peaks.player.getCurrentTime();\n\n  self._updateActiveSegments(time);\n};\n\n/**\n * Emits events for any cues passed through during media playback.\n *\n * @param {Number} time The current time on the media timeline.\n * @param {Number} previousTime The previous time on the media timeline when\n *   this function was called.\n */\n\nCueEmitter.prototype._onUpdate = function(time, previousTime) {\n  const isForward = time > previousTime;\n  let start;\n  let end;\n  let step;\n\n  if (isForward) {\n    start = 0;\n    end = this._cues.length;\n    step = 1;\n  }\n  else {\n    start = this._cues.length - 1;\n    end = -1;\n    step = -1;\n  }\n\n  // Cues are sorted\n  for (let i = start; isForward ? i < end : i > end; i += step) {\n    const cue = this._cues[i];\n\n    if (isForward ? cue.time > previousTime : cue.time < previousTime) {\n      if (isForward ? cue.time > time : cue.time < time) {\n        break;\n      }\n\n      // Cue falls between time and previousTime\n\n      const marker = getPointOrSegment(this._peaks, cue);\n\n      const eventType = isForward ? eventTypes.forward[cue.type] :\n                                    eventTypes.reverse[cue.type];\n\n      if (eventType === EVENT_TYPE_SEGMENT_ENTER) {\n        this._activeSegments[marker.id] = marker;\n      }\n      else if (eventType === EVENT_TYPE_SEGMENT_EXIT) {\n        delete this._activeSegments[marker.id];\n      }\n\n      this._peaks.emit(eventNames[eventType], marker);\n    }\n  }\n};\n\n// the next handler and onAnimationFrame are bound together\n// when the window isn't in focus, rAF is throttled\n// falling back to timeUpdate\n\nCueEmitter.prototype.onTimeUpdate = function(time) {\n  if (windowIsVisible()) {\n    return;\n  }\n\n  if (this._peaks.player.isPlaying() && !this._peaks.player.isSeeking()) {\n    this._onUpdate(time, this._previousTime);\n  }\n\n  this._previousTime = time;\n};\n\nCueEmitter.prototype.onAnimationFrame = function() {\n  const time = this._peaks.player.getCurrentTime();\n\n  if (!this._peaks.player.isSeeking()) {\n    this._onUpdate(time, this._previousTime);\n  }\n\n  this._previousTime = time;\n\n  if (this._peaks.player.isPlaying()) {\n    this._rAFHandle = requestAnimationFrame(this._onAnimationFrame);\n  }\n};\n\nCueEmitter.prototype.onPlaying = function() {\n  this._previousTime = this._peaks.player.getCurrentTime();\n  this._rAFHandle = requestAnimationFrame(this._onAnimationFrame);\n};\n\nCueEmitter.prototype.onSeeked = function(time) {\n  this._previousTime = time;\n\n  this._updateActiveSegments(time);\n};\n\nfunction getSegmentIdComparator(id) {\n  return function compareSegmentIds(segment) {\n    return segment.id === id;\n  };\n}\n\n/**\n * The active segments is the set of all segments which overlap the current\n * playhead position. This function updates that set and emits\n * <code>segments.enter</code> and <code>segments.exit</code> events.\n */\n\nCueEmitter.prototype._updateActiveSegments = function(time) {\n  const self = this;\n\n  const activeSegments = self._peaks.segments.getSegmentsAtTime(time);\n\n  // Remove any segments no longer active.\n\n  for (const id in self._activeSegments) {\n    if (objectHasProperty(self._activeSegments, id)) {\n      const segment = activeSegments.find(getSegmentIdComparator(id));\n\n      if (!segment) {\n        self._peaks.emit('segments.exit', self._activeSegments[id]);\n        delete self._activeSegments[id];\n      }\n    }\n  }\n\n  // Add new active segments.\n\n  activeSegments.forEach(function(segment) {\n    if (!(segment.id in self._activeSegments)) {\n      self._activeSegments[segment.id] = segment;\n      self._peaks.emit('segments.enter', segment);\n    }\n  });\n};\n\nconst events = [\n  'points.update',\n  'points.dragmove',\n  'points.add',\n  'points.remove',\n  'points.remove_all',\n  'segments.update',\n  'segments.dragged',\n  'segments.add',\n  'segments.remove',\n  'segments.remove_all'\n];\n\nCueEmitter.prototype._attachEventHandlers = function() {\n  this._peaks.on('player.timeupdate', this._onTimeUpdate);\n  this._peaks.on('player.playing', this._onPlaying);\n  this._peaks.on('player.seeked', this._onSeeked);\n\n  for (let i = 0; i < events.length; i++) {\n    this._peaks.on(events[i], this._updateCues);\n  }\n\n  this._updateCues();\n};\n\nCueEmitter.prototype._detachEventHandlers = function() {\n  this._peaks.off('player.timeupdate', this._onTimeUpdate);\n  this._peaks.off('player.playing', this._onPlaying);\n  this._peaks.off('player.seeked', this._onSeeked);\n\n  for (let i = 0; i < events.length; i++) {\n    this._peaks.off(events[i], this._updateCues);\n  }\n};\n\nCueEmitter.prototype.destroy = function() {\n  if (this._rAFHandle) {\n    cancelAnimationFrame(this._rAFHandle);\n    this._rAFHandle = null;\n  }\n\n  this._detachEventHandlers();\n\n  this._previousTime = -1;\n};\n\nexport default CueEmitter;\n","/**\n * @file\n *\n * Defines the {@link Point} class.\n *\n * @module point\n */\n\nimport {\n  isBoolean, isLinearGradientColor, isNullOrUndefined, isString,\n  isValidTime, objectHasProperty\n} from './utils';\n\nconst pointOptions = ['id', 'time', 'labelText', 'color', 'editable'];\n\nconst invalidOptions = [\n  'update', 'isVisible', 'peaks'\n];\n\nfunction setDefaultPointOptions(options) {\n  if (isNullOrUndefined(options.labelText)) {\n    options.labelText = '';\n  }\n\n  if (isNullOrUndefined(options.editable)) {\n    options.editable = false;\n  }\n}\n\nfunction validatePointOptions(options, updating) {\n  const context = updating ? 'update()' : 'add()';\n\n  if (!updating || (updating && objectHasProperty(options, 'time'))) {\n    if (!isValidTime(options.time)) {\n      // eslint-disable-next-line max-len\n      throw new TypeError('peaks.points.' + context + ': time should be a numeric value');\n    }\n  }\n\n  if (options.time < 0) {\n    // eslint-disable-next-line max-len\n    throw new RangeError('peaks.points.' + context + ': time should not be negative');\n  }\n\n  if (objectHasProperty(options, 'labelText') && !isString(options.labelText)) {\n    throw new TypeError('peaks.points.' + context + ': labelText must be a string');\n  }\n\n  if (objectHasProperty(options, 'editable') && !isBoolean(options.editable)) {\n    throw new TypeError('peaks.points.' + context + ': editable must be true or false');\n  }\n\n  if (objectHasProperty(options, 'color') &&\n    !isString(options.color) &&\n    !isLinearGradientColor(options.color)) {\n    // eslint-disable-next-line max-len\n    throw new TypeError('peaks.points.' + context + ': color must be a string or a valid linear gradient object');\n  }\n\n  invalidOptions.forEach(function(name) {\n    if (objectHasProperty(options, name)) {\n      throw new Error('peaks.points.' + context + ': invalid option name: ' + name);\n    }\n  });\n\n  pointOptions.forEach(function(name) {\n    if (objectHasProperty(options, '_' + name)) {\n      throw new Error('peaks.points.' + context + ': invalid option name: _' + name);\n    }\n  });\n}\n\n/**\n * A point is a single instant of time, with associated label and color.\n *\n * @class\n * @alias Point\n *\n * @param {Peaks} peaks A reference to the Peaks instance.\n * @param {String} id A unique identifier for the point.\n * @param {Number} time Point time, in seconds.\n * @param {String} labelText Point label text.\n * @param {String} color Point marker color.\n * @param {Boolean} editable If <code>true</code> the segment start and\n *   end times can be adjusted via the user interface.\n * @param {*} data Optional application specific data.\n */\n\nfunction Point(options) {\n  this._peaks = options.peaks;\n  this._setUserData(options);\n}\n\nPoint.prototype._setUserData = function(options) {\n  for (const key in options) {\n    if (objectHasProperty(options, key)) {\n      if (pointOptions.indexOf(key) === -1) {\n        this[key] = options[key];\n      }\n      else {\n        this['_' + key] = options[key];\n      }\n    }\n  }\n};\n\nObject.defineProperties(Point.prototype, {\n  id: {\n    enumerable: true,\n    get: function() {\n      return this._id;\n    }\n  },\n  time: {\n    enumerable: true,\n    get: function() {\n      return this._time;\n    }\n  },\n  labelText: {\n    get: function() {\n      return this._labelText;\n    }\n  },\n  color: {\n    enumerable: true,\n    get: function() {\n      return this._color;\n    }\n  },\n  editable: {\n    enumerable: true,\n    get: function() {\n      return this._editable;\n    }\n  }\n});\n\nPoint.prototype.update = function(options) {\n  if (objectHasProperty(options, 'id')) {\n    throw new Error('peaks.points.update(): id cannot be updated');\n  }\n\n  validatePointOptions(options, true);\n\n  this._setUserData(options);\n\n  this._peaks.emit('points.update', this, options);\n};\n\n/**\n * Returns <code>true</code> if the point lies with in a given time range.\n *\n * @param {Number} startTime The start of the time region, in seconds.\n * @param {Number} endTime The end of the time region, in seconds.\n * @returns {Boolean}\n */\n\nPoint.prototype.isVisible = function(startTime, endTime) {\n  return this.time >= startTime && this.time < endTime;\n};\n\nPoint.prototype._setTime = function(time) {\n  this._time = time;\n};\n\nexport { Point, setDefaultPointOptions, validatePointOptions };\n","/**\n * @file\n *\n * Defines the {@link WaveformPoints} class.\n *\n * @module waveform-points\n */\n\nimport { Point, setDefaultPointOptions, validatePointOptions } from './point';\nimport { extend, isNullOrUndefined, objectHasProperty } from './utils';\n\n/**\n * Point parameters.\n *\n * @typedef {Object} PointOptions\n * @global\n * @property {Number} point Point time, in seconds.\n * @property {Boolean=} editable If <code>true</code> the point time can be\n *   adjusted via the user interface.\n *   Default: <code>false</code>.\n * @property {String=} color Point marker color.\n *   Default: a random color.\n * @property {String=} labelText Point label text.\n *   Default: an empty string.\n * @property {String=} id A unique point identifier.\n *   Default: an automatically generated identifier.\n */\n\n/**\n * Handles all functionality related to the adding, removing and manipulation\n * of points. A point is a single instant of time.\n *\n * @class\n * @alias WaveformPoints\n *\n * @param {Peaks} peaks The parent Peaks object.\n */\n\nfunction WaveformPoints(peaks) {\n  this._peaks = peaks;\n  this._points = [];\n  this._pointsById = {};\n  this._pointIdCounter = 0;\n}\n\n/**\n * Returns a new unique point id value.\n *\n * @returns {String}\n */\n\nWaveformPoints.prototype._getNextPointId = function() {\n  return 'peaks.point.' + this._pointIdCounter++;\n};\n\n/**\n * Adds a new point object.\n *\n * @private\n * @param {Point} point\n */\n\nWaveformPoints.prototype._addPoint = function(point) {\n  this._points.push(point);\n\n  this._pointsById[point.id] = point;\n};\n\n/**\n * Creates a new point object.\n *\n * @private\n * @param {PointOptions} options\n * @returns {Point}\n */\n\nWaveformPoints.prototype._createPoint = function(options) {\n  const pointOptions = {};\n\n  extend(pointOptions, options);\n\n  if (isNullOrUndefined(pointOptions.id)) {\n    pointOptions.id = this._getNextPointId();\n  }\n\n  setDefaultPointOptions(pointOptions);\n\n  validatePointOptions(pointOptions, false);\n\n  pointOptions.peaks = this._peaks;\n\n  return new Point(pointOptions);\n};\n\n/**\n * Returns all points.\n *\n * @returns {Array<Point>}\n */\n\nWaveformPoints.prototype.getPoints = function() {\n  return this._points;\n};\n\n/**\n * Returns the point with the given id, or <code>undefined</code> if not found.\n *\n * @param {String} id\n * @returns {Point}\n */\n\nWaveformPoints.prototype.getPoint = function(id) {\n  return this._pointsById[id];\n};\n\n/**\n * Returns all points within a given time region.\n *\n * @param {Number} startTime The start of the time region, in seconds.\n * @param {Number} endTime The end of the time region, in seconds.\n * @returns {Array<Point>}\n */\n\nWaveformPoints.prototype.find = function(startTime, endTime) {\n  return this._points.filter(function(point) {\n    return point.isVisible(startTime, endTime);\n  });\n};\n\n/**\n * Adds one or more points to the timeline.\n *\n * @param {PointOptions|Array<PointOptions>} pointOrPoints\n *\n * @returns Point|Array<Point>\n */\n\nWaveformPoints.prototype.add = function(/* pointOrPoints */) {\n  const self = this;\n\n  const arrayArgs = Array.isArray(arguments[0]);\n  let points = arrayArgs ?\n               arguments[0] :\n               Array.prototype.slice.call(arguments);\n\n  points = points.map(function(pointOptions) {\n    const point = self._createPoint(pointOptions);\n\n    if (objectHasProperty(self._pointsById, point.id)) {\n      throw new Error('peaks.points.add(): duplicate id');\n    }\n\n    return point;\n  });\n\n  points.forEach(function(point) {\n    self._addPoint(point);\n  });\n\n  this._peaks.emit('points.add', points);\n\n  return arrayArgs ? points : points[0];\n};\n\n/**\n * Returns the indexes of points that match the given predicate.\n *\n * @private\n * @param {Function} predicate Predicate function to find matching points.\n * @returns {Array<Number>} An array of indexes into the points array of\n *   the matching elements.\n */\n\nWaveformPoints.prototype._findPoint = function(predicate) {\n  const indexes = [];\n\n  for (let i = 0, length = this._points.length; i < length; i++) {\n    if (predicate(this._points[i])) {\n      indexes.push(i);\n    }\n  }\n\n  return indexes;\n};\n\n/**\n * Removes the points at the given array indexes.\n *\n * @private\n * @param {Array<Number>} indexes The array indexes to remove.\n * @returns {Array<Point>} The removed {@link Point} objects.\n */\n\nWaveformPoints.prototype._removeIndexes = function(indexes) {\n  const removed = [];\n\n  for (let i = 0; i < indexes.length; i++) {\n    const index = indexes[i] - removed.length;\n\n    const itemRemoved = this._points.splice(index, 1)[0];\n\n    delete this._pointsById[itemRemoved.id];\n\n    removed.push(itemRemoved);\n  }\n\n  return removed;\n};\n\n/**\n * Removes all points that match a given predicate function.\n *\n * After removing the points, this function emits a\n * <code>points.remove</code> event with the removed {@link Point}\n * objects.\n *\n * @private\n * @param {Function} predicate A predicate function that identifies which\n *   points to remove.\n * @returns {Array<Point>} The removed {@link Points} objects.\n */\n\nWaveformPoints.prototype._removePoints = function(predicate) {\n  const indexes = this._findPoint(predicate);\n\n  const removed = this._removeIndexes(indexes);\n\n  this._peaks.emit('points.remove', removed);\n\n  return removed;\n};\n\n/**\n * Removes the given point.\n *\n * @param {Point} point The point to remove.\n * @returns {Array<Point>} The removed points.\n */\n\nWaveformPoints.prototype.remove = function(point) {\n  return this._removePoints(function(p) {\n    return p === point;\n  });\n};\n\n/**\n * Removes any points with the given id.\n *\n * @param {String} id\n * @returns {Array<Point>} The removed {@link Point} objects.\n */\n\nWaveformPoints.prototype.removeById = function(pointId) {\n  return this._removePoints(function(point) {\n    return point.id === pointId;\n  });\n};\n\n/**\n * Removes any points at the given time.\n *\n * @param {Number} time\n * @returns {Array<Point>} The removed {@link Point} objects.\n */\n\nWaveformPoints.prototype.removeByTime = function(time) {\n  return this._removePoints(function(point) {\n    return point.time === time;\n  });\n};\n\n/**\n * Removes all points.\n *\n * After removing the points, this function emits a\n * <code>points.remove_all</code> event.\n */\n\nWaveformPoints.prototype.removeAll = function() {\n  this._points = [];\n  this._pointsById = {};\n  this._peaks.emit('points.remove_all');\n};\n\nexport default WaveformPoints;\n","/**\n * @file\n *\n * Defines the {@link Segment} class.\n *\n * @module segment\n */\n\nimport {\n  isBoolean, isNullOrUndefined, isLinearGradientColor,\n  isString, isValidTime, objectHasProperty\n} from './utils';\n\nconst segmentOptions = [\n  'id', 'startTime', 'endTime', 'labelText', 'color', 'borderColor', 'editable'\n];\n\nconst invalidOptions = [\n  'update', 'isVisible', 'peaks'\n];\n\nfunction setDefaultSegmentOptions(options, globalSegmentOptions) {\n  if (isNullOrUndefined(options.color)) {\n    if (globalSegmentOptions.overlay) {\n      options.color = globalSegmentOptions.overlayColor;\n    }\n    else {\n      options.color = globalSegmentOptions.waveformColor;\n    }\n  }\n\n  if (isNullOrUndefined(options.borderColor)) {\n    options.borderColor = globalSegmentOptions.overlayBorderColor;\n  }\n\n  if (isNullOrUndefined(options.labelText)) {\n    options.labelText = '';\n  }\n\n  if (isNullOrUndefined(options.editable)) {\n    options.editable = false;\n  }\n}\n\nfunction validateSegmentOptions(options, updating) {\n  const context = updating ? 'update()' : 'add()';\n\n  if (objectHasProperty(options, 'startTime') && !isValidTime(options.startTime)) {\n    // eslint-disable-next-line max-len\n    throw new TypeError('peaks.segments.' + context + ': startTime should be a valid number');\n  }\n\n  if (objectHasProperty(options, 'endTime') && !isValidTime(options.endTime)) {\n    // eslint-disable-next-line max-len\n    throw new TypeError('peaks.segments.' + context + ': endTime should be a valid number');\n  }\n\n  if (!updating) {\n    if (!objectHasProperty(options, 'startTime') || !objectHasProperty(options, 'endTime')) {\n      throw new TypeError('peaks.segments.' + context + ': missing startTime or endTime');\n    }\n  }\n\n  if (options.startTime < 0) {\n    // eslint-disable-next-line max-len\n    throw new RangeError('peaks.segments.' + context + ': startTime should not be negative');\n  }\n\n  if (options.endTime < 0) {\n    // eslint-disable-next-line max-len\n    throw new RangeError('peaks.segments.' + context + ': endTime should not be negative');\n  }\n\n  if (options.endTime < options.startTime) {\n    // eslint-disable-next-line max-len\n    throw new RangeError('peaks.segments.' + context + ': endTime should not be less than startTime');\n  }\n\n  if (objectHasProperty(options, 'labelText') && !isString(options.labelText)) {\n    throw new TypeError('peaks.segments.' + context + ': labelText must be a string');\n  }\n\n  if (objectHasProperty(options, 'editable') && !isBoolean(options.editable)) {\n    throw new TypeError('peaks.segments.' + context + ': editable must be true or false');\n  }\n\n  if (objectHasProperty(options, 'color') &&\n    !isString(options.color) &&\n    !isLinearGradientColor(options.color)) {\n    // eslint-disable-next-line max-len\n    throw new TypeError('peaks.segments.' + context + ': color must be a string or a valid linear gradient object');\n  }\n\n  if (objectHasProperty(options, 'borderColor') && !isString(options.borderColor)) {\n    // eslint-disable-next-line max-len\n    throw new TypeError('peaks.segments.' + context + ': borderColor must be a string');\n  }\n\n  invalidOptions.forEach(function(name) {\n    if (objectHasProperty(options, name)) {\n      throw new Error('peaks.segments.' + context + ': invalid option name: ' + name);\n    }\n  });\n\n  segmentOptions.forEach(function(name) {\n    if (objectHasProperty(options, '_' + name)) {\n      throw new Error('peaks.segments.' + context + ': invalid option name: _' + name);\n    }\n  });\n}\n\n/**\n * A segment is a region of time, with associated label and color.\n *\n * @class\n * @alias Segment\n *\n * @param {Peaks} peaks A reference to the Peaks instance.\n * @param {String} id A unique identifier for the segment.\n * @param {Number} startTime Segment start time, in seconds.\n * @param {Number} endTime Segment end time, in seconds.\n * @param {String} labelText Segment label text.\n * @param {String | LinearGradientColor} color Segment color.\n * @param {String} borderColor Segment border color.\n * @param {Boolean} editable If <code>true</code> the segment start and\n *   end times can be adjusted via the user interface.\n * @param {*} data Optional application specific data.\n */\n\nfunction Segment(options) {\n  this._peaks       = options.peaks;\n  this._id          = options.id;\n  this._startTime   = options.startTime;\n  this._endTime     = options.endTime;\n  this._labelText   = options.labelText;\n  this._color       = options.color;\n  this._borderColor = options.borderColor;\n  this._editable    = options.editable;\n\n  this._setUserData(options);\n}\n\nSegment.prototype._setUserData = function(options) {\n  for (const key in options) {\n    if (objectHasProperty(options, key)) {\n      if (segmentOptions.indexOf(key) === -1) {\n        this[key] = options[key];\n      }\n      else {\n        this['_' + key] = options[key];\n      }\n    }\n  }\n};\n\nObject.defineProperties(Segment.prototype, {\n  id: {\n    enumerable: true,\n    get: function() {\n      return this._id;\n    }\n  },\n  startTime: {\n    enumerable: true,\n    get: function() {\n      return this._startTime;\n    }\n  },\n  endTime: {\n    enumerable: true,\n    get: function() {\n      return this._endTime;\n    }\n  },\n  labelText: {\n    enumerable: true,\n    get: function() {\n      return this._labelText;\n    }\n  },\n  color: {\n    enumerable: true,\n    get: function() {\n      return this._color;\n    }\n  },\n  borderColor: {\n    enumerable: true,\n    get: function() {\n      return this._borderColor;\n    }\n  },\n  editable: {\n    enumerable: true,\n    get: function() {\n      return this._editable;\n    }\n  }\n});\n\nSegment.prototype.update = function(options) {\n  if (objectHasProperty(options, 'id')) {\n    throw new Error('peaks.segments.update(): id cannot be updated');\n  }\n\n  validateSegmentOptions(options, true);\n\n  this._setUserData(options);\n\n  this._peaks.emit('segments.update', this, options);\n};\n\n/**\n * Returns <code>true</code> if the segment overlaps a given time region.\n *\n * @param {Number} startTime The start of the time region, in seconds.\n * @param {Number} endTime The end of the time region, in seconds.\n * @returns {Boolean}\n *\n * @see http://wiki.c2.com/?TestIfDateRangesOverlap\n */\n\nSegment.prototype.isVisible = function(startTime, endTime) {\n  return this.startTime < endTime && startTime < this.endTime;\n};\n\nSegment.prototype._setStartTime = function(time) {\n  this._startTime = time;\n};\n\nSegment.prototype._setEndTime = function(time) {\n  this._endTime = time;\n};\n\nexport { Segment, setDefaultSegmentOptions, validateSegmentOptions };\n","/**\n * @file\n *\n * Defines the {@link WaveformSegments} class.\n *\n * @module waveform-segments\n */\n\nimport { Segment, setDefaultSegmentOptions, validateSegmentOptions } from './segment';\nimport { extend, isNullOrUndefined, objectHasProperty } from './utils';\n\n/**\n * Segment parameters.\n *\n * @typedef {Object} SegmentOptions\n * @global\n * @property {Number} startTime Segment start time, in seconds.\n * @property {Number} endTime Segment end time, in seconds.\n * @property {Boolean=} editable If <code>true</code> the segment start and\n *   end times can be adjusted via the user interface.\n *   Default: <code>false</code>.\n * @property {String=} color Segment waveform color.\n *   Default: Set by the <code>segmentOptions.waveformColor</code> option\n *   or the <code>segmentOptions.overlayColor</code> option.\n * @property {String=} borderColor Segment border color.\n *   Default: Set by the <code>segmentOptions.overlayBorderColor</code> option.\n * @property {String=} labelText Segment label text.\n *   Default: an empty string.\n * @property {String=} id A unique segment identifier.\n *   Default: an automatically generated identifier.\n */\n\n/**\n * Handles all functionality related to the adding, removing and manipulation\n * of segments.\n *\n * @class\n * @alias WaveformSegments\n *\n * @param {Peaks} peaks The parent Peaks object.\n */\n\nfunction WaveformSegments(peaks) {\n  this._peaks = peaks;\n  this._segments = [];\n  this._segmentsById = {};\n  this._segmentIdCounter = 0;\n}\n\n/**\n * Returns a new unique segment id value.\n *\n * @private\n * @returns {String}\n */\n\nWaveformSegments.prototype._getNextSegmentId = function() {\n  return 'peaks.segment.' + this._segmentIdCounter++;\n};\n\n/**\n * Adds a new segment object.\n *\n * @private\n * @param {Segment} segment\n */\n\nWaveformSegments.prototype._addSegment = function(segment) {\n  this._segments.push(segment);\n\n  this._segmentsById[segment.id] = segment;\n};\n\n/**\n * Creates a new segment object.\n *\n * @private\n * @param {SegmentOptions} options\n * @return {Segment}\n */\n\nWaveformSegments.prototype._createSegment = function(options) {\n  const segmentOptions = {};\n\n  extend(segmentOptions, options);\n\n  if (isNullOrUndefined(segmentOptions.id)) {\n    segmentOptions.id = this._getNextSegmentId();\n  }\n\n  setDefaultSegmentOptions(segmentOptions, this._peaks.options.segmentOptions);\n\n  validateSegmentOptions(segmentOptions, false);\n\n  segmentOptions.peaks = this._peaks;\n\n  return new Segment(segmentOptions);\n};\n\n/**\n * Returns all segments.\n *\n * @returns {Array<Segment>}\n */\n\nWaveformSegments.prototype.getSegments = function() {\n  return this._segments;\n};\n\n/**\n * Returns the segment with the given id, or <code>undefined</code> if not found.\n *\n * @param {String} id\n * @returns {Segment}\n */\n\nWaveformSegments.prototype.getSegment = function(id) {\n  return this._segmentsById[id];\n};\n\n/**\n * Returns all segments that overlap a given point in time.\n *\n * @param {Number} time\n * @returns {Array<Segment>}\n */\n\nWaveformSegments.prototype.getSegmentsAtTime = function(time) {\n  return this._segments.filter(function(segment) {\n    return time >= segment.startTime && time < segment.endTime;\n  });\n};\n\n/**\n * Returns all segments that overlap a given time region.\n *\n * @param {Number} startTime The start of the time region, in seconds.\n * @param {Number} endTime The end of the time region, in seconds.\n *\n * @returns {Array<Segment>}\n */\n\nWaveformSegments.prototype.find = function(startTime, endTime) {\n  return this._segments.filter(function(segment) {\n    return segment.isVisible(startTime, endTime);\n  });\n};\n\n/**\n * Returns a copy of the segments array, sorted by ascending segment start time.\n *\n * @returns {Array<Segment>}\n */\n\nWaveformSegments.prototype._getSortedSegments = function() {\n  return this._segments.slice().sort(function(a, b) {\n    return a.startTime - b.startTime;\n  });\n};\n\nWaveformSegments.prototype.findPreviousSegment = function(segment) {\n  const sortedSegments = this._getSortedSegments();\n\n  const index = sortedSegments.findIndex(function(s) {\n    return s.id === segment.id;\n  });\n\n  if (index !== -1) {\n    return sortedSegments[index - 1];\n  }\n\n  return undefined;\n};\n\nWaveformSegments.prototype.findNextSegment = function(segment) {\n  const sortedSegments = this._getSortedSegments();\n\n  const index = sortedSegments.findIndex(function(s) {\n    return s.id === segment.id;\n  });\n\n  if (index !== -1) {\n    return sortedSegments[index + 1];\n  }\n\n  return undefined;\n};\n\n/**\n * Adds one or more segments to the timeline.\n *\n * @param {SegmentOptions|Array<SegmentOptions>} segmentOrSegments\n *\n * @returns Segment|Array<Segment>\n */\n\nWaveformSegments.prototype.add = function(/* segmentOrSegments */) {\n  const self = this;\n\n  const arrayArgs = Array.isArray(arguments[0]);\n  let segments = arrayArgs ?\n                 arguments[0] :\n                 Array.prototype.slice.call(arguments);\n\n  segments = segments.map(function(segmentOptions) {\n    const segment = self._createSegment(segmentOptions);\n\n    if (objectHasProperty(self._segmentsById, segment.id)) {\n      throw new Error('peaks.segments.add(): duplicate id');\n    }\n\n    return segment;\n  });\n\n  segments.forEach(function(segment) {\n    self._addSegment(segment);\n  });\n\n  this._peaks.emit('segments.add', segments);\n\n  return arrayArgs ? segments : segments[0];\n};\n\n/**\n * Returns the indexes of segments that match the given predicate.\n *\n * @private\n * @param {Function} predicate Predicate function to find matching segments.\n * @returns {Array<Number>} An array of indexes into the segments array of\n *   the matching elements.\n */\n\nWaveformSegments.prototype._findSegment = function(predicate) {\n  const indexes = [];\n\n  for (let i = 0, length = this._segments.length; i < length; i++) {\n    if (predicate(this._segments[i])) {\n      indexes.push(i);\n    }\n  }\n\n  return indexes;\n};\n\n/**\n * Removes the segments at the given array indexes.\n *\n * @private\n * @param {Array<Number>} indexes The array indexes to remove.\n * @returns {Array<Segment>} The removed {@link Segment} objects.\n */\n\nWaveformSegments.prototype._removeIndexes = function(indexes) {\n  const removed = [];\n\n  for (let i = 0; i < indexes.length; i++) {\n    const index = indexes[i] - removed.length;\n\n    const itemRemoved = this._segments.splice(index, 1)[0];\n\n    delete this._segmentsById[itemRemoved.id];\n\n    removed.push(itemRemoved);\n  }\n\n  return removed;\n};\n\n/**\n * Removes all segments that match a given predicate function.\n *\n * After removing the segments, this function also emits a\n * <code>segments.remove</code> event with the removed {@link Segment}\n * objects.\n *\n * @private\n * @param {Function} predicate A predicate function that identifies which\n *   segments to remove.\n * @returns {Array<Segment>} The removed {@link Segment} objects.\n */\n\nWaveformSegments.prototype._removeSegments = function(predicate) {\n  const indexes = this._findSegment(predicate);\n\n  const removed = this._removeIndexes(indexes);\n\n  this._peaks.emit('segments.remove', removed);\n\n  return removed;\n};\n\n/**\n * Removes the given segment.\n *\n * @param {Segment} segment The segment to remove.\n * @returns {Array<Segment>} The removed segment.\n */\n\nWaveformSegments.prototype.remove = function(segment) {\n  return this._removeSegments(function(s) {\n    return s === segment;\n  });\n};\n\n/**\n * Removes any segments with the given id.\n *\n * @param {String} id\n * @returns {Array<Segment>} The removed {@link Segment} objects.\n */\n\nWaveformSegments.prototype.removeById = function(segmentId) {\n  return this._removeSegments(function(segment) {\n    return segment.id === segmentId;\n  });\n};\n\n/**\n * Removes any segments with the given start time, and optional end time.\n *\n * @param {Number} startTime Segments with this start time are removed.\n * @param {Number?} endTime If present, only segments with both the given\n *   start time and end time are removed.\n * @returns {Array<Segment>} The removed {@link Segment} objects.\n */\n\nWaveformSegments.prototype.removeByTime = function(startTime, endTime) {\n  endTime = (typeof endTime === 'number') ? endTime : 0;\n\n  let filter;\n\n  if (endTime > 0) {\n    filter = function(segment) {\n      return segment.startTime === startTime && segment.endTime === endTime;\n    };\n  }\n  else {\n    filter = function(segment) {\n      return segment.startTime === startTime;\n    };\n  }\n\n  return this._removeSegments(filter);\n};\n\n/**\n * Removes all segments.\n *\n * After removing the segments, this function emits a\n * <code>segments.remove_all</code> event.\n */\n\nWaveformSegments.prototype.removeAll = function() {\n  this._segments = [];\n  this._segmentsById = {};\n  this._peaks.emit('segments.remove_all');\n};\n\nexport default WaveformSegments;\n","/**\n * @file\n *\n * Defines the {@link KeyboardHandler} class.\n *\n * @module keyboard-handler\n */\n\nconst nodes = ['OBJECT', 'TEXTAREA', 'INPUT', 'SELECT', 'OPTION'];\n\nconst SPACE = 32,\n    TAB = 9,\n    LEFT_ARROW = 37,\n    RIGHT_ARROW = 39;\n\nconst keys = [SPACE, TAB, LEFT_ARROW, RIGHT_ARROW];\n\n/**\n * Configures keyboard event handling.\n *\n * @class\n * @alias KeyboardHandler\n *\n * @param {EventEmitter} eventEmitter\n */\n\nfunction KeyboardHandler(eventEmitter) {\n  this.eventEmitter = eventEmitter;\n\n  this._handleKeyEvent = this._handleKeyEvent.bind(this);\n\n  document.addEventListener('keydown', this._handleKeyEvent);\n  document.addEventListener('keypress', this._handleKeyEvent);\n  document.addEventListener('keyup', this._handleKeyEvent);\n}\n\n/**\n * Keyboard event handler function.\n *\n * @note Arrow keys only triggered on keydown, not keypress.\n *\n * @param {KeyboardEvent} event\n * @private\n */\n\nKeyboardHandler.prototype._handleKeyEvent = function handleKeyEvent(event) {\n  if (nodes.indexOf(event.target.nodeName) === -1) {\n    if (keys.indexOf(event.type) > -1) {\n      event.preventDefault();\n    }\n\n    if (event.type === 'keydown' || event.type === 'keypress') {\n      switch (event.keyCode) {\n        case SPACE:\n          this.eventEmitter.emit('keyboard.space');\n          break;\n\n        case TAB:\n          this.eventEmitter.emit('keyboard.tab');\n          break;\n      }\n    }\n    else if (event.type === 'keyup') {\n      switch (event.keyCode) {\n        case LEFT_ARROW:\n          if (event.shiftKey) {\n            this.eventEmitter.emit('keyboard.shift_left');\n          }\n          else {\n            this.eventEmitter.emit('keyboard.left');\n          }\n          break;\n\n        case RIGHT_ARROW:\n          if (event.shiftKey) {\n            this.eventEmitter.emit('keyboard.shift_right');\n          }\n          else {\n            this.eventEmitter.emit('keyboard.right');\n          }\n          break;\n      }\n    }\n  }\n};\n\nKeyboardHandler.prototype.destroy = function() {\n  document.removeEventListener('keydown', this._handleKeyEvent);\n  document.removeEventListener('keypress', this._handleKeyEvent);\n  document.removeEventListener('keyup', this._handleKeyEvent);\n};\n\nexport default KeyboardHandler;\n","/**\n * @file\n *\n * Implementation of {@link Player} adapter based on the HTML5 media element.\n *\n * @module mediaelement-player\n */\n\n/**\n * Checks whether the given HTMLMediaElement has either a src attribute\n * or any child <code>&lt;source&gt;</code> nodes\n */\n\nfunction mediaElementHasSource(mediaElement) {\n  if (mediaElement.src) {\n    return true;\n  }\n\n  if (mediaElement.querySelector('source')) {\n    return true;\n  }\n\n  return false;\n}\n\n/**\n * A wrapper for interfacing with the HTML5 media element API.\n * Initializes the player for a given media element.\n *\n * @class\n * @alias MediaElementPlayer\n * @param {HTMLMediaElement} mediaElement The HTML <code>&lt;audio&gt;</code>\n *   or <code>&lt;video&gt;</code> element to associate with the\n *   {@link Peaks} instance.\n */\n\nfunction MediaElementPlayer(mediaElement) {\n  this._mediaElement = mediaElement;\n}\n\n/**\n * Adds an event listener to the media element.\n *\n * @private\n * @param {String} type The event type to listen for.\n * @param {Function} callback An event handler function.\n */\n\nMediaElementPlayer.prototype._addMediaListener = function(type, callback) {\n  this._listeners.push({ type: type, callback: callback });\n  this._mediaElement.addEventListener(type, callback);\n};\n\nMediaElementPlayer.prototype.init = function(eventEmitter) {\n  const self = this;\n\n  self._eventEmitter = eventEmitter;\n  self._listeners = [];\n  self._duration = self.getDuration();\n\n  self._addMediaListener('timeupdate', function() {\n    self._eventEmitter.emit('player.timeupdate', self.getCurrentTime());\n  });\n\n  self._addMediaListener('playing', function() {\n    self._eventEmitter.emit('player.playing', self.getCurrentTime());\n  });\n\n  self._addMediaListener('pause', function() {\n    self._eventEmitter.emit('player.pause', self.getCurrentTime());\n  });\n\n  self._addMediaListener('ended', function() {\n    self._eventEmitter.emit('player.ended');\n  });\n\n  self._addMediaListener('seeked', function() {\n    self._eventEmitter.emit('player.seeked', self.getCurrentTime());\n  });\n\n  self._addMediaListener('canplay', function() {\n    self._eventEmitter.emit('player.canplay');\n  });\n\n  self._addMediaListener('error', function(event) {\n    self._eventEmitter.emit('player.error', event.target.error);\n  });\n\n  self._interval = null;\n\n  if (!mediaElementHasSource(self._mediaElement)) {\n    return Promise.resolve();\n  }\n\n  return new Promise(function(resolve, reject) {\n    function eventHandler(event) {\n      self._mediaElement.removeEventListener('loadedmetadata', eventHandler);\n      self._mediaElement.removeEventListener('error', eventHandler);\n\n      if (event.type === 'loadedmetadata') {\n        resolve();\n      }\n      else {\n        reject(event.target.error);\n      }\n    }\n\n    // If the media element has preload=\"none\", clicking to seek in the\n    // waveform won't work, so here we force the media to load.\n    if (self._mediaElement.readyState === HTMLMediaElement.HAVE_NOTHING) {\n      // Wait for the readyState to change to HAVE_METADATA so we know the\n      // duration is valid, otherwise it could be NaN.\n      self._mediaElement.addEventListener('loadedmetadata', eventHandler);\n      self._mediaElement.addEventListener('error', eventHandler);\n      self._mediaElement.load();\n    }\n    else {\n      resolve();\n    }\n  });\n};\n\n/**\n * Cleans up the player object, removing all event listeners from the\n * associated media element.\n */\n\nMediaElementPlayer.prototype.destroy = function() {\n  for (let i = 0; i < this._listeners.length; i++) {\n    const listener = this._listeners[i];\n\n    this._mediaElement.removeEventListener(\n      listener.type,\n      listener.callback\n    );\n  }\n\n  this._listeners.length = 0;\n\n  this._mediaElement = null;\n};\n\nMediaElementPlayer.prototype.play = function() {\n  return this._mediaElement.play();\n};\n\nMediaElementPlayer.prototype.pause = function() {\n  this._mediaElement.pause();\n};\n\nMediaElementPlayer.prototype.isPlaying = function() {\n  return !this._mediaElement.paused;\n};\n\nMediaElementPlayer.prototype.isSeeking = function() {\n  return this._mediaElement.seeking;\n};\n\nMediaElementPlayer.prototype.getCurrentTime = function() {\n  return this._mediaElement.currentTime;\n};\n\nMediaElementPlayer.prototype.getDuration = function() {\n  return this._mediaElement.duration;\n};\n\nMediaElementPlayer.prototype.seek = function(time) {\n  this._mediaElement.currentTime = time;\n};\n\nfunction SetSourceHandler(eventEmitter, mediaElement) {\n  this._eventEmitter = eventEmitter;\n  this._mediaElement = mediaElement;\n  this._playerCanPlayHandler = this._playerCanPlayHandler.bind(this);\n  this._playerErrorHandler = this._playerErrorHandler.bind(this);\n}\n\nSetSourceHandler.prototype.setSource = function(options, callback) {\n  const self = this;\n\n  self._options = options;\n  self._callback = callback;\n\n  self._eventEmitter.on('player.canplay', self._playerCanPlayHandler);\n  self._eventEmitter.on('player.error', self._playerErrorHandler);\n\n  return new Promise(function(resolve, reject) {\n    self._resolve = resolve;\n    self._reject = reject;\n\n    self._eventEmitter.on('player.canplay', self._playerCanPlayHandler);\n    self._eventEmitter.on('player.error', self._playerErrorHandler);\n\n    self._mediaElement.setAttribute('src', options.mediaUrl);\n\n    // Force the media element to load, in case the media element\n    // has preload=\"none\".\n    if (self._mediaElement.readyState === HTMLMediaElement.HAVE_NOTHING) {\n      self._mediaElement.load();\n    }\n  });\n};\n\nSetSourceHandler.prototype._reset = function() {\n  this._eventEmitter.removeListener('player.canplay', this._playerCanPlayHandler);\n  this._eventEmitter.removeListener('player.error', this._playerErrorHandler);\n};\n\nSetSourceHandler.prototype._playerCanPlayHandler = function() {\n  this._reset();\n\n  this._resolve();\n};\n\nSetSourceHandler.prototype._playerErrorHandler = function(err) {\n  this._reset();\n\n  // Return the MediaError object from the media element\n  this._reject(err);\n};\n\nMediaElementPlayer.prototype.setSource = function(options) {\n  if (!options.mediaUrl) {\n    // eslint-disable-next-line max-len\n    return Promise.reject(new Error('peaks.setSource(): options must contain a mediaUrl when using mediaElement'));\n  }\n\n  const setSourceHandler = new SetSourceHandler(this._eventEmitter, this._mediaElement);\n\n  return setSourceHandler.setSource(options);\n};\n\nexport default MediaElementPlayer;\n","/**\n * @file\n *\n * A general audio player class which interfaces with external audio players.\n * The default audio player in Peaks.js is {@link MediaElementPlayer}.\n *\n * @module player\n */\n\nimport { isValidTime } from './utils';\n\nfunction getAllPropertiesFrom(adapter) {\n  const allProperties = [];\n  let obj = adapter;\n\n  while (obj) {\n    Object.getOwnPropertyNames(obj).forEach(function(p) {\n      allProperties.push(p);\n    });\n\n    obj = Object.getPrototypeOf(obj);\n  }\n\n  return allProperties;\n}\n\nfunction validateAdapter(adapter) {\n  const publicAdapterMethods = [\n    'init',\n    'destroy',\n    'play',\n    'pause',\n    'isPlaying',\n    'isSeeking',\n    'getCurrentTime',\n    'getDuration',\n    'seek'\n  ];\n\n  const allProperties = getAllPropertiesFrom(adapter);\n\n  publicAdapterMethods.forEach(function(method) {\n    if (!allProperties.includes(method)) {\n      throw new TypeError('Peaks.init(): Player method ' + method + ' is undefined');\n    }\n\n    if ((typeof adapter[method]) !== 'function') {\n      throw new TypeError('Peaks.init(): Player method ' + method + ' is not a function');\n    }\n  });\n}\n\n/**\n * A wrapper for interfacing with an external player API.\n *\n * @class\n * @alias Player\n *\n * @param {Peaks} peaks The parent {@link Peaks} object.\n * @param {Adapter} adapter The player adapter.\n */\n\nfunction Player(peaks, adapter) {\n  this._peaks = peaks;\n\n  this._playingSegment = false;\n  this._segment = null;\n  this._loop = false;\n  this._playSegmentTimerCallback = this._playSegmentTimerCallback.bind(this);\n\n  validateAdapter(adapter);\n  this._adapter = adapter;\n}\n\nPlayer.prototype.init = function() {\n  return this._adapter.init(this._peaks);\n};\n\n/**\n * Cleans up the player object.\n */\n\nPlayer.prototype.destroy = function() {\n  this._adapter.destroy();\n};\n\n/**\n * Starts playback.\n * @returns {Promise}\n */\n\nPlayer.prototype.play = function() {\n  return this._adapter.play();\n};\n\n/**\n * Pauses playback.\n */\n\nPlayer.prototype.pause = function() {\n  this._adapter.pause();\n};\n\n/**\n * @returns {Boolean} <code>true</code> if playing, <code>false</code>\n * otherwise.\n */\n\nPlayer.prototype.isPlaying = function() {\n  return this._adapter.isPlaying();\n};\n\n/**\n * @returns {boolean} <code>true</code> if seeking\n */\n\nPlayer.prototype.isSeeking = function() {\n  return this._adapter.isSeeking();\n};\n\n/**\n * Returns the current playback time position, in seconds.\n *\n * @returns {Number}\n */\n\nPlayer.prototype.getCurrentTime = function() {\n  return this._adapter.getCurrentTime();\n};\n\n/**\n * Returns the media duration, in seconds.\n *\n * @returns {Number}\n */\n\nPlayer.prototype.getDuration = function() {\n  return this._adapter.getDuration();\n};\n\n/**\n * Seeks to a given time position within the media.\n *\n * @param {Number} time The time position, in seconds.\n */\n\nPlayer.prototype.seek = function(time) {\n  if (!isValidTime(time)) {\n    this._peaks._logger('peaks.player.seek(): parameter must be a valid time, in seconds');\n    return;\n  }\n\n  this._adapter.seek(time);\n};\n\n/**\n * Plays the given segment.\n *\n * @param {Segment} segment The segment denoting the time region to play.\n * @param {Boolean} loop If true, playback is looped.\n */\n\nPlayer.prototype.playSegment = function(segment, loop) {\n  const self = this;\n\n  if (!segment ||\n    !isValidTime(segment.startTime) ||\n    !isValidTime(segment.endTime)) {\n    return Promise.reject(\n      new Error('peaks.player.playSegment(): parameter must be a segment object')\n    );\n  }\n\n  self._segment = segment;\n  self._loop = loop;\n\n  // Set audio time to segment start time\n  self.seek(segment.startTime);\n\n  self._peaks.once('player.playing', function() {\n    if (!self._playingSegment) {\n      self._playingSegment = true;\n\n      // We need to use requestAnimationFrame here as the timeupdate event\n      // doesn't fire often enough.\n      window.requestAnimationFrame(self._playSegmentTimerCallback);\n    }\n  });\n\n  // Start playing audio\n  return self.play();\n};\n\nPlayer.prototype._playSegmentTimerCallback = function() {\n  if (!this.isPlaying()) {\n    this._playingSegment = false;\n    return;\n  }\n  else if (this.getCurrentTime() >= this._segment.endTime) {\n    if (this._loop) {\n      this.seek(this._segment.startTime);\n    }\n    else {\n      this.pause();\n      this._peaks.emit('player.ended');\n      this._playingSegment = false;\n      return;\n    }\n  }\n\n  window.requestAnimationFrame(this._playSegmentTimerCallback);\n};\n\nPlayer.prototype._setSource = function(options) {\n  return this._adapter.setSource(options);\n};\n\nexport default Player;\n","/**\n * @file\n *\n * Defines the {@link DefaultPointMarker} class.\n *\n * @module default-point-marker\n */\n\nimport { Line } from 'konva/lib/shapes/Line';\nimport { Rect } from 'konva/lib/shapes/Rect';\nimport { Text } from 'konva/lib/shapes/Text';\n\n/**\n * Creates a point marker handle.\n *\n * @class\n * @alias DefaultPointMarker\n *\n * @param {CreatePointMarkerOptions} options\n */\n\nfunction DefaultPointMarker(options) {\n  this._options = options;\n}\n\nDefaultPointMarker.prototype.init = function(group) {\n  const handleWidth  = 10;\n  const handleHeight = 20;\n  const handleX      = -(handleWidth / 2) + 0.5; // Place in the middle of the marker\n\n  // Label\n\n  if (this._options.view === 'zoomview') {\n    // Label - create with default y, the real value is set in fitToView().\n    this._label = new Text({\n      x:          2,\n      y:          0,\n      text:       this._options.point.labelText,\n      textAlign:  'left',\n      fontFamily: this._options.fontFamily || 'sans-serif',\n      fontSize:   this._options.fontSize || 10,\n      fontStyle:  this._options.fontStyle || 'normal',\n      fill:       '#000'\n    });\n  }\n\n  // Handle - create with default y, the real value is set in fitToView().\n\n  if (this._options.draggable) {\n    this._handle = new Rect({\n      x:      handleX,\n      y:      0,\n      width:  handleWidth,\n      height: handleHeight,\n      fill:   this._options.color\n    });\n  }\n\n  // Line - create with default y and points, the real values\n  // are set in fitToView().\n  this._line = new Line({\n    x:           0,\n    y:           0,\n    stroke:      this._options.color,\n    strokeWidth: 1\n  });\n\n  // Time label\n\n  if (this._handle) {\n    // Time - create with default y, the real value is set in fitToView().\n    this._time = new Text({\n      x:          -24,\n      y:          0,\n      text:       this._options.layer.formatTime(this._options.point.time),\n      fontFamily: this._options.fontFamily,\n      fontSize:   this._options.fontSize,\n      fontStyle:  this._options.fontStyle,\n      fill:       '#000',\n      textAlign:  'center'\n    });\n\n    this._time.hide();\n  }\n\n  if (this._handle) {\n    group.add(this._handle);\n  }\n\n  group.add(this._line);\n\n  if (this._label) {\n    group.add(this._label);\n  }\n\n  if (this._time) {\n    group.add(this._time);\n  }\n\n  this.fitToView();\n\n  this.bindEventHandlers(group);\n};\n\nDefaultPointMarker.prototype.bindEventHandlers = function(group) {\n  const self = this;\n\n  if (self._handle) {\n    self._handle.on('mouseover touchstart', function() {\n      // Position text to the left of the marker\n      self._time.setX(-24 - self._time.getWidth());\n      self._time.show();\n    });\n\n    self._handle.on('mouseout touchend', function() {\n      self._time.hide();\n    });\n\n    group.on('dragstart', function() {\n      self._time.setX(-24 - self._time.getWidth());\n      self._time.show();\n    });\n\n    group.on('dragend', function() {\n      self._time.hide();\n    });\n  }\n};\n\nDefaultPointMarker.prototype.fitToView = function() {\n  const height = this._options.layer.getHeight();\n\n  this._line.points([0.5, 0, 0.5, height]);\n\n  if (this._label) {\n    this._label.y(12);\n  }\n\n  if (this._handle) {\n    this._handle.y(height / 2 - 10.5);\n  }\n\n  if (this._time) {\n    this._time.y(height / 2 - 5);\n  }\n};\n\nDefaultPointMarker.prototype.timeUpdated = function(time) {\n  if (this._time) {\n    this._time.setText(this._options.layer.formatTime(time));\n  }\n};\n\nexport default DefaultPointMarker;\n","/**\n * @file\n *\n * Defines the {@link DefaultSegmentMarker} class.\n *\n * @module default-segment-marker\n */\n\nimport { Line } from 'konva/lib/shapes/Line';\nimport { Rect } from 'konva/lib/shapes/Rect';\nimport { Text } from 'konva/lib/shapes/Text';\n\n/**\n * Creates a segment marker handle.\n *\n * @class\n * @alias DefaultSegmentMarker\n *\n * @param {CreateSegmentMarkerOptions} options\n */\n\nfunction DefaultSegmentMarker(options) {\n  this._options = options;\n}\n\nDefaultSegmentMarker.prototype.init = function(group) {\n  const handleWidth  = 15;\n  const handleHeight = 48;\n  let handleX      = -(handleWidth / 2) - 8; // Place off to the side of the segment\n\n  handleX = this._options.startMarker ? (handleX * -1) - 14.9 : handleX;\n\n  const xPosition = this._options.startMarker ? -24 : 24;\n\n  const time = this._options.startMarker ? this._options.segment.startTime :\n                                           this._options.segment.endTime;\n\n  const handleLineColor = this._options.segment.borderColor;\n\n  const handleColor = this._options.segment.handleColor;\n\n  // Label - create with default y, the real value is set in fitToView().\n  this._label = new Text({\n    x:          xPosition,\n    y:          0,\n    text:       this._options.layer.formatTime(time),\n    fontFamily: this._options.fontFamily,\n    fontSize:   this._options.fontSize,\n    fontStyle:  this._options.fontStyle,\n    fill:       '#000',\n    textAlign:  'center'\n  });\n\n  this._label.hide();\n\n  // Handle - create with default y, the real value is set in fitToView().\n  this._handle = new Rect({\n    x:           handleX,\n    y:           0,\n    width:       handleWidth,\n    height:      handleHeight,\n    fill:        handleColor,\n    stroke:      handleColor,\n    strokeWidth: 0\n  });\n\n  this._handleLineOne = new Rect({\n    name: 'handleLineOne',\n    x: handleX + 4.5,\n    y: 0,\n    width: 0.5,\n    height: 16,\n    fill: handleLineColor,\n    stroke: handleLineColor,\n    strokeWidth: 1\n  });\n\n  this._handleLineTwo = new Rect({\n    name: 'handleLineTwo',\n    x: handleX + 9.5,\n    y: 0,\n    width: 0.5,\n    height: 16,\n    fill: handleLineColor,\n    stroke: handleLineColor,\n    strokeWidth: 1\n  });\n\n  this._handleLineSingle = new Rect({\n    name: 'handleLineSingle',\n    x: handleX + 7,\n    y: 0,\n    width: 0.5,\n    height: 16,\n    fill: handleLineColor,\n    stroke: handleLineColor,\n    strokeWidth: 1,\n    visible: false\n  });\n\n  // Vertical Line - create with default y and points, the real values\n  // are set in fitToView().\n  this._line = new Line({\n    x:           0,\n    y:           0\n  });\n\n  group.add(this._label);\n  // group.add(this._line);\n  group.add(this._handleLineOne);\n  group.add(this._handleLineTwo);\n  group.add(this._handleLineSingle);\n  group.add(this._handle);\n\n  this.fitToView();\n\n  this.bindEventHandlers(group);\n\n  setTimeout(() => {\n    let focusedSegmentShape;\n    const segmentShapes = this._options.layer._segmentShapes;\n\n    for (const [value] of Object.entries(segmentShapes)) {\n      if (value._endMarker !== null) {\n        focusedSegmentShape = value;\n        break;\n      }\n    }\n\n    const segmentShapeWidth = focusedSegmentShape._overlay.width();\n\n    if (segmentShapeWidth <= 32.5) {\n      const markerInfo = this.getMarkerInfo(focusedSegmentShape);\n\n      this.updateMarkersSmall(segmentShapeWidth, markerInfo);\n    }\n  }, 0);\n};\n\nDefaultSegmentMarker.prototype.bindEventHandlers = function(group) {\n  const self = this;\n\n  // const xPosition = self._options.startMarker ? -24 : 24;\n\n  if (self._options.draggable) {\n    group.on('dragstart', function() {\n      // self._handle.attrs.fill = '#3641414D'; // neutral-800 .30a\n      // self._handle.attrs.stroke = '#3641414D'; // neutral-800 .30a\n      // if (self._options.startMarker) {\n      //   self._label.setX(xPosition - self._label.getWidth());\n      // }\n\n      // self._label.show();\n    });\n\n    group.on('dragend', function() {\n      // self._label.hide();\n    });\n  }\n\n  self._handle.on('mouseover touchstart', function() {\n    document.body.style.cursor = 'col-resize';\n    // self._handle.attrs.fill = '#3641414D'; // neutral-800 .30a\n    // self._handle.attrs.stroke = '#3641414D'; // neutral-800 .30a\n    // if (self._options.startMarker) {\n    //   self._label.setX(xPosition - self._label.getWidth());\n    // }\n\n    // self._label.show();\n    this.parent.parent.draw();\n  });\n\n  self._handle.on('mouseout touchend', function() {\n    document.body.style.cursor = 'default';\n    // self._handle.attrs.fill = '#6E797A4D'; // neutral-600 .30a\n    // self._handle.attrs.stroke = '#6E797A4D'; // neutral-600 .30a\n    // self._label.hide();\n    this.parent.parent.draw();\n  });\n};\n\nDefaultSegmentMarker.prototype.fitToView = function() {\n  const height = this._options.layer.getHeight();\n\n  this._label.y(height / 2 - 5);\n  this._handle.y(height / 2 + 45);\n  this._handleLineOne.y(height / 2 + 61);\n  this._handleLineTwo.y(height / 2 + 61);\n  this._handleLineSingle.y(height / 2 + 61);\n  // this._line.points([0.5, 0, 0.5, height]);\n};\n\nDefaultSegmentMarker.prototype.updateMarkersSmall = function(segmentShapeWidth, markerInfo) {\n  const { endMarkerHandleLineSingle, startMarkerHandleLineSingle } = markerInfo;\n  const newHandleWidth = (segmentShapeWidth / 2) - 0.5;\n\n  markerInfo.endMarker._handle.x(-newHandleWidth + 1);\n  markerInfo.startMarker._handle.attrs.width = newHandleWidth;\n  markerInfo.endMarker._handle.attrs.width = newHandleWidth;\n\n  markerInfo.endMarkerHandleLines.forEach(line => line.hide());\n  endMarkerHandleLineSingle.show();\n  endMarkerHandleLineSingle.x((newHandleWidth / 2) - newHandleWidth);\n  markerInfo.startMarkerHandleLines.forEach(line => line.hide());\n  startMarkerHandleLineSingle.show();\n  startMarkerHandleLineSingle.x(newHandleWidth / 2);\n};\n\nDefaultSegmentMarker.prototype.getMarkerInfo = function(segmentShape) {\n  const { _endMarker, _startMarker } = segmentShape;\n  const endMarker = _endMarker._marker;\n  const endMarkerGroupChildren = _endMarker._group.children;\n  const startMarker = _startMarker._marker;\n  const startMarkerGroupChildren = _startMarker._group.children;\n\n  const endMarkerHandleLines = endMarkerGroupChildren.filter(\n    child => child.attrs.name === 'handleLineOne' || child.attrs.name === 'handleLineTwo');\n  const endMarkerHandleLineSingle = endMarkerGroupChildren.find(\n    child => child.attrs.name === 'handleLineSingle');\n  const startMarkerHandleLines = startMarkerGroupChildren.filter(\n    child => child.attrs.name === 'handleLineOne' || child.attrs.name === 'handleLineTwo');\n  const startMarkerHandleLineSingle = startMarkerGroupChildren.find(\n    child => child.attrs.name === 'handleLineSingle');\n\n  return {\n    endMarker,\n    startMarker,\n    endMarkerHandleLines,\n    endMarkerHandleLineSingle,\n    startMarkerHandleLines,\n    startMarkerHandleLineSingle\n  };\n};\n\nDefaultSegmentMarker.prototype.timeUpdated = function(time) {\n  let focusedSegmentShape;\n  const segmentShapes = this._options.layer._segmentShapes;\n\n  for (const [value] of Object.entries(segmentShapes)) {\n    if (value._endMarker !== null) {\n      focusedSegmentShape = value;\n      break;\n    }\n  }\n\n  const markerInfo = this.getMarkerInfo(focusedSegmentShape);\n\n  const segmentShapeWidth = focusedSegmentShape._overlay.width();\n\n  if (segmentShapeWidth <= 32.5) {\n    this.updateMarkersSmall(segmentShapeWidth, markerInfo);\n  }\n  else {\n    const handleX = -(15 / 2) - 8;\n    const startHandleX = handleX * -1 - 14.9;\n    const endHandleX = handleX;\n\n    markerInfo.endMarker._handle.x(endHandleX);\n    markerInfo.startMarker._handle.x(startHandleX);\n\n    markerInfo.startMarker._handle.attrs.width = 15;\n    markerInfo.endMarker._handle.attrs.width = 15;\n\n    markerInfo.endMarkerHandleLines.forEach(line => line.show());\n    markerInfo.endMarkerHandleLineSingle.hide();\n    markerInfo.startMarkerHandleLines.forEach(line => line.show());\n    markerInfo.startMarkerHandleLineSingle.hide();\n  }\n\n  this._label.setText(this._options.layer.formatTime(time));\n};\n\nexport default DefaultSegmentMarker;\n","/**\n * @file\n *\n * Factory functions for creating point and segment marker handles.\n *\n * @module marker-factories\n */\n\nimport DefaultPointMarker from './default-point-marker';\nimport DefaultSegmentMarker from './default-segment-marker';\nimport { Text } from 'konva/lib/shapes/Text';\n\n/**\n * Parameters for the {@link createSegmentMarker} function.\n *\n * @typedef {Object} CreateSegmentMarkerOptions\n * @global\n * @property {Segment} segment\n * @property {Boolean} draggable If true, marker is draggable.\n * @property {Boolean} startMarker\n * @property {String} color\n * @property {String} fontFamily\n * @property {Number} fontSize\n * @property {String} fontStyle\n * @property {Layer} layer\n * @property {String} view\n * @property {SegmentDisplayOptions} segmentOptions\n */\n\n/**\n * Creates a left or right side segment marker handle.\n *\n * @param {CreateSegmentMarkerOptions} options\n * @returns {Marker}\n */\n\nexport function createSegmentMarker(options) {\n  if (options.view === 'zoomview') {\n    return new DefaultSegmentMarker(options);\n  }\n\n  return null;\n}\n\n/**\n * Parameters for the {@link createSegmentLabel} function.\n *\n * @typedef {Object} SegmentLabelOptions\n * @global\n * @property {Segment} segment The {@link Segment} object associated with this\n *   label.\n * @property {String} view The name of the view that the label is being\n *   created in, either <code>zoomview</code> or <code>overview</code>.\n * @property {SegmentsLayer} layer\n * @property {String} fontFamily\n * @property {Number} fontSize\n * @property {String} fontStyle\n */\n\n/**\n * Creates a Konva object that renders information about a segment, such as\n * its label text.\n *\n * @param {SegmentLabelOptions} options\n * @returns {Konva.Text}\n */\n\nexport function createSegmentLabel(options) {\n  return new Text({\n    x:          12,\n    y:          12,\n    text:       options.segment.labelText,\n    textAlign:  'center',\n    fontFamily: options.fontFamily || 'sans-serif',\n    fontSize:   options.fontSize || 12,\n    fontStyle:  options.fontStyle || 'normal',\n    fill:       '#000'\n  });\n}\n\n/**\n * Parameters for the {@link createPointMarker} function.\n *\n * @typedef {Object} CreatePointMarkerOptions\n * @global\n * @property {Point} point\n * @property {Boolean} draggable If true, marker is draggable.\n * @property {String} color\n * @property {Layer} layer\n * @property {String} view\n * @property {String} fontFamily\n * @property {Number} fontSize\n * @property {String} fontStyle\n */\n\n/**\n * Creates a point marker handle.\n *\n * @param {CreatePointMarkerOptions} options\n * @returns {Marker}\n */\n\nexport function createPointMarker(options) {\n  return new DefaultPointMarker(options);\n}\n","/**\n * @file\n *\n * Defines the {@link Scrollbar} class.\n *\n * @module scrollbar\n */\n\nimport { clamp } from './utils';\n\nimport Konva from 'konva/lib/Core';\nimport { Rect } from 'konva/lib/shapes/Rect';\n\n/**\n * Creates a scrollbar.\n *\n * @class\n * @alias Scrollbar\n *\n * @param {WaveformData} waveformData\n * @param {HTMLElement} container\n * @param {Peaks} peaks\n */\n\nfunction Scrollbar(waveformData, container, peaks) {\n  this._waveformData = waveformData;\n  this._container = container;\n  this._peaks = peaks;\n  this._options = peaks.options.scrollbar;\n  this._zoomview = peaks.views.getView('zoomview');\n\n  this._dragBoundFunc = this._dragBoundFunc.bind(this);\n  this._onScrollboxDragStart = this._onScrollboxDragStart.bind(this);\n  this._onScrollboxDragMove = this._onScrollboxDragMove.bind(this);\n  this._onScrollboxDragEnd = this._onScrollboxDragEnd.bind(this);\n  this._onZoomviewDisplaying = this._onZoomviewDisplaying.bind(this);\n  this._onScrollbarClick = this._onScrollbarClick.bind(this);\n  this._onWindowResize = this._onWindowResize.bind(this);\n\n  peaks.on('zoomview.displaying', this._onZoomviewDisplaying);\n  peaks.on('window_resize', this._onWindowResize);\n\n  this._width = container.clientWidth;\n  // this._height = container.clientHeight;\n  this._height = 10;\n\n  this._stage = new Konva.Stage({\n    container: container,\n    width: this._width,\n    height: this._height\n  });\n\n  this._layer = new Konva.Layer();\n  this._stage.on('click', this._onScrollbarClick);\n\n  this._stage.add(this._layer);\n\n  this._color = this._options.color;\n  this._scrollboxX = 0;\n  this._minScrollboxWidth = this._options.minWidth;\n\n  this._offsetY = 0;\n\n  this._scrollbox = new Konva.Group({\n    draggable:     true,\n    dragBoundFunc: this._dragBoundFunc\n  });\n\n  this._scrollboxRect = new Rect({\n    x:           this._scrollboxX,\n    y:           this._offsetY,\n    width:       0,\n    height:      this._height,\n    fill:        this._color,\n    cornerRadius: 10\n  });\n\n  this._scrollbox.add(this._scrollboxRect);\n  this._setScrollboxWidth();\n\n  this._scrollbox.on('dragstart', this._onScrollboxDragStart);\n  this._scrollbox.on('dragmove', this._onScrollboxDragMove);\n  this._scrollbox.on('dragend', this._onScrollboxDragEnd);\n\n  this._layer.add(this._scrollbox);\n  this._layer.draw();\n}\n\n/**\n * Sets the width of the scrollbox, based on the visible waveform region\n * in the zoomview and minimum scrollbox width option.\n */\n\nScrollbar.prototype._setScrollboxWidth = function() {\n  if (this._zoomview) {\n    this._scrollboxWidth = Math.floor(\n      this._width * this._zoomview.pixelsToTime(this._zoomview.getWidth()) /\n        this._peaks.player.getDuration()\n    );\n\n    if (this._scrollboxWidth < this._minScrollboxWidth) {\n      this._scrollboxWidth = this._minScrollboxWidth;\n    }\n  }\n  else {\n    this._scrollboxWidth = this._minScrollboxWidth;\n  }\n\n  this._scrollboxRect.width(this._scrollboxWidth);\n};\n\n/**\n * @returns {Number} The maximum scrollbox position, in pixels.\n */\n\nScrollbar.prototype._getScrollbarRange = function() {\n  return this._width - this._scrollboxWidth;\n};\n\nScrollbar.prototype._dragBoundFunc = function(pos) {\n  // Allow the scrollbar to be moved horizontally but not vertically.\n  return {\n    x: pos.x,\n    y: 0\n  };\n};\n\nScrollbar.prototype._onScrollboxDragStart = function() {\n  this._dragging = true;\n};\n\nScrollbar.prototype._onScrollboxDragEnd = function() {\n  this._dragging = false;\n};\n\nScrollbar.prototype._onScrollboxDragMove = function() {\n  const range = this._getScrollbarRange();\n  let x = this._scrollbox.x();\n\n  x = clamp(x, 0, range);\n\n  this._scrollbox.x(x);\n\n  if (x !== this._scrollboxX) {\n    this._scrollboxX = x;\n\n    if (this._zoomview) {\n      this._updateWaveform(x);\n    }\n  }\n};\n\nScrollbar.prototype._onZoomviewDisplaying = function(/* startTime , endTime */) {\n  if (!this._dragging) {\n    this._updateScrollbarWidthAndPosition();\n  }\n};\n\nScrollbar.prototype._updateScrollbarWidthAndPosition = function() {\n  this._setScrollboxWidth();\n\n  if (this._zoomview) {\n    const startTime = this._zoomview.getStartTime();\n\n    const zoomviewRange = this._zoomview.getPixelLength() - this._zoomview.getWidth();\n\n    const scrollBoxPos = Math.floor(\n      this._zoomview.timeToPixels(startTime) * this._getScrollbarRange() / zoomviewRange\n    );\n\n    this._scrollbox.x(scrollBoxPos);\n    this._layer.draw();\n  }\n};\n\nScrollbar.prototype._onScrollbarClick = function(event) {\n  // Handle clicks on the scrollbar outside the scrollbox.\n  if (event.target === this._stage) {\n    if (this._zoomview) {\n      let x = event.evt.layerX;\n\n      // Centre the scrollbox where the user clicked.\n      x = Math.floor(x - this._scrollboxWidth / 2);\n\n      if (x < 0) {\n        x = 0;\n      }\n\n      this._updateWaveform(x);\n    }\n  }\n};\n\n/**\n * Sets the zoomview waveform position based on scrollbar position.\n */\n\nScrollbar.prototype._updateWaveform = function(x) {\n  const offset = Math.floor(\n    (this._zoomview.getPixelLength() - this._zoomview.getWidth()) * x / this._getScrollbarRange()\n  );\n\n  this._zoomview.updateWaveform(offset);\n};\n\nScrollbar.prototype._onWindowResize = function() {\n  this._width = this._container.clientWidth;\n  this._stage.width(this._width);\n\n  this._updateScrollbarWidthAndPosition();\n};\n\nScrollbar.prototype.fitToContainer = function() {\n  if (this._container.clientWidth === 0 && this._container.clientHeight === 0) {\n    return;\n  }\n\n  if (this._container.clientWidth !== this._width) {\n    this._width = this._container.clientWidth;\n    this._stage.width(this._width);\n  }\n\n  this._height = this._container.clientHeight;\n  this._stage.height(this._height);\n\n  this._stage.draw();\n};\n\nScrollbar.prototype.destroy = function() {\n  this._peaks.off('window_resize', this._onWindowResize);\n\n  this._layer.destroy();\n\n  this._stage.destroy();\n  this._stage = null;\n};\n\nexport default Scrollbar;\n","/**\n * @file\n *\n * Defines the {@link HighlightLayer} class.\n *\n * @module highlight-layer\n */\n\nimport Konva from 'konva/lib/Core';\nimport { Rect } from 'konva/lib/shapes/Rect';\n\nimport { clamp } from  './utils';\n\n/**\n * Highlight layer options\n *\n * @typedef {Object} HighlightLayerOptions\n * @global\n * @property {Number} highlightOffset\n * @property {String} highlightColor\n * @property {String} highlightStrokeColor\n * @property {Number} highlightOpacity\n * @property {Number} highlightCornerRadius\n */\n\n/**\n * Creates the highlight region that shows the position of the zoomable\n * waveform view in the overview waveform.\n *\n * @class\n * @alias HighlightLayer\n *\n * @param {WaveformOverview} view\n * @param {HighlightLayerOptions} options\n */\n\nfunction HighlightLayer(view, options) {\n  this._view          = view;\n  this._offset        = options.highlightOffset;\n  this._color         = options.highlightColor;\n  this._layer         = new Konva.Layer({ listening: false });\n  this._highlightRect = null;\n  this._startTime     = null;\n  this._endTime       = null;\n  this._strokeColor   = options.highlightStrokeColor;\n  this._opacity       = options.highlightOpacity;\n  this._cornerRadius  = options.highlightCornerRadius;\n}\n\nHighlightLayer.prototype.addToStage = function(stage) {\n  stage.add(this._layer);\n};\n\nHighlightLayer.prototype.showHighlight = function(startTime, endTime) {\n  if (!this._highlightRect) {\n    this._createHighlightRect(startTime, endTime);\n  }\n\n  this._update(startTime, endTime);\n};\n\n/**\n * Updates the position of the highlight region.\n *\n * @param {Number} startTime The start of the highlight region, in seconds.\n * @param {Number} endTime The end of the highlight region, in seconds.\n */\n\nHighlightLayer.prototype._update = function(startTime, endTime) {\n  this._startTime = startTime;\n  this._endTime = endTime;\n\n  const startOffset = this._view.timeToPixels(startTime);\n  const endOffset   = this._view.timeToPixels(endTime);\n\n  this._highlightRect.setAttrs({\n    x:     startOffset,\n    width: endOffset - startOffset\n  });\n};\n\nHighlightLayer.prototype._createHighlightRect = function(startTime, endTime) {\n  this._startTime = startTime;\n  this._endTime   = endTime;\n\n  const startOffset = this._view.timeToPixels(startTime);\n  const endOffset   = this._view.timeToPixels(endTime);\n\n  // Create with default y and height, the real values are set in fitToView().\n  this._highlightRect = new Rect({\n    x:            startOffset,\n    y:            0,\n    width:        endOffset - startOffset,\n    height:       0,\n    stroke:       this._strokeColor,\n    strokeWidth:  1,\n    fill:         this._color,\n    opacity:      this._opacity,\n    cornerRadius: this._cornerRadius\n  });\n\n  this.fitToView();\n\n  this._layer.add(this._highlightRect);\n};\n\nHighlightLayer.prototype.removeHighlight = function() {\n  if (this._highlightRect) {\n    this._highlightRect.destroy();\n    this._highlightRect = null;\n  }\n};\n\nHighlightLayer.prototype.updateHighlight = function() {\n  if (this._highlightRect) {\n    this._update(this._startTime, this._endTime);\n  }\n};\n\nHighlightLayer.prototype.fitToView = function() {\n  if (this._highlightRect) {\n    const height = this._view.getHeight();\n    const offset = clamp(this._offset, 0, Math.floor(height / 2));\n\n    this._highlightRect.setAttrs({\n      y: offset,\n      height: height - (offset * 2)\n    });\n  }\n};\n\nexport default HighlightLayer;\n","/**\n * @file\n *\n * Defines the {@link MouseDragHandler} class.\n *\n * @module mouse-drag-handler\n */\n\nimport { getMarkerObject } from './utils';\n\n/**\n * An object to receive callbacks on mouse drag events. Each function is\n * called with the current mouse X position, relative to the stage's\n * container HTML element.\n *\n * @typedef {Object} MouseDragHandlers\n * @global\n * @property {Function} onMouseDown Mouse down event handler.\n * @property {Function} onMouseMove Mouse move event handler.\n * @property {Function} onMouseUp Mouse up event handler.\n */\n\n/**\n * Creates a handler for mouse events to allow interaction with the waveform\n * views by clicking and dragging the mouse.\n *\n * @class\n * @alias MouseDragHandler\n *\n * @param {Konva.Stage} stage\n * @param {MouseDragHandlers} handlers\n */\n\nfunction MouseDragHandler(stage, handlers) {\n  this._stage     = stage;\n  this._handlers  = handlers;\n  this._dragging  = false;\n  this._mouseDown = this._mouseDown.bind(this);\n  this._mouseUp   = this._mouseUp.bind(this);\n  this._mouseMove = this._mouseMove.bind(this);\n\n  this._stage.on('mousedown', this._mouseDown);\n  this._stage.on('touchstart', this._mouseDown);\n\n  this._lastMouseClientX = null;\n}\n\n/**\n * Mouse down event handler.\n *\n * @param {MouseEvent} event\n */\n\nMouseDragHandler.prototype._mouseDown = function(event) {\n  let segment = null;\n\n  if (event.type === 'mousedown' && event.evt.button !== 0) {\n    // Mouse drag only applies to the primary mouse button.\n    // The secondary button may be used to show a context menu\n    // and we don't want to also treat this as a mouse drag operation.\n    return;\n  }\n\n  const marker = getMarkerObject(event.target);\n\n  if (marker && marker.attrs.draggable) {\n    // Avoid interfering with drag/drop of point and segment markers.\n    if (marker.attrs.name === 'point-marker' ||\n        marker.attrs.name === 'segment-marker') {\n      return;\n    }\n\n    // Check if we're dragging a segment.\n    if (marker.attrs.name === 'segment-overlay') {\n      segment = marker;\n    }\n  }\n\n  this._lastMouseClientX = Math.floor(\n    event.type === 'touchstart' ? event.evt.touches[0].clientX : event.evt.clientX\n  );\n\n  if (this._handlers.onMouseDown) {\n    const mouseDownPosX = this._getMousePosX(this._lastMouseClientX);\n\n    this._handlers.onMouseDown(mouseDownPosX, segment);\n  }\n\n  // Use the window mousemove and mouseup handlers instead of the\n  // Konva.Stage ones so that we still receive events if the user moves the\n  // mouse outside the stage.\n  window.addEventListener('mousemove', this._mouseMove, { capture: false, passive: true });\n  window.addEventListener('touchmove', this._mouseMove, { capture: false, passive: true });\n  window.addEventListener('mouseup', this._mouseUp, { capture: false, passive: true });\n  window.addEventListener('touchend', this._mouseUp, { capture: false, passive: true });\n  window.addEventListener('blur', this._mouseUp, { capture: false, passive: true });\n};\n\n/**\n * Mouse move event handler.\n *\n * @param {MouseEvent} event\n */\n\nMouseDragHandler.prototype._mouseMove = function(event) {\n  const clientX = Math.floor(\n    event.type === 'touchmove' ? event.changedTouches[0].clientX : event.clientX\n  );\n\n  // Don't update on vertical mouse movement.\n  if (clientX === this._lastMouseClientX) {\n    return;\n  }\n\n  this._lastMouseClientX = clientX;\n\n  this._dragging = true;\n\n  if (this._handlers.onMouseMove) {\n    const mousePosX = this._getMousePosX(clientX);\n\n    this._handlers.onMouseMove(mousePosX);\n  }\n};\n\n/**\n * Mouse up event handler.\n *\n * @param {MouseEvent} event\n */\n\nMouseDragHandler.prototype._mouseUp = function(event) {\n  let clientX;\n\n  if (event.type === 'touchend') {\n    clientX = Math.floor(event.changedTouches[0].clientX);\n\n    if (event.cancelable) {\n      event.preventDefault();\n    }\n  }\n  else {\n    clientX = Math.floor(event.clientX);\n  }\n\n  if (this._handlers.onMouseUp) {\n    const mousePosX = this._getMousePosX(clientX);\n\n    this._handlers.onMouseUp(mousePosX);\n  }\n\n  window.removeEventListener('mousemove', this._mouseMove, { capture: false });\n  window.removeEventListener('touchmove', this._mouseMove, { capture: false });\n  window.removeEventListener('mouseup', this._mouseUp, { capture: false });\n  window.removeEventListener('touchend', this._mouseUp, { capture: false });\n  window.removeEventListener('blur', this._mouseUp, { capture: false });\n\n  this._dragging = false;\n};\n\n/**\n * @returns {Number} The mouse X position, relative to the container that\n * received the mouse down event.\n *\n * @private\n * @param {Number} clientX Mouse client X position.\n */\n\nMouseDragHandler.prototype._getMousePosX = function(clientX) {\n  const containerPos = this._stage.getContainer().getBoundingClientRect();\n\n  return clientX - containerPos.left;\n};\n\n/**\n * Returns <code>true</code> if the mouse is being dragged, i.e., moved with\n * the mouse button held down.\n *\n * @returns {Boolean}\n */\n\nMouseDragHandler.prototype.isDragging = function() {\n  return this._dragging;\n};\n\nexport default MouseDragHandler;\n","/**\n * @file\n *\n * Defines the {@link PlayheadLayer} class.\n *\n * @module playhead-layer\n */\n\nimport Konva from 'konva/lib/Core';\nimport { Animation } from 'konva/lib/Animation';\nimport { Line } from 'konva/lib/shapes/Line';\nimport { Text } from 'konva/lib/shapes/Text';\n\n/**\n * Creates a Konva.Layer that displays a playhead marker.\n *\n * @class\n * @alias PlayheadLayer\n *\n * @param {Object} options\n * @param {Player} options.player\n * @param {WaveformOverview|WaveformZoomView} options.view\n * @param {Boolean} options.showPlayheadTime If <code>true</code> The playback time position\n *   is shown next to the playhead.\n * @param {String} options.playheadColor\n * @param {String} options.playheadTextColor\n * @param {String} options.playheadFontFamily\n * @param {Number} options.playheadFontSize\n * @param {String} options.playheadFontStyle\n */\n\nfunction PlayheadLayer(options) {\n  this._player = options.player;\n  this._view = options.view;\n  this._playheadPixel = 0;\n  this._playheadLineAnimation = null;\n  this._playheadVisible = false;\n  this._playheadColor = options.playheadColor;\n  this._playheadTextColor = options.playheadTextColor;\n\n  this._playheadFontFamily = options.playheadFontFamily;\n  this._playheadFontSize = options.playheadFontSize;\n  this._playheadFontStyle = options.playheadFontStyle;\n\n  this._playheadLayer = new Konva.Layer();\n\n  this._createPlayhead(this._playheadColor);\n\n  if (options.showPlayheadTime) {\n    this._createPlayheadText(this._playheadTextColor);\n  }\n\n  this.fitToView();\n\n  this.zoomLevelChanged();\n}\n\n/**\n * Adds the layer to the given {Konva.Stage}.\n *\n * @param {Konva.Stage} stage\n */\n\nPlayheadLayer.prototype.addToStage = function(stage) {\n  stage.add(this._playheadLayer);\n};\n\n/**\n * Decides whether to use an animation to update the playhead position.\n *\n * If the zoom level is such that the number of pixels per second of audio is\n * low, we can use timeupdate events from the HTMLMediaElement to\n * set the playhead position. Otherwise, we use an animation to update the\n * playhead position more smoothly. The animation is CPU intensive, so we\n * avoid using it where possible.\n */\n\nPlayheadLayer.prototype.zoomLevelChanged = function() {\n  const pixelsPerSecond = this._view.timeToPixels(1.0);\n\n  this._useAnimation = pixelsPerSecond >= 5;\n\n  if (this._useAnimation) {\n    if (this._player.isPlaying() && !this._playheadLineAnimation) {\n      // Start the animation\n      this._start();\n    }\n  }\n  else {\n    if (this._playheadLineAnimation) {\n      // Stop the animation\n      const time = this._player.getCurrentTime();\n\n      this.stop(time);\n    }\n  }\n};\n\n/**\n * Resizes the playhead UI objects to fit the available space in the\n * view.\n */\n\nPlayheadLayer.prototype.fitToView = function() {\n  const height = this._view.getHeight();\n\n  this._playheadLine.points([0.5, 0, 0.5, height]);\n\n  if (this._playheadText) {\n    this._playheadText.y(12);\n  }\n};\n\n/**\n * Creates the playhead UI objects.\n *\n * @private\n * @param {String} color\n */\n\nPlayheadLayer.prototype._createPlayhead = function(color) {\n  // Create with default points, the real values are set in fitToView().\n  this._playheadLine = new Line({\n    stroke:      color,\n    strokeWidth: 1\n  });\n\n  this._playheadGroup = new Konva.Group({\n    x: 0,\n    y: 0\n  });\n\n  this._playheadGroup.add(this._playheadLine);\n  this._playheadLayer.add(this._playheadGroup);\n};\n\nPlayheadLayer.prototype._createPlayheadText = function(color) {\n  const time = this._player.getCurrentTime();\n  const text = this._view.formatTime(time);\n\n  // Create with default y, the real value is set in fitToView().\n  this._playheadText = new Text({\n    x: 2,\n    y: 0,\n    text: text,\n    fontSize: this._playheadFontSize,\n    fontFamily: this._playheadFontFamily,\n    fontStyle: this._playheadFontStyle,\n    fill: color,\n    align: 'right'\n  });\n\n  this._playheadGroup.add(this._playheadText);\n};\n\n/**\n * Updates the playhead position.\n *\n * @param {Number} time Current playhead position, in seconds.\n */\n\nPlayheadLayer.prototype.updatePlayheadTime = function(time) {\n  this._syncPlayhead(time);\n\n  if (this._player.isPlaying()) {\n    this._start();\n  }\n};\n\n/**\n * Updates the playhead position.\n *\n * @private\n * @param {Number} time Current playhead position, in seconds.\n */\n\nPlayheadLayer.prototype._syncPlayhead = function(time) {\n  const pixelIndex = this._view.timeToPixels(time);\n\n  const frameOffset = this._view.getFrameOffset();\n  const width = this._view.getWidth();\n\n  const isVisible = (pixelIndex >= frameOffset) &&\n                    (pixelIndex <= frameOffset + width);\n\n  this._playheadPixel = pixelIndex;\n\n  if (isVisible) {\n    const playheadX = this._playheadPixel - frameOffset;\n\n    if (!this._playheadVisible) {\n      this._playheadVisible = true;\n      this._playheadGroup.show();\n    }\n\n    this._playheadGroup.setX(playheadX);\n\n    if (this._playheadText) {\n      const text = this._view.formatTime(time);\n      const playheadTextWidth = this._playheadText.getTextWidth();\n\n      this._playheadText.setText(text);\n\n      if (playheadTextWidth + playheadX > width - 2) {\n        this._playheadText.setX(-playheadTextWidth - 2);\n      }\n      else if (playheadTextWidth + playheadX < width) {\n        this._playheadText.setX(2);\n      }\n    }\n  }\n  else {\n    if (this._playheadVisible) {\n      this._playheadVisible = false;\n      this._playheadGroup.hide();\n    }\n  }\n\n  if (this._view.playheadPosChanged) {\n    this._view.playheadPosChanged(time);\n  }\n};\n\n/**\n * Starts a playhead animation in sync with the media playback.\n *\n * @private\n */\n\nPlayheadLayer.prototype._start = function() {\n  const self = this;\n\n  if (self._playheadLineAnimation) {\n    self._playheadLineAnimation.stop();\n    self._playheadLineAnimation = null;\n  }\n\n  if (!self._useAnimation) {\n    return;\n  }\n\n  let lastPlayheadPosition = null;\n\n  self._playheadLineAnimation = new Animation(function() {\n    const time = self._player.getCurrentTime();\n    const playheadPosition = self._view.timeToPixels(time);\n\n    if (playheadPosition !== lastPlayheadPosition) {\n      self._syncPlayhead(time);\n      lastPlayheadPosition = playheadPosition;\n    }\n  }, self._playheadLayer);\n\n  self._playheadLineAnimation.start();\n};\n\nPlayheadLayer.prototype.stop = function(time) {\n  if (this._playheadLineAnimation) {\n    this._playheadLineAnimation.stop();\n    this._playheadLineAnimation = null;\n  }\n\n  this._syncPlayhead(time);\n};\n\n/**\n * Returns the position of the playhead marker, in pixels relative to the\n * left hand side of the waveform view.\n *\n * @return {Number}\n */\n\nPlayheadLayer.prototype.getPlayheadOffset = function() {\n  return this._playheadPixel - this._view.getFrameOffset();\n};\n\nPlayheadLayer.prototype.getPlayheadPixel = function() {\n  return this._playheadPixel;\n};\n\nPlayheadLayer.prototype.showPlayheadTime = function(show) {\n  if (show) {\n    if (!this._playheadText) {\n      // Create it\n      this._createPlayheadText(this._playheadTextColor);\n      this.fitToView();\n    }\n  }\n  else {\n    if (this._playheadText) {\n      this._playheadText.remove();\n      this._playheadText.destroy();\n      this._playheadText = null;\n    }\n  }\n};\n\nPlayheadLayer.prototype.updatePlayheadText = function() {\n  if (this._playheadText) {\n    const time = this._player.getCurrentTime();\n    const text = this._view.formatTime(time);\n\n    this._playheadText.setText(text);\n  }\n};\n\nPlayheadLayer.prototype.destroy = function() {\n  if (this._playheadLineAnimation) {\n    this._playheadLineAnimation.stop();\n    this._playheadLineAnimation = null;\n  }\n};\n\nexport default PlayheadLayer;\n","/**\n * @file\n *\n * Defines the {@link PointMarker} class.\n *\n * @module point-marker\n */\n\nimport Konva from 'konva/lib/Core';\n\n/**\n * Parameters for the {@link PointMarker} constructor.\n *\n * @typedef {Object} PointMarkerOptions\n * @global\n * @property {Point} point Point object with timestamp.\n * @property {Boolean} draggable If true, marker is draggable.\n * @property {Marker} marker\n * @property {Function} onclick\n * @property {Function} onDblClick\n * @property {Function} onDragStart\n * @property {Function} onDragMove Callback during mouse drag operations.\n * @property {Function} onDragEnd\n * @property {Function} dragBoundFunc\n * @property {Function} onMouseEnter\n * @property {Function} onMouseLeave\n * @property {Function} onContextMenu\n */\n\n/**\n * Creates a point marker handle.\n *\n * @class\n * @alias PointMarker\n *\n * @param {PointMarkerOptions} options\n */\n\nfunction PointMarker(options) {\n  this._point     = options.point;\n  this._marker    = options.marker;\n  this._draggable = options.draggable;\n\n  this._onDragStart   = options.onDragStart;\n  this._onDragMove    = options.onDragMove;\n  this._onDragEnd     = options.onDragEnd;\n  this._dragBoundFunc = options.dragBoundFunc;\n  this._onMouseEnter  = options.onMouseEnter;\n  this._onMouseLeave  = options.onMouseLeave;\n\n  this._group = new Konva.Group({\n    name:          'point-marker',\n    point:         this._point,\n    draggable:     this._draggable,\n    dragBoundFunc: options.dragBoundFunc\n  });\n\n  this._bindDefaultEventHandlers();\n\n  this._marker.init(this._group);\n}\n\nPointMarker.prototype._bindDefaultEventHandlers = function() {\n  const self = this;\n\n  self._group.on('dragstart', function(event) {\n    self._onDragStart(event, self._point);\n  });\n\n  self._group.on('dragmove', function(event) {\n    self._onDragMove(event, self._point);\n  });\n\n  self._group.on('dragend', function(event) {\n    self._onDragEnd(event, self._point);\n  });\n\n  self._group.on('mouseenter', function(event) {\n    self._onMouseEnter(event, self._point);\n  });\n\n  self._group.on('mouseleave', function(event) {\n    self._onMouseLeave(event, self._point);\n  });\n};\n\n/**\n * @param {Konva.Layer} layer\n */\n\nPointMarker.prototype.addToLayer = function(layer) {\n  layer.add(this._group);\n};\n\nPointMarker.prototype.fitToView = function() {\n  this._marker.fitToView();\n};\n\nPointMarker.prototype.getPoint = function() {\n  return this._point;\n};\n\nPointMarker.prototype.getX = function() {\n  return this._group.getX();\n};\n\nPointMarker.prototype.setX = function(x) {\n  this._group.setX(x);\n};\n\nPointMarker.prototype.getWidth = function() {\n  return this._group.getWidth();\n};\n\nPointMarker.prototype.getAbsolutePosition = function() {\n  return this._group.getAbsolutePosition();\n};\n\nPointMarker.prototype.timeUpdated = function(time) {\n  if (this._marker.timeUpdated) {\n    this._marker.timeUpdated(time);\n  }\n};\n\nPointMarker.prototype.update = function() {\n  if (this._marker.update) {\n    this._marker.update();\n  }\n};\n\nPointMarker.prototype.destroy = function() {\n  if (this._marker.destroy) {\n    this._marker.destroy();\n  }\n\n  this._group.destroyChildren();\n  this._group.destroy();\n};\n\nexport default PointMarker;\n","/**\n * @file\n *\n * Defines the {@link PointsLayer} class.\n *\n * @module points-layer\n */\n\nimport PointMarker from './point-marker';\nimport { clamp, objectHasProperty } from './utils';\nimport Konva from 'konva/lib/Core';\n\nconst defaultFontFamily = 'sans-serif';\nconst defaultFontSize = 10;\nconst defaultFontShape = 'normal';\n\n/**\n * Creates a Konva.Layer that displays point markers against the audio\n * waveform.\n *\n * @class\n * @alias PointsLayer\n *\n * @param {Peaks} peaks\n * @param {WaveformOverview|WaveformZoomView} view\n * @param {Boolean} allowEditing\n */\n\nfunction PointsLayer(peaks, view, allowEditing) {\n  this._peaks        = peaks;\n  this._view         = view;\n  this._allowEditing = allowEditing;\n  this._pointMarkers = {};\n  this._layer        = new Konva.Layer();\n\n  this._onPointsDrag = this._onPointsDrag.bind(this);\n\n  this._onPointMarkerDragStart   = this._onPointMarkerDragStart.bind(this);\n  this._onPointMarkerDragMove    = this._onPointMarkerDragMove.bind(this);\n  this._onPointMarkerDragEnd     = this._onPointMarkerDragEnd.bind(this);\n  this._pointMarkerDragBoundFunc = this._pointMarkerDragBoundFunc.bind(this);\n  this._onPointMarkerMouseEnter  = this._onPointMarkerMouseEnter.bind(this);\n  this._onPointMarkerMouseLeave  = this._onPointMarkerMouseLeave.bind(this);\n\n  this._onPointsUpdate    = this._onPointsUpdate.bind(this);\n  this._onPointsAdd       = this._onPointsAdd.bind(this);\n  this._onPointsRemove    = this._onPointsRemove.bind(this);\n  this._onPointsRemoveAll = this._onPointsRemoveAll.bind(this);\n\n  this._peaks.on('points.update', this._onPointsUpdate);\n  this._peaks.on('points.add', this._onPointsAdd);\n  this._peaks.on('points.remove', this._onPointsRemove);\n  this._peaks.on('points.remove_all', this._onPointsRemoveAll);\n\n  this._peaks.on('points.dragstart', this._onPointsDrag);\n  this._peaks.on('points.dragmove', this._onPointsDrag);\n  this._peaks.on('points.dragend', this._onPointsDrag);\n}\n\n/**\n * Adds the layer to the given {Konva.Stage}.\n *\n * @param {Konva.Stage} stage\n */\n\nPointsLayer.prototype.addToStage = function(stage) {\n  stage.add(this._layer);\n};\n\nPointsLayer.prototype.enableEditing = function(enable) {\n  this._allowEditing = enable;\n};\n\nPointsLayer.prototype.formatTime = function(time) {\n  return this._view.formatTime(time);\n};\n\nPointsLayer.prototype._onPointsUpdate = function(point, options) {\n  const frameStartTime = this._view.getStartTime();\n  const frameEndTime   = this._view.getEndTime();\n\n  const pointMarker = this._pointMarkers[point.id];\n  const isVisible = point.isVisible(frameStartTime, frameEndTime);\n\n  if (pointMarker && !isVisible) {\n    // Remove point marker that is no longer visible.\n    this._removePoint(point);\n  }\n  else if (!pointMarker && isVisible) {\n    // Add point marker for visible point.\n    this._updatePoint(point);\n  }\n  else if (pointMarker && isVisible) {\n    // Update the point marker with the changed attributes.\n    if (objectHasProperty(options, 'time')) {\n      const pointMarkerOffset = this._view.timeToPixels(point.time);\n\n      const pointMarkerX = pointMarkerOffset - this._view.getFrameOffset();\n\n      pointMarker.setX(pointMarkerX);\n      pointMarker.timeUpdated(point.time);\n    }\n\n    pointMarker.update();\n  }\n};\n\nPointsLayer.prototype._onPointsAdd = function(points) {\n  const self = this;\n\n  const frameStartTime = self._view.getStartTime();\n  const frameEndTime   = self._view.getEndTime();\n\n  points.forEach(function(point) {\n    if (point.isVisible(frameStartTime, frameEndTime)) {\n      self._updatePoint(point);\n    }\n  });\n};\n\nPointsLayer.prototype._onPointsRemove = function(points) {\n  const self = this;\n\n  points.forEach(function(point) {\n    self._removePoint(point);\n  });\n};\n\nPointsLayer.prototype._onPointsRemoveAll = function() {\n  this._layer.removeChildren();\n  this._pointMarkers = {};\n};\n\n/**\n * Creates the Konva UI objects for a given point.\n *\n * @private\n * @param {Point} point\n * @returns {PointMarker}\n */\n\nPointsLayer.prototype._createPointMarker = function(point) {\n  const editable = this._allowEditing && point.editable;\n\n  const marker = this._peaks.options.createPointMarker({\n    point:      point,\n    draggable:  editable,\n    color:      point.color ? point.color : this._peaks.options.pointMarkerColor,\n    fontFamily: this._peaks.options.fontFamily || defaultFontFamily,\n    fontSize:   this._peaks.options.fontSize || defaultFontSize,\n    fontStyle:  this._peaks.options.fontStyle || defaultFontShape,\n    layer:      this,\n    view:       this._view.getName()\n  });\n\n  return new PointMarker({\n    point:         point,\n    draggable:     editable,\n    marker:        marker,\n    onDragStart:   this._onPointMarkerDragStart,\n    onDragMove:    this._onPointMarkerDragMove,\n    onDragEnd:     this._onPointMarkerDragEnd,\n    dragBoundFunc: this._pointMarkerDragBoundFunc,\n    onMouseEnter:  this._onPointMarkerMouseEnter,\n    onMouseLeave:  this._onPointMarkerMouseLeave\n  });\n};\n\nPointsLayer.prototype.getHeight = function() {\n  return this._view.getHeight();\n};\n\n/**\n * Adds a Konva UI object to the layer for a given point.\n *\n * @private\n * @param {Point} point\n * @returns {PointMarker}\n */\n\nPointsLayer.prototype._addPointMarker = function(point) {\n  const pointMarker = this._createPointMarker(point);\n\n  this._pointMarkers[point.id] = pointMarker;\n\n  pointMarker.addToLayer(this._layer);\n\n  return pointMarker;\n};\n\nPointsLayer.prototype._onPointsDrag = function(event) {\n  const pointMarker = this._updatePoint(event.point);\n\n  pointMarker.timeUpdated(event.point.time);\n  pointMarker.update();\n};\n\n/**\n * @param {Point} point\n */\n\nPointsLayer.prototype._onPointMarkerDragMove = function(event, point) {\n  const pointMarker = this._pointMarkers[point.id];\n\n  const markerX = pointMarker.getX();\n\n  const offset = markerX + pointMarker.getWidth();\n\n  point._setTime(this._view.pixelOffsetToTime(offset));\n\n  this._peaks.emit('points.dragmove', {\n    point: point,\n    evt: event.evt\n  });\n};\n\n/**\n * @param {KonvaEventObject} event\n * @param {Point} point\n */\n\nPointsLayer.prototype._onPointMarkerMouseEnter = function(event, point) {\n  this._peaks.emit('points.mouseenter', {\n    point: point,\n    evt: event.evt\n  });\n};\n\n/**\n * @param {KonvaEventObject} event\n * @param {Point} point\n */\n\nPointsLayer.prototype._onPointMarkerMouseLeave = function(event, point) {\n  this._peaks.emit('points.mouseleave', {\n    point: point,\n    evt: event.evt\n  });\n};\n\n/**\n * @param {KonvaEventObject} event\n * @param {Point} point\n */\n\nPointsLayer.prototype._onPointMarkerDragStart = function(event, point) {\n  this._dragPointMarker = this._pointMarkers[point.id];\n\n  this._peaks.emit('points.dragstart', {\n    point: point,\n    evt: event.evt\n  });\n};\n\n/**\n * @param {KonvaEventObject} event\n * @param {Point} point\n */\n\nPointsLayer.prototype._onPointMarkerDragEnd = function(event, point) {\n  this._dragPointMarker = null;\n\n  this._peaks.emit('points.dragend', {\n    point: point,\n    evt: event.evt\n  });\n};\n\nPointsLayer.prototype._pointMarkerDragBoundFunc = function(pos) {\n  // Allow the marker to be moved horizontally but not vertically.\n  return {\n    x: clamp(pos.x, 0, this._view.getWidth()),\n    y: this._dragPointMarker.getAbsolutePosition().y\n  };\n};\n\n/**\n * Updates the positions of all displayed points in the view.\n *\n * @param {Number} startTime The start of the visible range in the view,\n *   in seconds.\n * @param {Number} endTime The end of the visible range in the view,\n *   in seconds.\n */\n\nPointsLayer.prototype.updatePoints = function(startTime, endTime) {\n  // Update all points in the visible time range.\n  const points = this._peaks.points.find(startTime, endTime);\n\n  points.forEach(this._updatePoint.bind(this));\n\n  // TODO: In the overview all points are visible, so no need to do this.\n  this._removeInvisiblePoints(startTime, endTime);\n};\n\n/**\n * @private\n * @param {Point} point\n */\n\nPointsLayer.prototype._updatePoint = function(point) {\n  const pointMarker = this._findOrAddPointMarker(point);\n\n  const pointMarkerOffset = this._view.timeToPixels(point.time);\n  const pointMarkerX = pointMarkerOffset - this._view.getFrameOffset();\n\n  pointMarker.setX(pointMarkerX);\n\n  return pointMarker;\n};\n\n/**\n * @private\n * @param {Point} point\n * @return {PointMarker}\n */\n\nPointsLayer.prototype._findOrAddPointMarker = function(point) {\n  let pointMarker = this._pointMarkers[point.id];\n\n  if (!pointMarker) {\n    pointMarker = this._addPointMarker(point);\n  }\n\n  return pointMarker;\n};\n\n/**\n * Remove any points that are not visible, i.e., are outside the given time\n * range.\n *\n * @private\n * @param {Number} startTime The start of the visible time range, in seconds.\n * @param {Number} endTime The end of the visible time range, in seconds.\n */\n\nPointsLayer.prototype._removeInvisiblePoints = function(startTime, endTime) {\n  for (const pointId in this._pointMarkers) {\n    if (objectHasProperty(this._pointMarkers, pointId)) {\n      const point = this._pointMarkers[pointId].getPoint();\n\n      if (!point.isVisible(startTime, endTime)) {\n        this._removePoint(point);\n      }\n    }\n  }\n};\n\n/**\n * Removes the UI object for a given point.\n *\n * @private\n * @param {Point} point\n */\n\nPointsLayer.prototype._removePoint = function(point) {\n  const pointMarker = this._pointMarkers[point.id];\n\n  if (pointMarker) {\n    pointMarker.destroy();\n    delete this._pointMarkers[point.id];\n  }\n};\n\n/**\n * Toggles visibility of the points layer.\n *\n * @param {Boolean} visible\n */\n\nPointsLayer.prototype.setVisible = function(visible) {\n  this._layer.setVisible(visible);\n};\n\nPointsLayer.prototype.destroy = function() {\n  this._peaks.off('points.update', this._onPointsUpdate);\n  this._peaks.off('points.add', this._onPointsAdd);\n  this._peaks.off('points.remove', this._onPointsRemove);\n  this._peaks.off('points.remove_all', this._onPointsRemoveAll);\n  this._peaks.off('points.dragstart', this._onPointsDrag);\n  this._peaks.off('points.dragmove', this._onPointsDrag);\n  this._peaks.off('points.dragend', this._onPointsDrag);\n};\n\nPointsLayer.prototype.fitToView = function() {\n  for (const pointId in this._pointMarkers) {\n    if (objectHasProperty(this._pointMarkers, pointId)) {\n      const pointMarker = this._pointMarkers[pointId];\n\n      pointMarker.fitToView();\n    }\n  }\n};\n\nPointsLayer.prototype.draw = function() {\n  this._layer.draw();\n};\n\nexport default PointsLayer;\n","/**\n * @file\n *\n * Defines the {@link OverlaySegmentMarker} class.\n *\n * @module overlay-segment-marker\n */\n\nimport { Rect } from 'konva/lib/shapes/Rect';\nimport { Text } from 'konva/lib/shapes/Text';\n\nimport { clamp } from './utils';\n\n/**\n * Creates a segment marker handle.\n *\n * @class\n * @alias OverlaySegmentMarker\n *\n * @param {CreateSegmentMarkerOptions} options\n */\n\nfunction OverlaySegmentMarker(options) {\n  this._options = options;\n}\n\nOverlaySegmentMarker.prototype.init = function(group) {\n  const handleWidth  = 10;\n  const handleHeight = 20;\n  const handleX      = -(handleWidth / 2) + 0.5; // Place in the middle of the marker\n\n  const xPosition = this._options.startMarker ? -24 : 24;\n\n  const time = this._options.startMarker ? this._options.segment.startTime :\n                                           this._options.segment.endTime;\n\n  // Label - create with default y, the real value is set in fitToView().\n  this._label = new Text({\n    x:          xPosition,\n    y:          0,\n    text:       this._options.layer.formatTime(time),\n    fontFamily: this._options.fontFamily,\n    fontSize:   this._options.fontSize,\n    fontStyle:  this._options.fontStyle,\n    fill:       '#000',\n    textAlign:  'center'\n  });\n\n  this._label.hide();\n\n  // Handle - create with default y, the real value is set in fitToView().\n  this._handle = new Rect({\n    x:      handleX,\n    y:      0,\n    width:  handleWidth,\n    height: handleHeight\n  });\n\n  group.add(this._label);\n  group.add(this._handle);\n\n  this.fitToView();\n\n  this.bindEventHandlers(group);\n};\n\nOverlaySegmentMarker.prototype.bindEventHandlers = function(group) {\n  const self = this;\n\n  const xPosition = self._options.startMarker ? -24 : 24;\n\n  if (self._options.draggable) {\n    group.on('dragstart', function() {\n      if (self._options.startMarker) {\n        self._label.setX(xPosition - self._label.getWidth());\n      }\n\n      self._label.show();\n    });\n\n    group.on('dragend', function() {\n      self._label.hide();\n    });\n  }\n\n  self._handle.on('mouseover touchstart', function() {\n    if (self._options.startMarker) {\n      self._label.setX(xPosition - self._label.getWidth());\n    }\n\n    self._label.show();\n\n    document.body.style.cursor = 'ew-resize';\n  });\n\n  self._handle.on('mouseout touchend', function() {\n    self._label.hide();\n\n    document.body.style.cursor = 'default';\n  });\n};\n\nOverlaySegmentMarker.prototype.fitToView = function() {\n  const viewHeight = this._options.layer.getHeight();\n\n  const overlayOffset = this._options.segmentOptions.overlayOffset;\n  const overlayRectHeight = clamp(0, viewHeight - 2 * overlayOffset);\n\n  this._label.y(viewHeight / 2 - 5);\n  this._handle.y(overlayOffset);\n  this._handle.height(overlayRectHeight);\n};\n\nOverlaySegmentMarker.prototype.timeUpdated = function(time) {\n  this._label.setText(this._options.layer.formatTime(time));\n};\n\nexport default OverlaySegmentMarker;\n","/**\n * @file\n *\n * Defines the {@link SegmentMarker} class.\n *\n * @module segment-marker\n */\n\nimport Konva from 'konva/lib/Core';\n\n/**\n * Parameters for the {@link SegmentMarker} constructor.\n *\n * @typedef {Object} SegmentMarkerOptions\n * @global\n * @property {Segment} segment\n * @property {SegmentShape} segmentShape\n * @property {Boolean} draggable If true, marker is draggable.\n * @property {Boolean} startMarker If <code>true</code>, the marker indicates\n *   the start time of the segment. If <code>false</code>, the marker\n *   indicates the end time of the segment.\n * @property {Function} onDragStart\n * @property {Function} onDragMove\n * @property {Function} onDragEnd\n * @property {Function} dragBoundFunc\n */\n\n/**\n * Creates a segment handle marker for the start or end of a segment.\n *\n * @class\n * @alias SegmentMarker\n *\n * @param {SegmentMarkerOptions} options\n */\n\nfunction SegmentMarker(options) {\n  const self = this;\n\n  self._segment       = options.segment;\n  self._marker        = options.marker;\n  self._segmentShape  = options.segmentShape;\n  self._draggable     = options.draggable;\n  self._startMarker   = options.startMarker;\n\n  self._onDragStart   = options.onDragStart;\n  self._onDragMove    = options.onDragMove;\n  self._onDragEnd     = options.onDragEnd;\n\n  self._group = new Konva.Group({\n    name:          'segment-marker',\n    segment:       self._segment,\n    draggable:     self._draggable,\n    dragBoundFunc: function(pos) {\n      return options.dragBoundFunc(self, pos);\n    }\n  });\n\n  self._bindDefaultEventHandlers();\n\n  self._marker.init(self._group);\n}\n\nSegmentMarker.prototype._bindDefaultEventHandlers = function() {\n  const self = this;\n\n  if (self._draggable) {\n    self._group.on('dragstart', function(event) {\n      self._onDragStart(self, event);\n    });\n\n    self._group.on('dragmove', function(event) {\n      self._onDragMove(self, event);\n    });\n\n    self._group.on('dragend', function(event) {\n      self._onDragEnd(self, event);\n    });\n  }\n};\n\nSegmentMarker.prototype.addToLayer = function(layer) {\n  layer.add(this._group);\n};\n\nSegmentMarker.prototype.moveToTop = function() {\n  this._group.moveToTop();\n};\n\nSegmentMarker.prototype.fitToView = function() {\n  this._marker.fitToView();\n};\n\nSegmentMarker.prototype.getSegment = function() {\n  return this._segment;\n};\n\nSegmentMarker.prototype.getX = function() {\n  return this._group.getX();\n};\n\nSegmentMarker.prototype.setX = function(x) {\n  this._group.setX(x);\n};\n\nSegmentMarker.prototype.getWidth = function() {\n  return this._group.getWidth();\n};\n\nSegmentMarker.prototype.getAbsolutePosition = function() {\n  return this._group.getAbsolutePosition();\n};\n\nSegmentMarker.prototype.isStartMarker = function() {\n  return this._startMarker;\n};\n\nSegmentMarker.prototype.timeUpdated = function(time) {\n  if (this._marker.timeUpdated) {\n    this._marker.timeUpdated(time);\n  }\n};\n\nSegmentMarker.prototype.update = function(options) {\n  if (this._marker.update) {\n    this._marker.update(options);\n  }\n};\n\nSegmentMarker.prototype.destroy = function() {\n  if (this._marker.destroy) {\n    this._marker.destroy();\n  }\n\n  this._group.destroyChildren();\n  this._group.destroy();\n};\n\nexport default SegmentMarker;\n","/**\n * @file\n *\n * Defines the {@link WaveformShape} class.\n *\n * @module waveform-shape\n */\n\nimport { clamp, isLinearGradientColor, isString } from './utils';\nimport Konva from 'konva/lib/Core';\n\n/**\n * Waveform shape options.\n *\n * @typedef {Object} WaveformShapeOptions\n * @global\n * @property {String | LinearGradientColor} color Waveform color.\n * @property {WaveformOverview|WaveformZoomView} view The view object\n *   that contains the waveform shape.\n * @property {Segment?} segment If given, render a waveform image\n *   covering the segment's time range. Otherwise, render the entire\n *   waveform duration.\n */\n\n/**\n * Creates a Konva.Shape object that renders a waveform image.\n *\n * @class\n * @alias WaveformShape\n *\n * @param {WaveformShapeOptions} options\n */\n\nfunction WaveformShape(options) {\n  this._color = options.color;\n\n  const shapeOptions = {};\n\n  if (isString(options.color)) {\n    shapeOptions.fill = options.color;\n  }\n  else if (isLinearGradientColor(options.color)) {\n    const startY = options.view._height * (options.color.linearGradientStart / 100);\n    const endY = options.view._height * (options.color.linearGradientEnd / 100);\n\n    shapeOptions.fillLinearGradientStartPointY = startY;\n    shapeOptions.fillLinearGradientEndPointY = endY;\n    shapeOptions.fillLinearGradientColorStops = [\n      0, options.color.linearGradientColorStops[0],\n      1, options.color.linearGradientColorStops[1]\n    ];\n  }\n  else {\n    throw new TypeError('Unknown type for color property');\n  }\n\n  this._shape = new Konva.Shape(shapeOptions);\n  this._view = options.view;\n  this._segment = options.segment;\n\n  this._shape.sceneFunc(this._sceneFunc.bind(this));\n}\n\nWaveformShape.prototype.getX = function() {\n  return this._shape.getX();\n};\n\nWaveformShape.prototype.setX = function(x) {\n  return this._shape.setX(x);\n};\n\nWaveformShape.prototype.setSegment = function(segment) {\n  this._segment = segment;\n};\n\nWaveformShape.prototype.setWaveformColor = function(color) {\n  if (isString(color)) {\n    this._shape.fill(color);\n\n    this._shape.fillLinearGradientStartPointY(null);\n    this._shape.fillLinearGradientEndPointY(null);\n    this._shape.fillLinearGradientColorStops(null);\n  }\n  else if (isLinearGradientColor(color)) {\n    this._shape.fill(null);\n\n    const startY = this._view._height * (color.linearGradientStart / 100);\n    const endY = this._view._height * (color.linearGradientEnd / 100);\n\n    this._shape.fillLinearGradientStartPointY(startY);\n    this._shape.fillLinearGradientEndPointY(endY);\n    this._shape.fillLinearGradientColorStops([\n      0, color.linearGradientColorStops[0],\n      1, color.linearGradientColorStops[1]\n    ]);\n  }\n  else {\n    throw new TypeError('Unknown type for color property');\n  }\n};\n\nWaveformShape.prototype.fitToView = function() {\n  this.setWaveformColor(this._color);\n};\n\nWaveformShape.prototype._sceneFunc = function(context) {\n  const frameOffset = this._view.getFrameOffset();\n  const width = this._view.getWidth();\n  const height = this._view.getHeight();\n\n  this._drawWaveform(\n    context,\n    this._view.getWaveformData(),\n    frameOffset,\n    this._segment ? this._view.timeToPixels(this._segment.startTime) : frameOffset,\n    this._segment ? this._view.timeToPixels(this._segment.endTime)   : frameOffset + width,\n    width,\n    height\n  );\n};\n\n/**\n * Draws a waveform on a canvas context.\n *\n * @param {Konva.Context} context The canvas context to draw on.\n * @param {WaveformData} waveformData The waveform data to draw.\n * @param {Number} frameOffset The start position of the waveform shown\n *   in the view, in pixels.\n * @param {Number} startPixels The start position of the waveform to draw,\n *   in pixels.\n * @param {Number} endPixels The end position of the waveform to draw,\n *   in pixels.\n * @param {Number} width The width of the waveform area, in pixels.\n * @param {Number} height The height of the waveform area, in pixels.\n */\n\nWaveformShape.prototype._drawWaveform = function(context, waveformData,\n    frameOffset, startPixels, endPixels, width, height) {\n  if (startPixels < frameOffset) {\n    startPixels = frameOffset;\n  }\n\n  const limit = frameOffset + width;\n\n  if (endPixels > limit) {\n    endPixels = limit;\n  }\n\n  if (endPixels > waveformData.length - 1) {\n    endPixels = waveformData.length - 1;\n  }\n\n  const channels = waveformData.channels;\n\n  let waveformTop = 0;\n  let waveformHeight = Math.floor(height / channels);\n\n  for (let i = 0; i < channels; i++) {\n    if (i === channels - 1) {\n      waveformHeight = height - (channels - 1) * waveformHeight;\n    }\n\n    this._drawChannel(\n      context,\n      waveformData.channel(i),\n      frameOffset,\n      startPixels,\n      endPixels,\n      waveformTop,\n      waveformHeight\n    );\n\n    waveformTop += waveformHeight;\n  }\n};\n\n/**\n * Draws a single waveform channel on a canvas context.\n *\n * @param {Konva.Context} context The canvas context to draw on.\n * @param {WaveformDataChannel} channel The waveform data to draw.\n * @param {Number} frameOffset The start position of the waveform shown\n *   in the view, in pixels.\n * @param {Number} startPixels The start position of the waveform to draw,\n *   in pixels.\n * @param {Number} endPixels The end position of the waveform to draw,\n *   in pixels.\n * @param {Number} top The top of the waveform channel area, in pixels.\n * @param {Number} height The height of the waveform channel area, in pixels.\n */\n\nWaveformShape.prototype._drawChannel = function(context, channel,\n    frameOffset, startPixels, endPixels, top, height) {\n  let x, amplitude;\n\n  const amplitudeScale = this._view.getAmplitudeScale();\n\n  let lineX, lineY;\n\n  context.beginPath();\n\n  for (x = startPixels; x <= endPixels; x++) {\n    amplitude = channel.min_sample(x);\n\n    lineX = x - frameOffset + 0.5;\n    lineY = top + WaveformShape.scaleY(amplitude, height, amplitudeScale) + 0.5;\n\n    context.lineTo(lineX, lineY);\n  }\n\n  for (x = endPixels; x >= startPixels; x--) {\n    amplitude = channel.max_sample(x);\n\n    lineX = x - frameOffset + 0.5;\n    lineY = top + WaveformShape.scaleY(amplitude, height, amplitudeScale) + 1.0;\n\n    context.lineTo(lineX, lineY);\n  }\n\n  context.closePath();\n\n  context.fillShape(this._shape);\n};\n\nWaveformShape.prototype.addToLayer = function(layer) {\n  layer.add(this._shape);\n};\n\nWaveformShape.prototype.destroy = function() {\n  this._shape.destroy();\n  this._shape = null;\n};\n\nWaveformShape.prototype.on = function(event, handler) {\n  this._shape.on(event, handler);\n};\n\nWaveformShape.prototype.off = function(event, handler) {\n  this._shape.off(event, handler);\n};\n\n/**\n * Scales the waveform data for drawing on a canvas context.\n *\n * @see {@link https://stats.stackexchange.com/questions/281162}\n *\n * @todo Assumes 8-bit waveform data (-128 to 127 range)\n *\n * @param {Number} amplitude The waveform data point amplitude.\n * @param {Number} height The height of the waveform, in pixels.\n * @param {Number} scale Amplitude scaling factor.\n * @returns {Number} The scaled waveform data point.\n */\n\nWaveformShape.scaleY = function(amplitude, height, scale) {\n  const y = -(height - 1) * (amplitude * scale + 128) / 255 + (height - 1);\n\n  return clamp(Math.floor(y), 0, height - 1);\n};\n\nexport default WaveformShape;\n","/**\n * @file\n *\n * Defines the {@link SegmentShape} class.\n *\n * @module segment-shape\n */\n\nimport Konva from 'konva/lib/Core';\n\nimport OverlaySegmentMarker from './overlay-segment-marker';\nimport SegmentMarker from './segment-marker';\nimport WaveformShape from './waveform-shape';\nimport { clamp, objectHasProperty } from './utils';\n\nconst defaultFontFamily = 'sans-serif';\nconst defaultFontSize = 10;\nconst defaultFontShape = 'normal';\n\n/**\n * Options that control segments' visual appearance\n *\n * @typedef {Object} SegmentDisplayOptions\n * @global\n * @property {Boolean} markers\n * @property {Boolean} overlay\n * @property {String} startMarkerColor\n * @property {String} endMarkerColor\n * @property {String} waveformColor\n * @property {String} overlayColor\n * @property {Number} overlayOpacity\n * @property {String} overlayBorderColor\n * @property {Number} overlayBorderWidth\n * @property {Number} overlayCornerRadius\n * @property {Number} overlayOffset\n * @property {String} overlayLabelAlign\n * @property {String} overlayLabelVerticalAlign\n * @property {Number} overlayLabelPadding\n * @property {String} overlayLabelColor\n * @property {String} overlayFontFamily\n * @property {Number} overlayFontSize\n * @property {String} overlayFontStyle\n */\n\n/**\n * Creates a waveform segment shape with optional start and end markers.\n *\n * @class\n * @alias SegmentShape\n *\n * @param {Segment} segment\n * @param {Peaks} peaks\n * @param {SegmentsLayer} layer\n * @param {WaveformOverview|WaveformZoomView} view\n */\n\nfunction SegmentShape(segment, peaks, layer, view) {\n  this._segment     = segment;\n  this._peaks       = peaks;\n  this._layer       = layer;\n  this._view        = view;\n  this._label       = null;\n  this._startMarker = null;\n  this._endMarker   = null;\n  this._color       = segment.color;\n  this._borderColor = segment.borderColor;\n  this._draggable   = this._segment.editable && this._view.isSegmentDraggingEnabled();\n  this._dragging    = false;\n\n  const segmentOptions = view.getViewOptions().segmentOptions;\n\n  this._overlayOffset = segmentOptions.overlayOffset;\n\n  if (!segmentOptions.overlay) {\n    this._waveformShape = new WaveformShape({\n      color:   segment.color,\n      view:    view,\n      segment: segment\n    });\n  }\n\n  this._onMouseEnter  = this._onMouseEnter.bind(this);\n  this._onMouseLeave  = this._onMouseLeave.bind(this);\n  this._onMouseDown   = this._onMouseDown.bind(this);\n  this._onMouseUp     = this._onMouseUp.bind(this);\n\n  this._dragBoundFunc      = this._dragBoundFunc.bind(this);\n  this._onSegmentDragStart = this._onSegmentDragStart.bind(this);\n  this._onSegmentDragMove  = this._onSegmentDragMove.bind(this);\n  this._onSegmentDragEnd   = this._onSegmentDragEnd.bind(this);\n\n  // Event handlers for markers\n  this._onSegmentMarkerDragStart   = this._onSegmentMarkerDragStart.bind(this);\n  this._onSegmentMarkerDragMove    = this._onSegmentMarkerDragMove.bind(this);\n  this._onSegmentMarkerDragEnd     = this._onSegmentMarkerDragEnd.bind(this);\n  this._segmentMarkerDragBoundFunc = this._segmentMarkerDragBoundFunc.bind(this);\n\n  this._label = this._peaks.options.createSegmentLabel({\n    segment:    segment,\n    view:       this._view.getName(),\n    layer:      this._layer,\n    fontFamily: this._peaks.options.fontFamily,\n    fontSize:   this._peaks.options.fontSize,\n    fontStyle:  this._peaks.options.fontStyle\n  });\n\n  if (this._label) {\n    this._label.hide();\n  }\n\n  // Create with default y and height, the real values are set in fitToView().\n  const segmentStartOffset = this._view.timeToPixelOffset(this._segment.startTime);\n  const segmentEndOffset   = this._view.timeToPixelOffset(this._segment.endTime);\n\n  const overlayRectHeight = clamp(0, this._view.getHeight());\n\n  this._overlay = new Konva.Group({\n    name:          'segment-overlay',\n    segment:       this._segment,\n    x:             segmentStartOffset,\n    y:             0,\n    width:         segmentEndOffset - segmentStartOffset,\n    height:        this._view.getHeight(),\n    clipX:         0,\n    clipY:         this._overlayOffset,\n    clipWidth:     segmentEndOffset - segmentStartOffset,\n    clipHeight:    overlayRectHeight,\n    draggable:     this._draggable,\n    dragBoundFunc: this._dragBoundFunc\n  });\n\n  let overlayBorderColor, overlayBorderWidth, overlayColor, overlayOpacity, overlayCornerRadius;\n\n  if (segmentOptions.overlay) {\n    overlayBorderColor  = this._borderColor || segmentOptions.overlayBorderColor;\n    overlayBorderWidth  = segmentOptions.overlayBorderWidth;\n    overlayColor        = this._color || segmentOptions.overlayColor;\n    overlayOpacity      = segmentOptions.overlayOpacity;\n    overlayCornerRadius = segmentOptions.overlayCornerRadius;\n  }\n\n  this._overlayRect = new Konva.Rect({\n    x:            0,\n    y:            this._overlayOffset,\n    width:        segmentEndOffset - segmentStartOffset,\n    stroke:       overlayBorderColor,\n    strokeWidth:  overlayBorderWidth,\n    height:       overlayRectHeight,\n    fill:         overlayColor,\n    opacity:      overlayOpacity,\n    cornerRadius: overlayCornerRadius\n  });\n\n  this._overlay.add(this._overlayRect);\n\n  if (segmentOptions.overlay) {\n    this._overlayText = new Konva.Text({\n      x:             0,\n      y:             this._overlayOffset,\n      text:          this._segment.labelText,\n      fontFamily:    segmentOptions.overlayFontFamily,\n      fontSize:      segmentOptions.overlayFontSize,\n      fontStyle:     segmentOptions.overlayFontStyle,\n      fill:          segmentOptions.overlayLabelColor,\n      listening:     false,\n      align:         segmentOptions.overlayLabelAlign,\n      width:         segmentEndOffset - segmentStartOffset,\n      verticalAlign: segmentOptions.overlayLabelVerticalAlign,\n      height:        overlayRectHeight,\n      padding:       segmentOptions.overlayLabelPadding\n    });\n\n    this._overlay.add(this._overlayText);\n  }\n\n  // Set up event handlers to show/hide the segment label text when the user\n  // hovers the mouse over the segment.\n  this._overlay.on('mouseenter', this._onMouseEnter);\n  this._overlay.on('mouseleave', this._onMouseLeave);\n\n  this._overlay.on('mousedown', this._onMouseDown);\n  this._overlay.on('mouseup', this._onMouseUp);\n\n  if (this._draggable) {\n    this._overlay.on('dragstart', this._onSegmentDragStart);\n    this._overlay.on('dragmove', this._onSegmentDragMove);\n    this._overlay.on('dragend', this._onSegmentDragEnd);\n  }\n\n  this._createMarkers();\n}\n\nSegmentShape.prototype._dragBoundFunc = function(pos) {\n  // Allow the segment to be moved horizontally but not vertically.\n  return {\n    x: pos.x,\n    y: 0\n  };\n};\n\n/**\n * Update the segment shape after the segment's attributes have changed.\n */\n\nSegmentShape.prototype.update = function(options) {\n  const segmentStartOffset = this._view.timeToPixelOffset(this._segment.startTime);\n  const segmentEndOffset   = this._view.timeToPixelOffset(this._segment.endTime);\n  const width = segmentEndOffset - segmentStartOffset;\n  let marker;\n\n  if ((marker = this.getStartMarker())) {\n    marker.setX(segmentStartOffset - marker.getWidth());\n\n    marker.update();\n\n    if (options && objectHasProperty(options, 'startTime')) {\n      marker.timeUpdated(options.startTime);\n    }\n  }\n\n  if ((marker = this.getEndMarker())) {\n    marker.setX(segmentEndOffset);\n\n    marker.update();\n\n    if (options && objectHasProperty(options, 'endTime')) {\n      marker.timeUpdated(options.endTime);\n    }\n  }\n\n  this._color = this._segment.color;\n  this._borderColor = this._segment.bordercolor;\n\n  if (this._overlayText) {\n    const labelColor = this._segment.labelColor;\n\n    this._overlayText.fill(labelColor);\n    this._overlayText.text(this._segment.labelText);\n  }\n\n  const segmentOptions = this._view.getViewOptions().segmentOptions;\n\n  if (segmentOptions.overlay) {\n    if (this._color) {\n      this._overlayRect.fill(this._color);\n    }\n\n    if (this._borderColor) {\n      this._overlayRect.stroke(this._borderColor);\n    }\n  }\n  else {\n    this._waveformShape.setWaveformColor(this._segment.color);\n  }\n\n  // While dragging, the overlay position is controlled in _onSegmentDragMove().\n\n  if (!this._dragging) {\n    if (this._overlay) {\n      this._overlay.setAttrs({\n        x:         segmentStartOffset,\n        width:     width,\n        clipWidth: width < 1 ? 1 : width\n      });\n\n      this._overlayRect.setAttrs({\n        x:     0,\n        width: width\n      });\n\n      if (this._overlayText) {\n        this._overlayText.setAttrs({\n          width: width\n        });\n      }\n    }\n  }\n};\n\nSegmentShape.prototype.getSegment = function() {\n  return this._segment;\n};\n\nSegmentShape.prototype.getStartMarker = function() {\n  return this._startMarker;\n};\n\nSegmentShape.prototype.getEndMarker = function() {\n  return this._endMarker;\n};\n\nSegmentShape.prototype.addToLayer = function(layer) {\n  if (this._waveformShape) {\n    this._waveformShape.addToLayer(layer);\n  }\n\n  if (this._label) {\n    layer.add(this._label);\n  }\n\n  if (this._overlay) {\n    layer.add(this._overlay);\n  }\n\n  if (this._startMarker) {\n    this._startMarker.addToLayer(layer);\n  }\n\n  if (this._endMarker) {\n    this._endMarker.addToLayer(layer);\n  }\n};\n\nSegmentShape.prototype.isDragging = function() {\n  return this._dragging;\n};\n\nfunction createOverlayMarker(options) {\n  return new OverlaySegmentMarker(options);\n}\n\nSegmentShape.prototype._createMarkers = function() {\n  const editable = this._layer.isEditingEnabled() && this._segment.editable;\n\n  if (!editable) {\n    return;\n  }\n\n  const segmentOptions = this._view.getViewOptions().segmentOptions;\n\n  const createSegmentMarker = segmentOptions.markers ?\n    this._peaks.options.createSegmentMarker :\n    createOverlayMarker;\n\n  const startMarker = createSegmentMarker({\n    segment:        this._segment,\n    draggable:      editable,\n    startMarker:    true,\n    color:          segmentOptions.startMarkerColor,\n    fontFamily:     this._peaks.options.fontFamily || defaultFontFamily,\n    fontSize:       this._peaks.options.fontSize || defaultFontSize,\n    fontStyle:      this._peaks.options.fontStyle || defaultFontShape,\n    layer:          this._layer,\n    view:           this._view.getName(),\n    segmentOptions: this._view.getViewOptions().segmentOptions\n  });\n\n  if (startMarker) {\n    this._startMarker = new SegmentMarker({\n      segment:       this._segment,\n      segmentShape:  this,\n      draggable:     editable,\n      startMarker:   true,\n      marker:        startMarker,\n      onDragStart:   this._onSegmentMarkerDragStart,\n      onDragMove:    this._onSegmentMarkerDragMove,\n      onDragEnd:     this._onSegmentMarkerDragEnd,\n      dragBoundFunc: this._segmentMarkerDragBoundFunc\n    });\n  }\n\n  const endMarker = createSegmentMarker({\n    segment:        this._segment,\n    draggable:      editable,\n    startMarker:    false,\n    color:          segmentOptions.endMarkerColor,\n    fontFamily:     this._peaks.options.fontFamily || defaultFontFamily,\n    fontSize:       this._peaks.options.fontSize || defaultFontSize,\n    fontStyle:      this._peaks.options.fontStyle || defaultFontShape,\n    layer:          this._layer,\n    view:           this._view.getName(),\n    segmentOptions: this._view.getViewOptions().segmentOptions\n  });\n\n  if (endMarker) {\n    this._endMarker = new SegmentMarker({\n      segment:       this._segment,\n      segmentShape:  this,\n      draggable:     editable,\n      startMarker:   false,\n      marker:        endMarker,\n      onDragStart:   this._onSegmentMarkerDragStart,\n      onDragMove:    this._onSegmentMarkerDragMove,\n      onDragEnd:     this._onSegmentMarkerDragEnd,\n      dragBoundFunc: this._segmentMarkerDragBoundFunc\n    });\n  }\n};\n\nSegmentShape.prototype._onMouseEnter = function(event) {\n  if (this._label) {\n    // this._label.moveToTop();\n    // this._label.show();\n  }\n\n  this._peaks.emit('segments.mouseenter', {\n    segment: this._segment,\n    evt: event.evt\n  });\n};\n\nSegmentShape.prototype._onMouseLeave = function(event) {\n  if (this._label) {\n    this._label.hide();\n  }\n\n  this._peaks.emit('segments.mouseleave', {\n    segment: this._segment,\n    evt: event.evt\n  });\n};\n\nSegmentShape.prototype._onMouseDown = function(event) {\n  this._peaks.emit('segments.mousedown', {\n    segment: this._segment,\n    evt: event.evt\n  });\n};\n\nSegmentShape.prototype._onMouseUp = function(event) {\n  this._peaks.emit('segments.mouseup', {\n    segment: this._segment,\n    evt: event.evt\n  });\n};\n\nSegmentShape.prototype.segmentClicked = function(eventName, event) {\n  this._moveToTop();\n\n  this._peaks.emit('segments.' + eventName, event);\n};\n\nSegmentShape.prototype.enableSegmentDragging = function(enable) {\n  if (!this._segment.editable) {\n    return;\n  }\n\n  if (!this._draggable && enable) {\n    this._overlay.on('dragstart', this._onSegmentDragStart);\n    this._overlay.on('dragmove', this._onSegmentDragMove);\n    this._overlay.on('dragend', this._onSegmentDragEnd);\n  }\n  else if (this._draggable && !enable) {\n    this._overlay.off('dragstart', this._onSegmentDragStart);\n    this._overlay.off('dragmove', this._onSegmentDragMove);\n    this._overlay.off('dragend', this._onSegmentDragEnd);\n  }\n\n  this._overlay.draggable(enable);\n  this._draggable = enable;\n};\n\nSegmentShape.prototype._setPreviousAndNextSegments = function() {\n  if (this._view.getSegmentDragMode() !== 'overlap') {\n    this._nextSegment = this._peaks.segments.findNextSegment(this._segment);\n    this._previousSegment = this._peaks.segments.findPreviousSegment(this._segment);\n  }\n  else {\n    this._nextSegment = null;\n    this._previousSegment = null;\n  }\n};\n\nSegmentShape.prototype._onSegmentDragStart = function(event) {\n  this._setPreviousAndNextSegments();\n\n  this._dragging = true;\n  this._dragStartX = this._overlay.getX();\n  this._dragStartTime = this._segment.startTime;\n  this._dragEndTime = this._segment.endTime;\n\n  this._peaks.emit('segments.dragstart', {\n    segment: this._segment,\n    marker: false,\n    startMarker: false,\n    evt: event.evt\n  });\n};\n\nSegmentShape.prototype._onSegmentDragMove = function(event) {\n  const x = this._overlay.getX();\n  const offsetX = x - this._dragStartX;\n  const timeOffset = this._view.pixelsToTime(offsetX);\n\n  // The WaveformShape for a segment fills the canvas width\n  // but only draws a subset of the horizontal range. When dragged\n  // we need to keep the shape object in its position but\n  // update the segment start and end time so that the right\n  // subset is drawn.\n\n  // Calculate new segment start/end time based on drag position. We'll\n  // correct this later based on the drag mode, to prevent overlapping\n  // segments or to compress the adjacent segment.\n\n  let startTime = this._dragStartTime + timeOffset;\n  let endTime = this._dragEndTime + timeOffset;\n  const segmentDuration = this._segment.endTime - this._segment.startTime;\n  let dragMode;\n  const minSegmentWidth = this._view.getMinSegmentDragWidth();\n  const minSegmentDuration = this._view.pixelsToTime(minSegmentWidth);\n  let previousSegmentUpdated = false;\n  let nextSegmentUpdated = false;\n\n  // Prevent the segment from being dragged beyond the start of the waveform.\n\n  if (startTime < 0) {\n    startTime = 0;\n    endTime = segmentDuration;\n    this._overlay.setX(this._view.timeToPixelOffset(startTime));\n  }\n\n  // Adjust segment position if it now overlaps the previous segment?\n\n  if (this._previousSegment) {\n    let previousSegmentEndX = this._view.timeToPixelOffset(this._previousSegment.endTime);\n\n    if (startTime < this._previousSegment.endTime) {\n      dragMode = this._view.getSegmentDragMode();\n\n      if (dragMode === 'no-overlap' ||\n          (dragMode === 'compress' && !this._previousSegment.editable)) {\n        startTime = this._previousSegment.endTime;\n        endTime = startTime + segmentDuration;\n        this._overlay.setX(previousSegmentEndX);\n      }\n      else if (dragMode === 'compress') {\n        let previousSegmentEndTime = startTime;\n\n        const minPreviousSegmentEndTime = this._previousSegment.startTime + minSegmentDuration;\n\n        if (previousSegmentEndTime < minPreviousSegmentEndTime) {\n          previousSegmentEndTime = minPreviousSegmentEndTime;\n\n          previousSegmentEndX = this._view.timeToPixelOffset(previousSegmentEndTime);\n\n          this._overlay.setX(previousSegmentEndX);\n\n          startTime = previousSegmentEndTime;\n          endTime = startTime + segmentDuration;\n        }\n\n        this._previousSegment.update({ endTime: previousSegmentEndTime });\n\n        previousSegmentUpdated = true;\n      }\n    }\n  }\n\n  // Adjust segment position if it now overlaps the following segment?\n\n  if (this._nextSegment) {\n    let nextSegmentStartX = this._view.timeToPixelOffset(this._nextSegment.startTime);\n\n    if (endTime > this._nextSegment.startTime) {\n      dragMode = this._view.getSegmentDragMode();\n\n      if (dragMode === 'no-overlap' ||\n          (dragMode === 'compress' && !this._nextSegment.editable)) {\n        endTime = this._nextSegment.startTime;\n        startTime = endTime - segmentDuration;\n        this._overlay.setX(nextSegmentStartX - this._overlay.getWidth());\n      }\n      else if (dragMode === 'compress') {\n        let nextSegmentStartTime = endTime;\n\n        const maxNextSegmentStartTime = this._nextSegment.endTime - minSegmentDuration;\n\n        if (nextSegmentStartTime > maxNextSegmentStartTime) {\n          nextSegmentStartTime = maxNextSegmentStartTime;\n\n          nextSegmentStartX = this._view.timeToPixelOffset(nextSegmentStartTime);\n\n          this._overlay.setX(nextSegmentStartX - this._overlay.getWidth());\n\n          endTime = nextSegmentStartTime;\n          startTime = endTime - segmentDuration;\n        }\n\n        this._nextSegment.update({ startTime: nextSegmentStartTime });\n\n        nextSegmentUpdated = true;\n      }\n    }\n  }\n\n  this._segment._setStartTime(startTime);\n  this._segment._setEndTime(endTime);\n\n  this._peaks.emit('segments.dragged', {\n    segment: this._segment,\n    marker: false,\n    startMarker: false,\n    evt: event.evt\n  });\n\n  if (previousSegmentUpdated) {\n    this._peaks.emit('segments.dragged', {\n      segment: this._previousSegment,\n      marker: false,\n      startMarker: false,\n      evt: event.evt\n    });\n  }\n  else if (nextSegmentUpdated) {\n    this._peaks.emit('segments.dragged', {\n      segment: this._nextSegment,\n      marker: false,\n      startMarker: false,\n      evt: event.evt\n    });\n  }\n};\n\nSegmentShape.prototype._onSegmentDragEnd = function(event) {\n  this._dragging = false;\n\n  this._peaks.emit('segments.dragend', {\n    segment: this._segment,\n    marker: false,\n    startMarker: false,\n    evt: event.evt\n  });\n};\n\nSegmentShape.prototype._moveToTop = function() {\n  this._overlay.moveToTop();\n\n  if (this._endMarker) {\n    this._endMarker.moveToTop();\n  }\n\n  if (this._startMarker) {\n    this._startMarker.moveToTop();\n  }\n};\n\n/**\n * @param {SegmentMarker} segmentMarker\n */\n\nSegmentShape.prototype._onSegmentMarkerDragStart = function(segmentMarker, event) {\n  this._setPreviousAndNextSegments();\n\n  // Move this segment to the top of the z-order, so that it remains on top\n  // of any adjacent segments that the marker is dragged over.\n  this._moveToTop();\n\n  this._startMarkerX = this._startMarker.getX();\n  this._endMarkerX = this._endMarker.getX();\n\n  this._peaks.emit('segments.dragstart', {\n    segment: this._segment,\n    marker: true,\n    startMarker: segmentMarker.isStartMarker(),\n    evt: event.evt\n  });\n};\n\n/**\n * @param {SegmentMarker} segmentMarker\n */\n\nSegmentShape.prototype._onSegmentMarkerDragMove = function(segmentMarker, event) {\n  if (segmentMarker.isStartMarker()) {\n    this._segmentStartMarkerDragMove(segmentMarker, event);\n    segmentMarker.timeUpdated(segmentMarker.getSegment().startTime);\n  }\n  else {\n    this._segmentEndMarkerDragMove(segmentMarker, event);\n    segmentMarker.timeUpdated(segmentMarker.getSegment().endTime);\n  }\n\n  segmentMarker.update();\n};\n\nSegmentShape.prototype._segmentStartMarkerDragMove = function(segmentMarker, event) {\n  const startMarkerX = this._startMarker.getX();\n  const endMarkerX   = this._endMarker.getX();\n\n  let minSegmentDuration = this._view.pixelsToTime(50);\n  const minSegmentWidth = this._view.getMinSegmentDragWidth();\n\n  const upperLimit = this._endMarker.getX() - minSegmentWidth;\n  let lowerLimit;\n  let previousSegmentVisible = true;\n  let previousSegmentUpdated = false;\n\n  if (this._previousSegment) {\n    const dragMode = this._view.getSegmentDragMode();\n\n    if (dragMode === 'no-overlap' ||\n        (dragMode === 'compress' && !this._previousSegment.editable)) {\n      lowerLimit = this._view.timeToPixelOffset(this._previousSegment.endTime);\n\n      if (lowerLimit < 0) {\n        lowerLimit = 0;\n        previousSegmentVisible = false;\n      }\n    }\n    else if (dragMode === 'compress') {\n      const segmentDuration = this._previousSegment.endTime - this._previousSegment.startTime;\n\n      if (segmentDuration < minSegmentDuration) {\n        minSegmentDuration = segmentDuration;\n      }\n\n      lowerLimit = this._view.timeToPixelOffset(\n        this._previousSegment.startTime + minSegmentDuration\n      );\n\n      if (lowerLimit < 0) {\n        lowerLimit = 0;\n        previousSegmentVisible = false;\n      }\n    }\n  }\n  else {\n    lowerLimit = 0;\n  }\n\n  if (startMarkerX >= lowerLimit && startMarkerX < upperLimit) {\n    this._overlay.clipWidth(endMarkerX - startMarkerX);\n\n    segmentMarker.setX(startMarkerX);\n\n    this._segment._setStartTime(this._view.pixelOffsetToTime(startMarkerX));\n\n    segmentMarker.timeUpdated(this._segment.startTime);\n\n    if (this._previousSegment) {\n      const prevSegmentEndX = this._view.timeToPixelOffset(this._previousSegment.endTime);\n\n      if (startMarkerX < prevSegmentEndX) {\n        this._previousSegment.update({\n          endTime: this._view.pixelOffsetToTime(startMarkerX)\n        });\n\n        previousSegmentUpdated = true;\n      }\n    }\n  }\n  else {\n    const x = startMarkerX >= upperLimit ? upperLimit : lowerLimit;\n\n    this._overlay.clipWidth(endMarkerX - x);\n\n    segmentMarker.setX(x);\n\n    if (this._previousSegment && previousSegmentVisible && startMarkerX < lowerLimit) {\n      this._segment._setStartTime(this._previousSegment.endTime);\n    }\n    else {\n      this._segment._setStartTime(this._view.pixelOffsetToTime(x));\n    }\n\n    segmentMarker.timeUpdated(this._segment.startTime);\n  }\n\n  this._peaks.emit('segments.dragged', {\n    segment: this._segment,\n    marker: true,\n    startMarker: true,\n    evt: event.evt\n  });\n\n  if (previousSegmentUpdated) {\n    this._peaks.emit('segments.dragged', {\n      segment: this._previousSegment,\n      marker: true,\n      startMarker: false,\n      evt: event.evt\n    });\n  }\n};\n\nSegmentShape.prototype._segmentEndMarkerDragMove = function(segmentMarker, event) {\n  const startMarkerX = this._startMarker.getX();\n  const endMarkerX   = this._endMarker.getX();\n\n  let minSegmentDuration = this._view.pixelsToTime(50);\n  const minSegmentWidth = this._view.getMinSegmentDragWidth();\n\n  const lowerLimit = this._startMarker.getX() + minSegmentWidth;\n  let upperLimit;\n  let nextSegmentVisible = true;\n  let nextSegmentUpdated = false;\n\n  const width = this._view.getWidth();\n\n  if (this._nextSegment) {\n    const dragMode = this._view.getSegmentDragMode();\n\n    if (dragMode === 'no-overlap' ||\n        (dragMode === 'compress' && !this._nextSegment.editable)) {\n      upperLimit = this._view.timeToPixelOffset(this._nextSegment.startTime);\n\n      if (upperLimit > width) {\n        upperLimit = width;\n        nextSegmentVisible = false;\n      }\n    }\n    else if (dragMode === 'compress') {\n      const segmentDuration = this._nextSegment.endTime - this._nextSegment.startTime;\n\n      if (segmentDuration < minSegmentDuration) {\n        minSegmentDuration = segmentDuration;\n      }\n\n      upperLimit = this._view.timeToPixelOffset(this._nextSegment.endTime - minSegmentDuration);\n\n      if (upperLimit > width) {\n        upperLimit = width;\n        nextSegmentVisible = false;\n      }\n    }\n  }\n  else {\n    upperLimit = width;\n  }\n\n  if (endMarkerX >= lowerLimit && endMarkerX < upperLimit) {\n    this._overlay.clipWidth(endMarkerX - startMarkerX);\n\n    segmentMarker.setX(endMarkerX);\n\n    this._segment._setEndTime(this._view.pixelOffsetToTime(endMarkerX));\n\n    segmentMarker.timeUpdated(this._segment.endTime);\n\n    if (this._nextSegment) {\n      const nextSegmentStartX = this._view.timeToPixelOffset(this._nextSegment.startTime);\n\n      if (endMarkerX > nextSegmentStartX) {\n        this._nextSegment.update({\n          startTime: this._view.pixelOffsetToTime(endMarkerX)\n        });\n\n        nextSegmentUpdated = true;\n      }\n    }\n  }\n  else {\n    const x = endMarkerX >= upperLimit ? upperLimit : lowerLimit;\n\n    this._overlay.clipWidth(x - startMarkerX);\n\n    segmentMarker.setX(x);\n\n    if (this._nextSegment && nextSegmentVisible && endMarkerX >= upperLimit) {\n      this._segment._setEndTime(this._nextSegment.startTime);\n    }\n    else {\n      this._segment._setEndTime(this._view.pixelOffsetToTime(x));\n    }\n\n    segmentMarker.timeUpdated(this._segment.endTime);\n  }\n\n  this._peaks.emit('segments.dragged', {\n    segment: this._segment,\n    marker: true,\n    startMarker: false,\n    evt: event.evt\n  });\n\n  if (nextSegmentUpdated) {\n    this._peaks.emit('segments.dragged', {\n      segment: this._nextSegment,\n      marker: true,\n      startMarker: true,\n      evt: event.evt\n    });\n  }\n};\n\n/**\n * @param {SegmentMarker} segmentMarker\n */\n\nSegmentShape.prototype._onSegmentMarkerDragEnd = function(segmentMarker, event) {\n  this._nextSegment = null;\n  this._previousSegment = null;\n\n  const startMarker = segmentMarker.isStartMarker();\n\n  this._peaks.emit('segments.dragend', {\n    segment: this._segment,\n    marker: true,\n    startMarker: startMarker,\n    evt: event.evt\n  });\n};\n\n// eslint-disable-next-line no-unused-vars\nSegmentShape.prototype._segmentMarkerDragBoundFunc = function(segmentMarker, pos) {\n  // Allow the marker to be moved horizontally but not vertically.\n  return {\n    x: pos.x,\n    y: segmentMarker.getAbsolutePosition().y\n  };\n};\n\nSegmentShape.prototype.fitToView = function() {\n  if (this._startMarker) {\n    this._startMarker.fitToView();\n  }\n\n  if (this._endMarker) {\n    this._endMarker.fitToView();\n  }\n\n  if (this._overlay) {\n    const height = this._view.getHeight();\n\n    const overlayRectHeight = clamp(0, height - (this._overlayOffset * 2));\n\n    this._overlay.setAttrs({\n      y:          0,\n      height:     height,\n      clipY:      this._overlayOffset,\n      clipHeight: overlayRectHeight\n    });\n\n    this._overlayRect.setAttrs({\n      y:      this._overlayOffset,\n      height: overlayRectHeight\n    });\n\n    if (this._overlayText) {\n      this._overlayText.setAttrs({\n        y:      this._overlayOffset,\n        height: overlayRectHeight\n      });\n    }\n  }\n};\n\nSegmentShape.prototype.destroy = function() {\n  if (this._waveformShape) {\n    this._waveformShape.destroy();\n  }\n\n  if (this._label) {\n    this._label.destroy();\n  }\n\n  if (this._startMarker) {\n    this._startMarker.destroy();\n  }\n\n  if (this._endMarker) {\n    this._endMarker.destroy();\n  }\n\n  if (this._overlay) {\n    this._overlay.destroy();\n  }\n};\n\nexport default SegmentShape;\n","/**\n * @file\n *\n * Defines the {@link SegmentsLayer} class.\n *\n * @module segments-layer\n */\n\nimport SegmentShape from './segment-shape';\nimport { objectHasProperty } from './utils';\nimport Konva from 'konva/lib/Core';\n\n/**\n * Creates a Konva.Layer that displays segment markers against the audio\n * waveform.\n *\n * @class\n * @alias SegmentsLayer\n *\n * @param {Peaks} peaks\n * @param {WaveformOverview|WaveformZoomView} view\n * @param {Boolean} allowEditing\n */\n\nfunction SegmentsLayer(peaks, view, allowEditing) {\n  this._peaks         = peaks;\n  this._view          = view;\n  this._allowEditing  = allowEditing;\n  this._segmentShapes = {};\n  this._layer         = new Konva.Layer();\n\n  this._onSegmentsUpdate    = this._onSegmentsUpdate.bind(this);\n  this._onSegmentsAdd       = this._onSegmentsAdd.bind(this);\n  this._onSegmentsRemove    = this._onSegmentsRemove.bind(this);\n  this._onSegmentsRemoveAll = this._onSegmentsRemoveAll.bind(this);\n  this._onSegmentsDragged   = this._onSegmentsDragged.bind(this);\n\n  this._peaks.on('segments.update', this._onSegmentsUpdate);\n  this._peaks.on('segments.add', this._onSegmentsAdd);\n  this._peaks.on('segments.remove', this._onSegmentsRemove);\n  this._peaks.on('segments.remove_all', this._onSegmentsRemoveAll);\n  this._peaks.on('segments.dragged', this._onSegmentsDragged);\n}\n\n/**\n * Adds the layer to the given {Konva.Stage}.\n *\n * @param {Konva.Stage} stage\n */\n\nSegmentsLayer.prototype.addToStage = function(stage) {\n  stage.add(this._layer);\n};\n\nSegmentsLayer.prototype.enableEditing = function(enable) {\n  this._allowEditing = enable;\n};\n\nSegmentsLayer.prototype.isEditingEnabled = function() {\n  return this._allowEditing;\n};\n\nSegmentsLayer.prototype.enableSegmentDragging = function(enable) {\n  for (const segmentId in this._segmentShapes) {\n    if (objectHasProperty(this._segmentShapes, segmentId)) {\n      this._segmentShapes[segmentId].enableSegmentDragging(enable);\n    }\n  }\n};\n\nSegmentsLayer.prototype.formatTime = function(time) {\n  return this._view.formatTime(time);\n};\n\nSegmentsLayer.prototype._onSegmentsUpdate = function(segment, options) {\n  const frameStartTime = this._view.getStartTime();\n  const frameEndTime = this._view.getEndTime();\n\n  let segmentShape = this._segmentShapes[segment.id];\n  const isVisible = segment.isVisible(frameStartTime, frameEndTime);\n\n  if (segmentShape && !isVisible) {\n    // Remove segment shape that is no longer visible.\n\n    if (!segmentShape.isDragging()) {\n      this._removeSegment(segment);\n    }\n  }\n  else if (!segmentShape && isVisible) {\n    // Add segment shape for visible segment.\n    // segmentShape = this._addSegmentShape(segment);\n    segmentShape = this._updateSegment(segment);\n  }\n  else if (segmentShape && isVisible) {\n    // Update the segment shape with the changed attributes.\n    segmentShape.update(options);\n  }\n};\n\nSegmentsLayer.prototype._onSegmentsAdd = function(segments) {\n  const self = this;\n\n  const frameStartTime = self._view.getStartTime();\n  const frameEndTime   = self._view.getEndTime();\n\n  segments.forEach(function(segment) {\n    if (segment.isVisible(frameStartTime, frameEndTime)) {\n      const segmentShape = self._addSegmentShape(segment);\n\n      segmentShape.update();\n    }\n  });\n};\n\nSegmentsLayer.prototype._onSegmentsRemove = function(segments) {\n  const self = this;\n\n  segments.forEach(function(segment) {\n    self._removeSegment(segment);\n  });\n};\n\nSegmentsLayer.prototype._onSegmentsRemoveAll = function() {\n  this._layer.removeChildren();\n  this._segmentShapes = {};\n};\n\nSegmentsLayer.prototype._onSegmentsDragged = function(event) {\n  this._updateSegment(event.segment);\n};\n\n/**\n * Creates the Konva UI objects for a given segment.\n *\n * @private\n * @param {Segment} segment\n * @returns {SegmentShape}\n */\n\nSegmentsLayer.prototype._createSegmentShape = function(segment) {\n  return new SegmentShape(segment, this._peaks, this, this._view);\n};\n\n/**\n * Adds a Konva UI object to the layer for a given segment.\n *\n * @private\n * @param {Segment} segment\n * @returns {SegmentShape}\n */\n\nSegmentsLayer.prototype._addSegmentShape = function(segment) {\n  const segmentShape = this._createSegmentShape(segment);\n\n  segmentShape.addToLayer(this._layer);\n\n  this._segmentShapes[segment.id] = segmentShape;\n\n  return segmentShape;\n};\n\n/**\n * Updates the positions of all displayed segments in the view.\n *\n * @param {Number} startTime The start of the visible range in the view,\n *   in seconds.\n * @param {Number} endTime The end of the visible range in the view,\n *   in seconds.\n */\n\nSegmentsLayer.prototype.updateSegments = function(startTime, endTime) {\n  // Update segments in visible time range.\n  const segments = this._peaks.segments.find(startTime, endTime);\n\n  segments.forEach(this._updateSegment.bind(this));\n\n  // TODO: In the overview all segments are visible, so no need to do this.\n  this._removeInvisibleSegments(startTime, endTime);\n};\n\n/**\n * @private\n * @param {Segment} segment\n */\n\nSegmentsLayer.prototype._updateSegment = function(segment) {\n  const segmentShape = this._findOrAddSegmentShape(segment);\n\n  segmentShape.update();\n};\n\n/**\n * @private\n * @param {Segment} segment\n */\n\nSegmentsLayer.prototype._findOrAddSegmentShape = function(segment) {\n  let segmentShape = this._segmentShapes[segment.id];\n\n  if (!segmentShape) {\n    segmentShape = this._addSegmentShape(segment);\n  }\n\n  return segmentShape;\n};\n\n/**\n * Removes any segments that are not visible, i.e., are not within and do not\n * overlap the given time range.\n *\n * @private\n * @param {Number} startTime The start of the visible time range, in seconds.\n * @param {Number} endTime The end of the visible time range, in seconds.\n */\n\nSegmentsLayer.prototype._removeInvisibleSegments = function(startTime, endTime) {\n  for (const segmentId in this._segmentShapes) {\n    if (objectHasProperty(this._segmentShapes, segmentId)) {\n      const segment = this._segmentShapes[segmentId].getSegment();\n\n      if (!segment.isVisible(startTime, endTime)) {\n        this._removeSegment(segment);\n      }\n    }\n  }\n};\n\n/**\n * Removes the given segment from the view.\n *\n * @param {Segment} segment\n */\n\nSegmentsLayer.prototype._removeSegment = function(segment) {\n  const segmentShape = this._segmentShapes[segment.id];\n\n  if (segmentShape) {\n    segmentShape.destroy();\n    delete this._segmentShapes[segment.id];\n  }\n};\n\n/**\n * Toggles visibility of the segments layer.\n *\n * @param {Boolean} visible\n */\n\nSegmentsLayer.prototype.setVisible = function(visible) {\n  this._layer.setVisible(visible);\n};\n\nSegmentsLayer.prototype.segmentClicked = function(eventName, event) {\n  const segmentShape = this._segmentShapes[event.segment.id];\n\n  if (segmentShape) {\n    segmentShape.segmentClicked(eventName, event);\n  }\n};\n\nSegmentsLayer.prototype.destroy = function() {\n  this._peaks.off('segments.update', this._onSegmentsUpdate);\n  this._peaks.off('segments.add', this._onSegmentsAdd);\n  this._peaks.off('segments.remove', this._onSegmentsRemove);\n  this._peaks.off('segments.remove_all', this._onSegmentsRemoveAll);\n  this._peaks.off('segments.dragged', this._onSegmentsDragged);\n};\n\nSegmentsLayer.prototype.fitToView = function() {\n  for (const segmentId in this._segmentShapes) {\n    if (objectHasProperty(this._segmentShapes, segmentId)) {\n      const segmentShape = this._segmentShapes[segmentId];\n\n      segmentShape.fitToView();\n    }\n  }\n};\n\nSegmentsLayer.prototype.draw = function() {\n  this._layer.draw();\n};\n\nSegmentsLayer.prototype.getHeight = function() {\n  return this._layer.getHeight();\n};\n\nexport default SegmentsLayer;\n","/**\n * @file\n *\n * Defines the {@link WaveformAxis} class.\n *\n * @module waveform-axis\n */\n\nimport { formatTime, roundUpToNearest } from './utils';\nimport Konva from 'konva/lib/Core';\n\n/**\n * Creates the waveform axis shapes and adds them to the given view layer.\n *\n * @class\n * @alias WaveformAxis\n *\n * @param {WaveformOverview|WaveformZoomView} view\n * @param {Object} options\n * @param {String} options.axisGridlineColor\n * @param {String} options.axisLabelColor\n * @param {Boolean} options.showAxisLabels\n * @param {Function} options.formatAxisTime\n * @param {String} options.fontFamily\n * @param {Number} options.fontSize\n * @param {String} options.fontStyle\n */\n\nfunction WaveformAxis(view, options) {\n  const self = this;\n\n  self._axisGridlineColor = options.axisGridlineColor;\n  self._axisLabelColor    = options.axisLabelColor;\n  self._showAxisLabels    = options.showAxisLabels;\n\n  if (options.formatAxisTime) {\n    self._formatAxisTime = options.formatAxisTime;\n  }\n  else {\n    self._formatAxisTime = function(time) {\n      // precision = 0, drops the fractional seconds\n      return formatTime(time, 0);\n    };\n  }\n\n  self._axisLabelFont = WaveformAxis._buildFontString(\n    options.fontFamily,\n    options.fontSize,\n    options.fontStyle\n  );\n\n  self._axisShape = new Konva.Shape({\n    sceneFunc: function(context) {\n      self._drawAxis(context, view);\n    }\n  });\n}\n\nWaveformAxis._buildFontString = function(fontFamily, fontSize, fontStyle) {\n  if (!fontSize) {\n    fontSize = 11;\n  }\n\n  if (!fontFamily) {\n    fontFamily = 'sans-serif';\n  }\n\n  if (!fontStyle) {\n    fontStyle = 'normal';\n  }\n\n  return fontStyle + ' ' + fontSize + 'px ' + fontFamily;\n};\n\nWaveformAxis.prototype.addToLayer = function(layer) {\n  layer.add(this._axisShape);\n};\n\nWaveformAxis.prototype.showAxisLabels = function(show) {\n  this._showAxisLabels = show;\n};\n\n/**\n * Returns number of seconds for each x-axis marker, appropriate for the\n * current zoom level, ensuring that markers are not too close together\n * and that markers are placed at intuitive time intervals (i.e., every 1,\n * 2, 5, 10, 20, 30 seconds, then every 1, 2, 5, 10, 20, 30 minutes, then\n * every 1, 2, 5, 10, 20, 30 hours).\n *\n * @param {WaveformOverview|WaveformZoomView} view\n * @returns {Number}\n */\n\nWaveformAxis.prototype._getAxisLabelScale = function(view) {\n  let baseSecs = 1; // seconds\n  const steps = [1, 2, 5, 10, 20, 30];\n  const minSpacing = 60;\n  let index = 0;\n\n  let secs;\n\n  for (;;) {\n    secs = baseSecs * steps[index];\n    const pixels = view.timeToPixels(secs);\n\n    if (pixels < minSpacing) {\n      if (++index === steps.length) {\n        baseSecs *= 60; // seconds -> minutes -> hours\n        index = 0;\n      }\n    }\n    else {\n      break;\n    }\n  }\n\n  return secs;\n};\n\n/**\n * Draws the time axis and labels onto a view.\n *\n * @param {Konva.Context} context The context to draw on.\n * @param {WaveformOverview|WaveformZoomView} view\n */\n\nWaveformAxis.prototype._drawAxis = function(context, view) {\n  const currentFrameStartTime = view.getStartTime();\n\n  // Draw axis markers\n  const markerHeight = 10;\n\n  // Time interval between axis markers (seconds)\n  const axisLabelIntervalSecs = this._getAxisLabelScale(view);\n\n  // Time of first axis marker (seconds)\n  const firstAxisLabelSecs = roundUpToNearest(currentFrameStartTime, axisLabelIntervalSecs);\n\n  // Distance between waveform start time and first axis marker (seconds)\n  const axisLabelOffsetSecs = firstAxisLabelSecs - currentFrameStartTime;\n\n  // Distance between waveform start time and first axis marker (pixels)\n  const axisLabelOffsetPixels = view.timeToPixels(axisLabelOffsetSecs);\n\n  context.setAttr('strokeStyle', this._axisGridlineColor);\n  context.setAttr('lineWidth', 1);\n\n  // Set text style\n  context.setAttr('font', this._axisLabelFont);\n  context.setAttr('fillStyle', this._axisLabelColor);\n  context.setAttr('textAlign', 'left');\n  context.setAttr('textBaseline', 'bottom');\n\n  const width  = view.getWidth();\n  // const height = view.getHeight();\n\n  let secs = firstAxisLabelSecs;\n\n  for (;;) {\n    // Position of axis marker (pixels)\n    const x = axisLabelOffsetPixels + view.timeToPixels(secs - firstAxisLabelSecs);\n\n    if (x >= width) {\n      break;\n    }\n\n    context.beginPath();\n    context.moveTo(x + 0.5, 0);\n    context.lineTo(x + 0.5, 0 + markerHeight);\n    // context.moveTo(x + 0.5, height);\n    // context.lineTo(x + 0.5, height - markerHeight);\n    context.stroke();\n\n    if (this._showAxisLabels) {\n      const label      = this._formatAxisTime(secs);\n      const labelWidth = context.measureText(label).width;\n      const labelX     = x - labelWidth / 2;\n      const labelY     = 15 + markerHeight;\n\n      if (labelX >= 0) {\n        context.fillText(label, labelX, labelY);\n      }\n    }\n\n    secs += axisLabelIntervalSecs;\n  }\n};\n\nexport default WaveformAxis;\n","/**\n * @file\n *\n * Defines the {@link WaveformOverview} class.\n *\n * @module waveform-overview\n */\n\nimport HighlightLayer from './highlight-layer';\nimport MouseDragHandler from './mouse-drag-handler';\nimport PlayheadLayer from './playhead-layer';\nimport PointsLayer from './points-layer';\nimport SegmentsLayer from './segments-layer';\nimport WaveformAxis from './waveform-axis';\nimport WaveformShape from './waveform-shape';\nimport { clamp, formatTime, getMarkerObject, isFinite, isNumber } from './utils';\nimport Konva from 'konva/lib/Core';\n\n/**\n * Creates the overview waveform view.\n *\n * @class\n * @alias WaveformOverview\n *\n * @param {WaveformData} waveformData\n * @param {HTMLElement} container\n * @param {Peaks} peaks\n */\n\nfunction WaveformOverview(waveformData, container, peaks) {\n  const self = this;\n\n  self._originalWaveformData = waveformData;\n  self._container = container;\n  self._peaks = peaks;\n  self._options = peaks.options;\n  self._viewOptions = peaks.options.overview;\n\n  // Bind event handlers\n  self._onTimeUpdate = self._onTimeUpdate.bind(this);\n  self._onPlaying = self._onPlaying.bind(this);\n  self._onPause = self._onPause.bind(this);\n  self._onZoomviewDisplaying = self._onZoomviewDisplaying.bind(this);\n  self._onWindowResize = self._onWindowResize.bind(this);\n\n  // Register event handlers\n  peaks.on('player.timeupdate', self._onTimeUpdate);\n  peaks.on('player.playing', self._onPlaying);\n  peaks.on('player.pause', self._onPause);\n  peaks.on('zoomview.displaying', self._onZoomviewDisplaying);\n  peaks.on('window_resize', self._onWindowResize);\n\n  self._amplitudeScale = 1.0;\n  self._timeLabelPrecision = self._viewOptions.timeLabelPrecision;\n  self._enableSeek = true;\n\n  if (self._viewOptions.formatPlayheadTime) {\n    self._formatPlayheadTime = self._viewOptions.formatPlayheadTime;\n  }\n  else {\n    self._formatPlayheadTime = function(time) {\n      return formatTime(time, self._timeLabelPrecision);\n    };\n  }\n\n  self._width = container.clientWidth;\n  self._height = container.clientHeight;\n\n  self._data = waveformData;\n\n  if (self._width !== 0) {\n    try {\n      self._data = waveformData.resample({ width: self._width });\n    }\n    catch (error) {\n      // This error usually indicates that the waveform length\n      // is less than the container width\n    }\n  }\n\n  // Disable warning: The stage has 6 layers.\n  // Recommended maximum number of layers is 3-5.\n  Konva.showWarnings = false;\n\n  self._resizeTimeoutId = null;\n\n  self._stage = new Konva.Stage({\n    container: container,\n    width: self._width,\n    height: self._height\n  });\n\n  self._waveformColor = self._viewOptions.waveformColor;\n  self._playedWaveformColor = self._viewOptions.playedWaveformColor;\n\n  self._createWaveform();\n\n  self._segmentsLayer = new SegmentsLayer(peaks, self, false);\n  self._segmentsLayer.addToStage(self._stage);\n\n  self._pointsLayer = new PointsLayer(peaks, self, false);\n  self._pointsLayer.addToStage(self._stage);\n\n  self._highlightLayer = new HighlightLayer(\n    self,\n    self._viewOptions\n  );\n  self._highlightLayer.addToStage(self._stage);\n\n  self._createAxisLabels();\n\n  self._playheadLayer = new PlayheadLayer({\n    player: self._peaks.player,\n    view: self,\n    showPlayheadTime: self._viewOptions.showPlayheadTime,\n    playheadColor: self._viewOptions.playheadColor,\n    playheadTextColor: self._viewOptions.playheadTextColor,\n    playheadFontFamily: self._viewOptions.fontFamily,\n    playheadFontSize: self._viewOptions.fontSize,\n    playheadFontStyle: self._viewOptions.fontStyle\n  });\n\n  self._playheadLayer.addToStage(self._stage);\n\n  const time = self._peaks.player.getCurrentTime();\n\n  this._playheadLayer.updatePlayheadTime(time);\n\n  self._createMouseDragHandler();\n\n  self._onClick = self._onClick.bind(this);\n  self._onDblClick = self._onDblClick.bind(this);\n  self._onContextMenu = self._onContextMenu.bind(this);\n\n  self._stage.on('click', self._onClick);\n  self._stage.on('dblclick', self._onDblClick);\n  self._stage.on('contextmenu', self._onContextMenu);\n}\n\nWaveformOverview.prototype._createMouseDragHandler = function() {\n  const self = this;\n\n  self._mouseDragHandler = new MouseDragHandler(self._stage, {\n    onMouseDown: function(mousePosX) {\n      this._seek(mousePosX);\n    },\n\n    onMouseMove: function(mousePosX) {\n      this._seek(mousePosX);\n    },\n\n    _seek: function(mousePosX) {\n      if (!self._enableSeek) {\n        return;\n      }\n\n      mousePosX = clamp(mousePosX, 0, self._width);\n\n      let time = self.pixelsToTime(mousePosX);\n      const duration = self._getDuration();\n\n      // Prevent the playhead position from jumping by limiting click\n      // handling to the waveform duration.\n      if (time > duration) {\n        time = duration;\n      }\n\n      // Update the playhead position. This gives a smoother visual update\n      // than if we only use the player.timeupdate event.\n      self._playheadLayer.updatePlayheadTime(time);\n\n      self._peaks.player.seek(time);\n    }\n  });\n};\n\nWaveformOverview.prototype.enableSeek = function(enable) {\n  this._enableSeek = enable;\n};\n\nWaveformOverview.prototype._onClick = function(event) {\n  this._clickHandler(event, 'click');\n};\n\nWaveformOverview.prototype._onDblClick = function(event) {\n  this._clickHandler(event, 'dblclick');\n};\n\nWaveformOverview.prototype._onContextMenu = function(event) {\n  this._clickHandler(event, 'contextmenu');\n};\n\nWaveformOverview.prototype._clickHandler = function(event, eventName) {\n  let emitViewEvent = true;\n\n  if (event.target !== this._stage) {\n    const marker = getMarkerObject(event.target);\n\n    if (marker) {\n      if (marker.attrs.name === 'point-marker') {\n        const point = marker.getAttr('point');\n\n        if (point) {\n          this._peaks.emit('points.' + eventName, {\n            point: point,\n            evt: event.evt,\n            preventViewEvent: function() {\n              emitViewEvent = false;\n            }\n          });\n        }\n      }\n      else if (marker.attrs.name === 'segment-overlay') {\n        const segment = marker.getAttr('segment');\n\n        if (segment) {\n          const clickEvent = {\n            segment: segment,\n            evt: event.evt,\n            preventViewEvent: function() {\n              emitViewEvent = false;\n            }\n          };\n\n          this._segmentsLayer.segmentClicked(eventName, clickEvent);\n        }\n      }\n    }\n  }\n\n  if (emitViewEvent) {\n    const pixelIndex = event.evt.layerX;\n    const time = this.pixelsToTime(pixelIndex);\n\n    this._peaks.emit('overview.' + eventName, {\n      time: time,\n      evt: event.evt\n    });\n  }\n};\n\nWaveformOverview.prototype.isSegmentDraggingEnabled = function() {\n  return false;\n};\n\nWaveformOverview.prototype.getName = function() {\n  return 'overview';\n};\n\nWaveformOverview.prototype._onTimeUpdate = function(time) {\n  this._playheadLayer.updatePlayheadTime(time);\n};\n\nWaveformOverview.prototype._onPlaying = function(time) {\n  this._playheadLayer.updatePlayheadTime(time);\n};\n\nWaveformOverview.prototype._onPause = function(time) {\n  this._playheadLayer.stop(time);\n};\n\nWaveformOverview.prototype._onZoomviewDisplaying = function(startTime, endTime) {\n  this.showHighlight(startTime, endTime);\n};\n\nWaveformOverview.prototype.showHighlight = function(startTime, endTime) {\n  this._highlightLayer.showHighlight(startTime, endTime);\n};\n\nWaveformOverview.prototype._onWindowResize = function() {\n  const self = this;\n\n  if (self._resizeTimeoutId) {\n    clearTimeout(self._resizeTimeoutId);\n    self._resizeTimeoutId = null;\n  }\n\n  // Avoid resampling waveform data to zero width\n  if (self._container.clientWidth !== 0) {\n    self._width = self._container.clientWidth;\n    self._stage.setWidth(self._width);\n\n    self._resizeTimeoutId = setTimeout(function() {\n      self._width = self._container.clientWidth;\n      self._data = self._originalWaveformData.resample({ width: self._width });\n      self._stage.setWidth(self._width);\n\n      self._updateWaveform();\n    }, 500);\n  }\n};\n\nWaveformOverview.prototype.setWaveformData = function(waveformData) {\n  this._originalWaveformData = waveformData;\n\n  if (this._width !== 0) {\n    this._data = waveformData.resample({ width: this._width });\n  }\n  else {\n    this._data = waveformData;\n  }\n\n  this._updateWaveform();\n};\n\nWaveformOverview.prototype.playheadPosChanged = function(time) {\n  if (this._playedWaveformShape) {\n    this._playedSegment.endTime = time;\n    this._unplayedSegment.startTime = time;\n\n    this._waveformLayer.draw();\n  }\n};\n\n/**\n * Returns the pixel index for a given time, for the current zoom level.\n *\n * @param {Number} time Time, in seconds.\n * @returns {Number} Pixel index.\n */\n\nWaveformOverview.prototype.timeToPixels = function(time) {\n  return Math.floor(time * this._data.sample_rate / this._data.scale);\n};\n\nWaveformOverview.prototype.timeToPixelOffset = WaveformOverview.prototype.timeToPixels;\n\n/**\n * Returns the time for a given pixel index, for the current zoom level.\n *\n * @param {Number} pixels Pixel index.\n * @returns {Number} Time, in seconds.\n */\n\nWaveformOverview.prototype.pixelsToTime = function(pixels) {\n  return pixels * this._data.scale / this._data.sample_rate;\n};\n\n/**\n * Returns the time for a given pixel index, for the current zoom level.\n * (This is presented for symmetry with WaveformZoomview. Since WaveformOverview\n * doesn't scroll, its pixelOffsetToTime & pixelsToTime methods are identical.)\n *\n * @param {Number} pixels Pixel index.\n * @returns {Number} Time, in seconds.\n */\n\nWaveformOverview.prototype.pixelOffsetToTime = WaveformOverview.prototype.pixelsToTime;\n\n/**\n * @returns {Number} The start position of the waveform shown in the view,\n *   in pixels.\n */\n\nWaveformOverview.prototype.getFrameOffset = function() {\n  return 0;\n};\n\n/**\n * @returns {Number} The time at the leftmost edge\n */\n\nWaveformOverview.prototype.getStartTime = function() {\n  return 0;\n};\n\n/**\n * @returns {Number} The time at the rightmost edge\n */\n\nWaveformOverview.prototype.getEndTime = function() {\n  return this._getDuration();\n};\n\n/**\n * @returns {Number} The width of the view, in pixels.\n */\n\nWaveformOverview.prototype.getWidth = function() {\n  return this._width;\n};\n\n/**\n * @returns {Number} The height of the view, in pixels.\n */\n\nWaveformOverview.prototype.getHeight = function() {\n  return this._height;\n};\n\n/**\n * @returns {Number} The media duration, in seconds.\n */\n\nWaveformOverview.prototype._getDuration = function() {\n  return this._peaks.player.getDuration();\n};\n\n/**\n * Adjusts the amplitude scale of waveform shown in the view, which allows\n * users to zoom the waveform vertically.\n *\n * @param {Number} scale The new amplitude scale factor\n */\n\nWaveformOverview.prototype.setAmplitudeScale = function(scale) {\n  if (!isNumber(scale) || !isFinite(scale)) {\n    throw new Error('view.setAmplitudeScale(): Scale must be a valid number');\n  }\n\n  this._amplitudeScale = scale;\n\n  this._waveformLayer.draw();\n  this._segmentsLayer.draw();\n};\n\nWaveformOverview.prototype.getAmplitudeScale = function() {\n  return this._amplitudeScale;\n};\n\n/**\n * @returns {WaveformData} The view's waveform data.\n */\n\nWaveformOverview.prototype.getWaveformData = function() {\n  return this._data;\n};\n\nWaveformOverview.prototype._createWaveformShapes = function() {\n  if (!this._waveformShape) {\n    this._waveformShape = new WaveformShape({\n      color: this._waveformColor,\n      view: this\n    });\n\n    this._waveformShape.addToLayer(this._waveformLayer);\n  }\n\n  if (this._playedWaveformColor && !this._playedWaveformShape) {\n    const time = this._peaks.player.getCurrentTime();\n\n    this._playedSegment = {\n      startTime: 0,\n      endTime: time\n    };\n\n    this._unplayedSegment = {\n      startTime: time,\n      endTime: this._getDuration()\n    };\n\n    this._waveformShape.setSegment(this._unplayedSegment);\n\n    this._playedWaveformShape = new WaveformShape({\n      color: this._playedWaveformColor,\n      view: this,\n      segment: this._playedSegment\n    });\n\n    this._playedWaveformShape.addToLayer(this._waveformLayer);\n  }\n};\n\nWaveformOverview.prototype._destroyPlayedWaveformShape = function() {\n  this._waveformShape.setSegment(null);\n\n  this._playedWaveformShape.destroy();\n  this._playedWaveformShape = null;\n\n  this._playedSegment = null;\n  this._unplayedSegment = null;\n};\n\nWaveformOverview.prototype._createWaveform = function() {\n  this._waveformLayer = new Konva.Layer({ listening: false });\n\n  this._createWaveformShapes();\n\n  this._stage.add(this._waveformLayer);\n};\n\nWaveformOverview.prototype._createAxisLabels = function() {\n  this._axisLayer = new Konva.Layer({ listening: false });\n  this._axis = new WaveformAxis(this, this._viewOptions);\n\n  this._axis.addToLayer(this._axisLayer);\n  this._stage.add(this._axisLayer);\n};\n\nWaveformOverview.prototype.removeHighlightRect = function() {\n  this._highlightLayer.removeHighlight();\n};\n\nWaveformOverview.prototype._updateWaveform = function() {\n  this._waveformLayer.draw();\n  this._axisLayer.draw();\n\n  const playheadTime = this._peaks.player.getCurrentTime();\n\n  this._playheadLayer.updatePlayheadTime(playheadTime);\n\n  this._highlightLayer.updateHighlight();\n\n  const frameStartTime = 0;\n  const frameEndTime   = this.pixelsToTime(this._width);\n\n  this._pointsLayer.updatePoints(frameStartTime, frameEndTime);\n  this._segmentsLayer.updateSegments(frameStartTime, frameEndTime);\n};\n\nWaveformOverview.prototype.setWaveformColor = function(color) {\n  this._waveformColor = color;\n  this._waveformShape.setWaveformColor(color);\n};\n\nWaveformOverview.prototype.setPlayedWaveformColor = function(color) {\n  this._playedWaveformColor = color;\n\n  if (color) {\n    if (!this._playedWaveformShape) {\n      this._createWaveformShapes();\n    }\n\n    this._playedWaveformShape.setWaveformColor(color);\n  }\n  else {\n    if (this._playedWaveformShape) {\n      this._destroyPlayedWaveformShape();\n    }\n  }\n};\n\nWaveformOverview.prototype.showPlayheadTime = function(show) {\n  this._playheadLayer.showPlayheadTime(show);\n};\n\nWaveformOverview.prototype.setTimeLabelPrecision = function(precision) {\n  this._timeLabelPrecision = precision;\n  this._playheadLayer.updatePlayheadText();\n};\n\nWaveformOverview.prototype.formatTime = function(time) {\n  return this._formatPlayheadTime(time);\n};\n\nWaveformOverview.prototype.showAxisLabels = function(show) {\n  this._axis.showAxisLabels(show);\n  this._axisLayer.draw();\n};\n\nWaveformOverview.prototype.enableMarkerEditing = function(enable) {\n  this._segmentsLayer.enableEditing(enable);\n  this._pointsLayer.enableEditing(enable);\n};\n\nWaveformOverview.prototype.fitToContainer = function() {\n  if (this._container.clientWidth === 0 && this._container.clientHeight === 0) {\n    return;\n  }\n\n  let updateWaveform = false;\n\n  if (this._container.clientWidth !== this._width) {\n    this._width = this._container.clientWidth;\n    this._stage.setWidth(this._width);\n\n    try {\n      this._data = this._originalWaveformData.resample({ width: this._width });\n      updateWaveform = true;\n    }\n    catch (error) {\n      // Ignore, and leave this._data as it was\n    }\n  }\n\n  this._height = this._container.clientHeight;\n  this._stage.setHeight(this._height);\n\n  this._waveformShape.fitToView();\n  this._playheadLayer.fitToView();\n  this._segmentsLayer.fitToView();\n  this._pointsLayer.fitToView();\n  this._highlightLayer.fitToView();\n\n  if (updateWaveform) {\n    this._updateWaveform();\n  }\n\n  this._stage.draw();\n};\n\nWaveformOverview.prototype.getViewOptions = function() {\n  return this._viewOptions;\n};\n\nWaveformOverview.prototype.destroy = function() {\n  if (this._resizeTimeoutId) {\n    clearTimeout(this._resizeTimeoutId);\n    this._resizeTimeoutId = null;\n  }\n\n  this._peaks.off('player.playing', this._onPlaying);\n  this._peaks.off('player.pause', this._onPause);\n  this._peaks.off('player.timeupdate', this._onTimeUpdate);\n  this._peaks.off('zoomview.displaying', this._onZoomviewDisplaying);\n  this._peaks.off('window_resize', this._onWindowResize);\n\n  this._playheadLayer.destroy();\n  this._segmentsLayer.destroy();\n  this._pointsLayer.destroy();\n\n  if (this._stage) {\n    this._stage.destroy();\n    this._stage = null;\n  }\n};\n\nexport default WaveformOverview;\n","/**\n * @file\n *\n * Defines the {@link WaveformZoomView} class.\n *\n * @module waveform-zoomview\n */\n\nimport MouseDragHandler from './mouse-drag-handler';\nimport PlayheadLayer from './playhead-layer';\nimport PointsLayer from './points-layer';\nimport SegmentsLayer from './segments-layer';\nimport WaveformAxis from './waveform-axis';\nimport WaveformShape from './waveform-shape';\n// import AnimatedZoomAdapter from './animated-zoom-adapter';\n// import StaticZoomAdapter from './static-zoom-adapter';\nimport { clamp, formatTime, getMarkerObject, isFinite, isNumber, isValidTime,\n  objectHasProperty } from './utils';\n\nimport Konva from 'konva/lib/Core';\n\n/**\n * Creates a zoomable waveform view.\n *\n * @class\n * @alias WaveformZoomView\n *\n * @param {WaveformData} waveformData\n * @param {HTMLElement} container\n * @param {Peaks} peaks\n */\n\nfunction WaveformZoomView(waveformData, container, peaks) {\n  const self = this;\n\n  self._container = container;\n  self._peaks = peaks;\n  self._options = peaks.options;\n  self._viewOptions = self._options.zoomview;\n  self._enableWaveformCache = self._options.waveformCache;\n  self._originalWaveformData = waveformData;\n  self._initWaveformCache();\n\n  // Bind event handlers\n  self._onTimeUpdate = self._onTimeUpdate.bind(self);\n  self._onPlaying = self._onPlaying.bind(self);\n  self._onPause = self._onPause.bind(self);\n  self._onWindowResize = self._onWindowResize.bind(self);\n  self._onKeyboardLeft = self._onKeyboardLeft.bind(self);\n  self._onKeyboardRight = self._onKeyboardRight.bind(self);\n  self._onKeyboardShiftLeft  = self._onKeyboardShiftLeft.bind(self);\n  self._onKeyboardShiftRight = self._onKeyboardShiftRight.bind(self);\n\n  // Register event handlers\n  self._peaks.on('player.timeupdate', self._onTimeUpdate);\n  self._peaks.on('player.playing', self._onPlaying);\n  self._peaks.on('player.pause', self._onPause);\n  self._peaks.on('window_resize', self._onWindowResize);\n  self._peaks.on('keyboard.left', self._onKeyboardLeft);\n  self._peaks.on('keyboard.right', self._onKeyboardRight);\n  self._peaks.on('keyboard.shift_left', self._onKeyboardShiftLeft);\n  self._peaks.on('keyboard.shift_right', self._onKeyboardShiftRight);\n\n  self._enableAutoScroll = true;\n  self._amplitudeScale = 1.0;\n  self._timeLabelPrecision = self._viewOptions.timeLabelPrecision;\n  self._enableSeek = true;\n  self._enableSegmentDragging = false;\n  self._segmentDragMode = 'overlap';\n  self._minSegmentDragWidth = 0;\n\n  if (self._viewOptions.formatPlayheadTime) {\n    self._formatPlayheadTime = self._viewOptions.formatPlayheadTime;\n  }\n  else {\n    self._formatPlayheadTime = function(time) {\n      return formatTime(time, self._timeLabelPrecision);\n    };\n  }\n\n  self._playheadClickTolerance = self._viewOptions.playheadClickTolerance;\n\n  self._data = null;\n  self._pixelLength = 0;\n\n  const initialZoomLevel = peaks.zoom.getZoomLevel();\n\n  self._zoomLevelAuto = false;\n  self._zoomLevelSeconds = null;\n\n  self._resizeTimeoutId = null;\n  self._resampleData({ scale: initialZoomLevel });\n\n  self._width = container.clientWidth;\n  self._height = container.clientHeight;\n\n  // The pixel offset of the current frame being displayed\n  self._frameOffset = 0;\n\n  self._stage = new Konva.Stage({\n    container: container,\n    width: self._width,\n    height: self._height\n  });\n\n  self._waveformColor = self._viewOptions.waveformColor;\n  self._playedWaveformColor = self._viewOptions.playedWaveformColor;\n\n  self._createWaveform();\n\n  self._segmentsLayer = new SegmentsLayer(peaks, self, true);\n  self._segmentsLayer.addToStage(self._stage);\n\n  self._pointsLayer = new PointsLayer(peaks, self, true);\n  self._pointsLayer.addToStage(self._stage);\n\n  self._createAxisLabels();\n\n  self._playheadLayer = new PlayheadLayer({\n    player: self._peaks.player,\n    view: self,\n    showPlayheadTime: self._viewOptions.showPlayheadTime,\n    playheadColor: self._viewOptions.playheadColor,\n    playheadTextColor: self._viewOptions.playheadTextColor,\n    playheadFontFamily: self._viewOptions.fontFamily,\n    playheadFontSize: self._viewOptions.fontSize,\n    playheadFontStyle: self._viewOptions.fontStyle\n  });\n\n  self._playheadLayer.addToStage(self._stage);\n\n  const time = self._peaks.player.getCurrentTime();\n\n  self._syncPlayhead(time);\n\n  self._createMouseDragHandler();\n\n  self._onWheel = self._onWheel.bind(self);\n  self._onWheelCaptureVerticalScroll = self._onWheelCaptureVerticalScroll.bind(self);\n  self.setWheelMode(self._viewOptions.wheelMode);\n\n  self._onClick = self._onClick.bind(this);\n  self._onDblClick = self._onDblClick.bind(this);\n  self._onMouseDown = self._onMouseDown.bind(this);\n  self._onContextMenu = self._onContextMenu.bind(this);\n\n  self._stage.on('click', self._onClick);\n  self._stage.on('dblclick', self._onDblClick);\n  self._stage.on('mousedown', self._onMouseDown);\n  self._stage.on('contextmenu', self._onContextMenu);\n}\n\nWaveformZoomView.prototype._initWaveformCache = function() {\n  if (this._enableWaveformCache) {\n    this._waveformData = new Map();\n    this._waveformData.set(this._originalWaveformData.scale, this._originalWaveformData);\n    this._waveformScales = [this._originalWaveformData.scale];\n  }\n};\n\nWaveformZoomView.prototype._createMouseDragHandler = function() {\n  const self = this;\n\n  self._mouseDragHandler = new MouseDragHandler(self._stage, {\n    onMouseDown: function(mousePosX, segment) {\n      this._seeking = false;\n      this._segment = segment;\n\n      const playheadOffset = self._playheadLayer.getPlayheadOffset();\n\n      if (self._enableSeek &&\n          Math.abs(mousePosX - playheadOffset) <= self._playheadClickTolerance) {\n        this._seeking = true;\n\n        // The user has clicked near the playhead, and the playhead is within\n        // a segment. In this case we want to allow the playhead to move, but\n        // prevent the segment from being dragged. So we temporarily make the\n        // segment non-draggable, and restore its draggable state in onMouseUp().\n        if (this._segment) {\n          this._segmentIsDraggable = this._segment.draggable();\n          this._segment.draggable(false);\n        }\n      }\n\n      if (this._seeking) {\n        this._seek(mousePosX);\n      }\n      else {\n        this.initialFrameOffset = self._frameOffset;\n        this.mouseDownX = mousePosX;\n      }\n    },\n\n    onMouseMove: function(mousePosX) {\n      // Prevent scrolling the waveform if the user is dragging a segment.\n      if (this._segment && !this._seeking) {\n        return;\n      }\n\n      if (this._seeking) {\n        this._seek(mousePosX);\n      }\n      else {\n        // Moving the mouse to the left increases the time position of the\n        // left-hand edge of the visible waveform.\n        const diff = this.mouseDownX - mousePosX;\n        const newFrameOffset = this.initialFrameOffset + diff;\n\n        if (newFrameOffset !== this.initialFrameOffset) {\n          self.updateWaveform(newFrameOffset);\n        }\n      }\n    },\n\n    onMouseUp: function(/* mousePosX */) {\n      if (!this._seeking) {\n        // Set playhead position only on click release, when not dragging.\n        if (self._enableSeek && !self._mouseDragHandler.isDragging()) {\n          let time = self.pixelOffsetToTime(this.mouseDownX);\n          const duration = self._getDuration();\n\n          // Prevent the playhead position from jumping by limiting click\n          // handling to the waveform duration.\n          if (time > duration) {\n            time = duration;\n          }\n\n          self._playheadLayer.updatePlayheadTime(time);\n\n          self._peaks.player.seek(time);\n        }\n      }\n\n      // If the user was dragging the playhead while the playhead is within\n      // a segment, restore the segment's original draggable state.\n      if (this._segment && this._seeking) {\n        if (this._segmentIsDraggable) {\n          this._segment.draggable(true);\n        }\n      }\n    },\n\n    _seek: function(mousePosX) {\n      mousePosX = clamp(mousePosX, 0, self._width);\n\n      let time = self.pixelsToTime(mousePosX + self._frameOffset);\n      const duration = self._getDuration();\n\n      // Prevent the playhead position from jumping by limiting click\n      // handling to the waveform duration.\n      if (time > duration) {\n        time = duration;\n      }\n\n      // Update the playhead position. This gives a smoother visual update\n      // than if we only use the player.timeupdate event.\n      self._playheadLayer.updatePlayheadTime(time);\n\n      self._peaks.player.seek(time);\n    }\n  });\n};\n\nWaveformZoomView.prototype.enableSeek = function(enable) {\n  this._enableSeek = enable;\n};\n\nWaveformZoomView.prototype._onClick = function(event) {\n  this._clickHandler(event, 'click');\n};\n\nWaveformZoomView.prototype._onDblClick = function(event) {\n  this._clickHandler(event, 'dblclick');\n};\n\nWaveformZoomView.prototype._onMouseDown = function(event) {\n  this._clickHandler(event, 'mousedown');\n};\n\nWaveformZoomView.prototype._onContextMenu = function(event) {\n  this._clickHandler(event, 'contextmenu');\n};\n\nWaveformZoomView.prototype._clickHandler = function(event, eventName) {\n  let emitViewEvent = true;\n\n  if (event.target !== this._stage) {\n    const marker = getMarkerObject(event.target);\n\n    if (marker) {\n      if (marker.attrs.name === 'point-marker') {\n        const point = marker.getAttr('point');\n\n        if (point) {\n          this._peaks.emit('points.' + eventName, {\n            point: point,\n            evt: event.evt,\n            preventViewEvent: function() {\n              emitViewEvent = false;\n            }\n          });\n        }\n      }\n      else if (marker.attrs.name === 'segment-overlay') {\n        const segment = marker.getAttr('segment');\n\n        if (segment) {\n          const clickEvent = {\n            segment: segment,\n            evt: event.evt,\n            preventViewEvent: function() {\n              emitViewEvent = false;\n            }\n          };\n\n          this._segmentsLayer.segmentClicked(eventName, clickEvent);\n        }\n      }\n    }\n  }\n\n  if (emitViewEvent) {\n    const mousePosX = event.evt.layerX;\n    const time = this.pixelOffsetToTime(mousePosX);\n\n    this._peaks.emit('zoomview.' + eventName, {\n      time: time,\n      evt: event.evt\n    });\n  }\n};\n\nWaveformZoomView.prototype.setWheelMode = function(mode, options) {\n  if (!options) {\n    options = {};\n  }\n\n  if (mode !== this._wheelMode ||\n      options.captureVerticalScroll !== this._captureVerticalScroll) {\n    this._stage.off('wheel');\n\n    this._wheelMode = mode;\n    this._captureVerticalScroll = options.captureVerticalScroll;\n\n    switch (mode) {\n      case 'scroll':\n        if (options.captureVerticalScroll) {\n          this._stage.on('wheel', this._onWheelCaptureVerticalScroll);\n        }\n        else {\n          this._stage.on('wheel', this._onWheel);\n        }\n        break;\n    }\n  }\n};\n\nWaveformZoomView.prototype._onWheel = function(event) {\n  const wheelEvent = event.evt;\n  let delta;\n\n  if (wheelEvent.shiftKey) {\n    if (wheelEvent.deltaY !== 0) {\n      delta = wheelEvent.deltaY;\n    }\n    else if (wheelEvent.deltaX !== 0) {\n      delta = wheelEvent.deltaX;\n    }\n    else {\n      return;\n    }\n  }\n  else {\n    // Ignore the event if it looks like the user is scrolling vertically\n    // down the page\n    if (Math.abs(wheelEvent.deltaX) < Math.abs(wheelEvent.deltaY)) {\n      return;\n    }\n\n    delta = wheelEvent.deltaX;\n  }\n\n  if (wheelEvent.deltaMode === WheelEvent.DOM_DELTA_PAGE) {\n    delta *= this._width;\n  }\n\n  wheelEvent.preventDefault();\n\n  const newFrameOffset = clamp(\n    this._frameOffset + Math.floor(delta), 0, this._pixelLength - this._width\n  );\n\n  this.updateWaveform(newFrameOffset);\n};\n\nWaveformZoomView.prototype._onWheelCaptureVerticalScroll = function(event) {\n  const wheelEvent = event.evt;\n\n  const delta = Math.abs(wheelEvent.deltaX) < Math.abs(wheelEvent.deltaY) ?\n    wheelEvent.deltaY : wheelEvent.deltaX;\n\n  wheelEvent.preventDefault();\n\n  const newFrameOffset = clamp(\n    this._frameOffset + Math.floor(delta), 0, this._pixelLength - this._width\n  );\n\n  this.updateWaveform(newFrameOffset);\n};\n\nWaveformZoomView.prototype.enableSegmentDragging = function(enable) {\n  this._enableSegmentDragging = enable;\n\n  // Update all existing segments\n  this._segmentsLayer.enableSegmentDragging(enable);\n};\n\nWaveformZoomView.prototype.isSegmentDraggingEnabled = function() {\n  return this._enableSegmentDragging;\n};\n\nWaveformZoomView.prototype.setSegmentDragMode = function(mode) {\n  this._segmentDragMode = mode;\n};\n\nWaveformZoomView.prototype.getSegmentDragMode = function() {\n  return this._segmentDragMode;\n};\n\nWaveformZoomView.prototype.getName = function() {\n  return 'zoomview';\n};\n\nWaveformZoomView.prototype._onTimeUpdate = function(time) {\n  if (this._mouseDragHandler.isDragging()) {\n    return;\n  }\n\n  this._syncPlayhead(time);\n};\n\nWaveformZoomView.prototype._onPlaying = function(time) {\n  this._playheadLayer.updatePlayheadTime(time);\n};\n\nWaveformZoomView.prototype._onPause = function(time) {\n  this._playheadLayer.stop(time);\n};\n\nWaveformZoomView.prototype._onWindowResize = function() {\n  const self = this;\n\n  const width = self._container.clientWidth;\n\n  if (!self._zoomLevelAuto) {\n    if (width !== 0) {\n      self._width = width;\n      self._stage.width(width);\n      self.updateWaveform(self._frameOffset);\n    }\n  }\n  else {\n    if (self._resizeTimeoutId) {\n      clearTimeout(self._resizeTimeoutId);\n      self._resizeTimeoutId = null;\n    }\n\n    // Avoid resampling waveform data to zero width\n    if (width !== 0) {\n      self._width = width;\n      self._stage.width(width);\n\n      self._resizeTimeoutId = setTimeout(function() {\n        self._width = width;\n        self._data = self._originalWaveformData.resample(width);\n        self._stage.width(width);\n\n        self.updateWaveform(self._frameOffset);\n      }, 500);\n    }\n  }\n};\n\nWaveformZoomView.prototype._onKeyboardLeft = function() {\n  this._keyboardScroll(-1, false);\n};\n\nWaveformZoomView.prototype._onKeyboardRight = function() {\n  this._keyboardScroll(1, false);\n};\n\nWaveformZoomView.prototype._onKeyboardShiftLeft = function() {\n  this._keyboardScroll(-1, true);\n};\n\nWaveformZoomView.prototype._onKeyboardShiftRight = function() {\n  this._keyboardScroll(1, true);\n};\n\nWaveformZoomView.prototype._keyboardScroll = function(direction, large) {\n  let increment;\n\n  if (large) {\n    increment = direction * this._width;\n  }\n  else {\n    increment = direction * this.timeToPixels(this._options.nudgeIncrement);\n  }\n\n  this.scrollWaveform({ pixels: increment });\n};\n\nWaveformZoomView.prototype.setWaveformData = function(waveformData) {\n  this._originalWaveformData = waveformData;\n  // Clear cached waveforms\n  this._initWaveformCache();\n\n  // Don't update the UI here, call setZoom().\n};\n\nWaveformZoomView.prototype.playheadPosChanged = function(time) {\n  if (this._playedWaveformShape) {\n    this._playedSegment.endTime = time;\n    this._unplayedSegment.startTime = time;\n\n    this._drawWaveformLayer();\n  }\n};\n\nWaveformZoomView.prototype._syncPlayhead = function(time) {\n  this._playheadLayer.updatePlayheadTime(time);\n\n  if (this._enableAutoScroll) {\n    // Check for the playhead reaching the right-hand side of the window.\n\n    const pixelIndex = this.timeToPixels(time);\n\n    // TODO: move this code to animation function?\n    // TODO: don't scroll if user has positioned view manually (e.g., using\n    // the keyboard)\n    const endThreshold = this._frameOffset + this._width - (this._width / 2);\n\n    if (pixelIndex >= endThreshold || pixelIndex < this._frameOffset) {\n      this._frameOffset = pixelIndex - Math.round(this._width / 2);\n\n      if (this._frameOffset < 0) {\n        this._frameOffset = 0;\n      }\n\n      this.updateWaveform(this._frameOffset);\n    }\n  }\n};\n\nWaveformZoomView.prototype._getScale = function(duration) {\n  return duration * this._data.sample_rate / this._width;\n};\n\nfunction isAutoScale(options) {\n  return ((objectHasProperty(options, 'scale') && options.scale === 'auto') ||\n          (objectHasProperty(options, 'seconds') && options.seconds === 'auto'));\n}\n\n/**\n * Options for [WaveformZoomView.setZoom]{@link WaveformZoomView#setZoom}.\n *\n * @typedef {Object} SetZoomOptions\n * @global\n * @property {Number|String} scale Zoom level, in samples per pixel, or 'auto'\n *   to fit the entire waveform to the view width\n * @property {Number|String} seconds Number of seconds to fit to the view width,\n *   or 'auto' to fit the entire waveform to the view width\n */\n\n/**\n * Changes the zoom level.\n *\n * @param {SetZoomOptions} options\n * @returns {Boolean}\n */\n\nWaveformZoomView.prototype.setZoom = function(options) {\n  let scale;\n\n  if (isAutoScale(options)) {\n    const seconds = this._peaks.player.getDuration();\n\n    if (!isValidTime(seconds)) {\n      return false;\n    }\n\n    this._zoomLevelAuto = true;\n    this._zoomLevelSeconds = null;\n    scale = this._getScale(seconds);\n  }\n  else {\n    if (objectHasProperty(options, 'scale')) {\n      this._zoomLevelSeconds = null;\n      scale = options.scale;\n    }\n    else if (objectHasProperty(options, 'seconds')) {\n      if (!isValidTime(options.seconds)) {\n        return false;\n      }\n\n      this._zoomLevelSeconds = options.seconds;\n      scale = this._getScale(options.seconds);\n    }\n\n    this._zoomLevelAuto = false;\n  }\n\n  if (scale < this._originalWaveformData.scale) {\n    // eslint-disable-next-line max-len\n    this._peaks._logger('peaks.zoomview.setZoom(): zoom level must be at least ' + this._originalWaveformData.scale);\n    scale = this._originalWaveformData.scale;\n  }\n\n  const currentTime = this._peaks.player.getCurrentTime();\n  let apexTime;\n  let playheadOffsetPixels = this._playheadLayer.getPlayheadOffset();\n\n  if (playheadOffsetPixels >= 0 && playheadOffsetPixels < this._width) {\n    // Playhead is visible. Change the zoom level while keeping the\n    // playhead at the same position in the window.\n    apexTime = currentTime;\n  }\n  else {\n    // Playhead is not visible. Change the zoom level while keeping the\n    // centre of the window at the same position in the waveform.\n    playheadOffsetPixels = Math.floor(this._width / 2);\n    apexTime = this.pixelOffsetToTime(playheadOffsetPixels);\n  }\n\n  const prevScale = this._scale;\n\n  this._resampleData({ scale: scale });\n\n  const apexPixel = this.timeToPixels(apexTime);\n\n  this._frameOffset = apexPixel - playheadOffsetPixels;\n\n  this.updateWaveform(this._frameOffset);\n\n  this._playheadLayer.zoomLevelChanged();\n\n  // Update the playhead position after zooming.\n  this._playheadLayer.updatePlayheadTime(currentTime);\n\n  // const adapter = this.createZoomAdapter(currentScale, previousScale);\n\n  // adapter.start(relativePosition);\n\n  this._peaks.emit('zoom.update', scale, prevScale);\n\n  return true;\n};\n\nWaveformZoomView.prototype._resampleData = function(options) {\n  const scale = options.scale;\n\n  if (this._enableWaveformCache) {\n    if (!this._waveformData.has(scale)) {\n      let sourceWaveform = this._originalWaveformData;\n\n      // Resample from the next lowest available zoom level\n\n      for (let i = 0; i < this._waveformScales.length; i++) {\n        if (this._waveformScales[i] < scale) {\n          sourceWaveform = this._waveformData.get(this._waveformScales[i]);\n        }\n        else {\n          break;\n        }\n      }\n\n      this._waveformData.set(scale, sourceWaveform.resample(options));\n\n      this._waveformScales.push(scale);\n      this._waveformScales.sort(function(a, b) {\n        return a - b; // Ascending order\n      });\n    }\n\n    this._data = this._waveformData.get(scale);\n  }\n  else {\n    this._data = this._originalWaveformData.resample(options);\n  }\n\n  this._scale = this._data.scale;\n  this._pixelLength = this._data.length;\n};\n\nWaveformZoomView.prototype.getStartTime = function() {\n  return this.pixelOffsetToTime(0);\n};\n\nWaveformZoomView.prototype.getEndTime = function() {\n  return this.pixelOffsetToTime(this._width);\n};\n\nWaveformZoomView.prototype.setStartTime = function(time) {\n  if (time < 0) {\n    time = 0;\n  }\n\n  if (this._zoomLevelAuto) {\n    time = 0;\n  }\n\n  this.updateWaveform(this.timeToPixels(time));\n};\n\n/**\n * Returns the pixel index for a given time, for the current zoom level.\n *\n * @param {Number} time Time, in seconds.\n * @returns {Number} Pixel index.\n */\n\nWaveformZoomView.prototype.timeToPixels = function(time) {\n  return Math.floor(time * this._data.sample_rate / this._data.scale);\n};\n\n/**\n * Returns the time for a given pixel index, for the current zoom level.\n *\n * @param {Number} pixels Pixel index.\n * @returns {Number} Time, in seconds.\n */\n\nWaveformZoomView.prototype.pixelsToTime = function(pixels) {\n  return pixels * this._data.scale / this._data.sample_rate;\n};\n\n/**\n * Returns the time for a given pixel offset (relative to the\n * current scroll position), for the current zoom level.\n *\n * @param {Number} offset Offset from left-visible-edge of view\n * @returns {Number} Time, in seconds.\n */\n\nWaveformZoomView.prototype.pixelOffsetToTime = function(offset) {\n  const pixels = this._frameOffset + offset;\n\n  return pixels * this._data.scale / this._data.sample_rate;\n};\n\nWaveformZoomView.prototype.timeToPixelOffset = function(time) {\n  return Math.floor(time * this._data.sample_rate / this._data.scale) - this._frameOffset;\n};\n\n/* const zoomAdapterMap = {\n  'animated': AnimatedZoomAdapter,\n  'static': StaticZoomAdapter\n};\n\nWaveformZoomView.prototype.createZoomAdapter = function(currentScale, previousScale) {\n  const ZoomAdapter = zoomAdapterMap[this._viewOptions.zoomAdapter];\n\n  if (!ZoomAdapter) {\n    throw new Error('Invalid zoomAdapter: ' + this._viewOptions.zoomAdapter);\n  }\n\n  return ZoomAdapter.create(this, currentScale, previousScale);\n}; */\n\n/**\n * @returns {Number} The start position of the waveform shown in the view,\n *   in pixels.\n */\n\nWaveformZoomView.prototype.getFrameOffset = function() {\n  return this._frameOffset;\n};\n\n/**\n * @returns {Number} The width of the view, in pixels.\n */\n\nWaveformZoomView.prototype.getWidth = function() {\n  return this._width;\n};\n\n/**\n * @returns {Number} The height of the view, in pixels.\n */\n\nWaveformZoomView.prototype.getHeight = function() {\n  return this._height;\n};\n\n/**\n * @returns {Number} The length of the waveform, in pixels.\n */\nWaveformZoomView.prototype.getPixelLength = function() {\n  return this._pixelLength;\n};\n\n/**\n * @returns {Number} The media duration, in seconds.\n */\n\nWaveformZoomView.prototype._getDuration = function() {\n  return this._peaks.player.getDuration();\n};\n\n/**\n * Adjusts the amplitude scale of waveform shown in the view, which allows\n * users to zoom the waveform vertically.\n *\n * @param {Number} scale The new amplitude scale factor\n */\n\nWaveformZoomView.prototype.setAmplitudeScale = function(scale) {\n  if (!isNumber(scale) || !isFinite(scale)) {\n    throw new Error('view.setAmplitudeScale(): Scale must be a valid number');\n  }\n\n  this._amplitudeScale = scale;\n\n  this._drawWaveformLayer();\n  this._segmentsLayer.draw();\n};\n\nWaveformZoomView.prototype.getAmplitudeScale = function() {\n  return this._amplitudeScale;\n};\n\n/**\n * @returns {WaveformData} The view's waveform data.\n */\n\nWaveformZoomView.prototype.getWaveformData = function() {\n  return this._data;\n};\n\nWaveformZoomView.prototype._createWaveformShapes = function() {\n  if (!this._waveformShape) {\n    this._waveformShape = new WaveformShape({\n      color: this._waveformColor,\n      view: this\n    });\n\n    this._waveformShape.addToLayer(this._waveformLayer);\n  }\n\n  if (this._playedWaveformColor && !this._playedWaveformShape) {\n    const time = this._peaks.player.getCurrentTime();\n\n    this._playedSegment = {\n      startTime: 0,\n      endTime: time\n    };\n\n    this._unplayedSegment = {\n      startTime: time,\n      endTime: this._getDuration()\n    };\n\n    this._waveformShape.setSegment(this._unplayedSegment);\n\n    this._playedWaveformShape = new WaveformShape({\n      color: this._playedWaveformColor,\n      view: this,\n      segment: this._playedSegment\n    });\n\n    this._playedWaveformShape.addToLayer(this._waveformLayer);\n  }\n};\n\nWaveformZoomView.prototype._destroyPlayedWaveformShape = function() {\n  this._waveformShape.setSegment(null);\n\n  this._playedWaveformShape.destroy();\n  this._playedWaveformShape = null;\n\n  this._playedSegment = null;\n  this._unplayedSegment = null;\n};\n\nWaveformZoomView.prototype._createWaveform = function() {\n  this._waveformLayer = new Konva.Layer({ listening: false });\n\n  this._createWaveformShapes();\n\n  this._stage.add(this._waveformLayer);\n\n  this._peaks.emit('zoomview.displaying', 0, this.getEndTime());\n};\n\nWaveformZoomView.prototype._createAxisLabels = function() {\n  this._axisLayer = new Konva.Layer({ listening: false });\n  this._axis = new WaveformAxis(this, this._viewOptions);\n\n  this._axis.addToLayer(this._axisLayer);\n  this._stage.add(this._axisLayer);\n};\n\n/**\n * Scrolls the region of waveform shown in the view.\n *\n * @param {Number} scrollAmount How far to scroll, in pixels\n */\n\nWaveformZoomView.prototype.scrollWaveform = function(options) {\n  let scrollAmount;\n\n  if (objectHasProperty(options, 'pixels')) {\n    scrollAmount = Math.floor(options.pixels);\n  }\n  else if (objectHasProperty(options, 'seconds')) {\n    scrollAmount = this.timeToPixels(options.seconds);\n  }\n  else {\n    throw new TypeError('view.scrollWaveform(): Missing umber of pixels or seconds');\n  }\n\n  this.updateWaveform(this._frameOffset + scrollAmount);\n};\n\n/**\n * Updates the region of waveform shown in the view.\n *\n * @param {Number} frameOffset The new frame offset, in pixels.\n */\n\nWaveformZoomView.prototype.updateWaveform = function(frameOffset) {\n  let upperLimit;\n\n  if (this._pixelLength < this._width) {\n    // Total waveform is shorter than viewport, so reset the offset to 0.\n    frameOffset = 0;\n    upperLimit = this._width;\n  }\n  else {\n    // Calculate the very last possible position.\n    upperLimit = this._pixelLength - this._width;\n  }\n\n  frameOffset = clamp(frameOffset, 0, upperLimit);\n\n  this._frameOffset = frameOffset;\n\n  // Display playhead if it is within the zoom frame width.\n  const playheadPixel = this._playheadLayer.getPlayheadPixel();\n\n  this._playheadLayer.updatePlayheadTime(this.pixelsToTime(playheadPixel));\n\n  this._drawWaveformLayer();\n  this._axisLayer.draw();\n\n  const frameStartTime = this.getStartTime();\n  const frameEndTime   = this.getEndTime();\n\n  this._pointsLayer.updatePoints(frameStartTime, frameEndTime);\n  this._segmentsLayer.updateSegments(frameStartTime, frameEndTime);\n\n  this._peaks.emit('zoomview.displaying', frameStartTime, frameEndTime);\n};\n\nWaveformZoomView.prototype._drawWaveformLayer = function() {\n  this._waveformLayer.draw();\n};\n\nWaveformZoomView.prototype.setWaveformColor = function(color) {\n  this._waveformColor = color;\n  this._waveformShape.setWaveformColor(color);\n};\n\nWaveformZoomView.prototype.setPlayedWaveformColor = function(color) {\n  this._playedWaveformColor = color;\n\n  if (color) {\n    if (!this._playedWaveformShape) {\n      this._createWaveformShapes();\n    }\n\n    this._playedWaveformShape.setWaveformColor(color);\n  }\n  else {\n    if (this._playedWaveformShape) {\n      this._destroyPlayedWaveformShape();\n    }\n  }\n};\n\nWaveformZoomView.prototype.showPlayheadTime = function(show) {\n  this._playheadLayer.showPlayheadTime(show);\n};\n\nWaveformZoomView.prototype.setTimeLabelPrecision = function(precision) {\n  this._timeLabelPrecision = precision;\n  this._playheadLayer.updatePlayheadText();\n};\n\nWaveformZoomView.prototype.formatTime = function(time) {\n  return this._formatPlayheadTime(time);\n};\n\nWaveformZoomView.prototype.showAxisLabels = function(show) {\n  this._axis.showAxisLabels(show);\n  this._axisLayer.draw();\n};\n\nWaveformZoomView.prototype.enableAutoScroll = function(enable) {\n  this._enableAutoScroll = enable;\n};\n\nWaveformZoomView.prototype.enableMarkerEditing = function(enable) {\n  this._segmentsLayer.enableEditing(enable);\n  this._pointsLayer.enableEditing(enable);\n};\n\nWaveformZoomView.prototype.getMinSegmentDragWidth = function() {\n  return this._minSegmentDragWidth;\n};\n\nWaveformZoomView.prototype.setMinSegmentDragWidth = function(width) {\n  this._minSegmentDragWidth = width;\n};\n\nWaveformZoomView.prototype.fitToContainer = function() {\n  if (this._container.clientWidth === 0 && this._container.clientHeight === 0) {\n    return;\n  }\n\n  let updateWaveform = false;\n\n  if (this._container.clientWidth !== this._width) {\n    this._width = this._container.clientWidth;\n    this._stage.width(this._width);\n\n    let resample = false;\n    let resampleOptions;\n\n    if (this._zoomLevelAuto) {\n      resample = true;\n      resampleOptions = { width: this._width };\n    }\n    else if (this._zoomLevelSeconds !== null) {\n      resample = true;\n      resampleOptions = { scale: this._getScale(this._zoomLevelSeconds) };\n    }\n\n    if (resample) {\n      try {\n        this._resampleData(resampleOptions);\n        updateWaveform = true;\n      }\n      catch (error) {\n        // Ignore, and leave this._data as it was\n      }\n    }\n  }\n\n  this._height = this._container.clientHeight;\n  this._stage.height(this._height);\n\n  this._waveformShape.fitToView();\n  this._playheadLayer.fitToView();\n  this._segmentsLayer.fitToView();\n  this._pointsLayer.fitToView();\n\n  if (updateWaveform) {\n    this.updateWaveform(this._frameOffset);\n  }\n\n  this._stage.draw();\n};\n\nWaveformZoomView.prototype.getViewOptions = function() {\n  return this._viewOptions;\n};\n\n/* WaveformZoomView.prototype.beginZoom = function() {\n  // Fade out the time axis and the segments\n  // this._axis.axisShape.setAttr('opacity', 0);\n\n  if (this._pointsLayer) {\n    this._pointsLayer.setVisible(false);\n  }\n\n  if (this._segmentsLayer) {\n    this._segmentsLayer.setVisible(false);\n  }\n};\n\nWaveformZoomView.prototype.endZoom = function() {\n  if (this._pointsLayer) {\n    this._pointsLayer.setVisible(true);\n  }\n\n  if (this._segmentsLayer) {\n    this._segmentsLayer.setVisible(true);\n  }\n\n  const time = this._peaks.player.getCurrentTime();\n\n  this.seekFrame(this.timeToPixels(time));\n}; */\n\nWaveformZoomView.prototype.destroy = function() {\n  if (this._resizeTimeoutId) {\n    clearTimeout(this._resizeTimeoutId);\n    this._resizeTimeoutId = null;\n  }\n\n  // Unregister event handlers\n  this._peaks.off('player.timeupdate', this._onTimeUpdate);\n  this._peaks.off('player.playing', this._onPlaying);\n  this._peaks.off('player.pause', this._onPause);\n  this._peaks.off('window_resize', this._onWindowResize);\n  this._peaks.off('keyboard.left', this._onKeyboardLeft);\n  this._peaks.off('keyboard.right', this._onKeyboardRight);\n  this._peaks.off('keyboard.shift_left', this._onKeyboardShiftLeft);\n  this._peaks.off('keyboard.shift_right', this._onKeyboardShiftRight);\n\n  this._playheadLayer.destroy();\n  this._segmentsLayer.destroy();\n  this._pointsLayer.destroy();\n\n  if (this._stage) {\n    this._stage.destroy();\n    this._stage = null;\n  }\n};\n\nexport default WaveformZoomView;\n","/**\n * @file\n *\n * Defines the {@link ViewController} class.\n *\n * @module view-controller\n */\n\nimport WaveformOverview from './waveform-overview';\nimport WaveformZoomView from './waveform-zoomview';\nimport { isNullOrUndefined } from './utils';\n\n/**\n * Creates an object that allows users to create and manage waveform views.\n *\n * @class\n * @alias ViewController\n *\n * @param {Peaks} peaks\n */\n\nfunction ViewController(peaks) {\n  this._peaks = peaks;\n  this._overview = null;\n  this._zoomview = null;\n}\n\nViewController.prototype.createOverview = function(container) {\n  if (this._overview) {\n    return this._overview;\n  }\n\n  const waveformData = this._peaks.getWaveformData();\n\n  this._overview = new WaveformOverview(\n    waveformData,\n    container,\n    this._peaks\n  );\n\n  if (this._zoomview) {\n    this._overview.showHighlight(\n      this._zoomview.getStartTime(),\n      this._zoomview.getEndTime()\n    );\n  }\n\n  return this._overview;\n};\n\nViewController.prototype.createZoomview = function(container) {\n  if (this._zoomview) {\n    return this._zoomview;\n  }\n\n  const waveformData = this._peaks.getWaveformData();\n\n  this._zoomview = new WaveformZoomView(\n    waveformData,\n    container,\n    this._peaks\n  );\n\n  return this._zoomview;\n};\n\nViewController.prototype.destroyOverview = function() {\n  if (!this._overview) {\n    return;\n  }\n\n  if (!this._zoomview) {\n    return;\n  }\n\n  this._overview.destroy();\n  this._overview = null;\n};\n\nViewController.prototype.destroyZoomview = function() {\n  if (!this._zoomview) {\n    return;\n  }\n\n  if (!this._overview) {\n    return;\n  }\n\n  this._zoomview.destroy();\n  this._zoomview = null;\n\n  this._overview.removeHighlightRect();\n};\n\nViewController.prototype.destroy = function() {\n  if (this._overview) {\n    this._overview.destroy();\n    this._overview = null;\n  }\n\n  if (this._zoomview) {\n    this._zoomview.destroy();\n    this._zoomview = null;\n  }\n};\n\nViewController.prototype.getView = function(name) {\n  if (isNullOrUndefined(name)) {\n    if (this._overview && this._zoomview) {\n      return null;\n    }\n    else if (this._overview) {\n      return this._overview;\n    }\n    else if (this._zoomview) {\n      return this._zoomview;\n    }\n    else {\n      return null;\n    }\n  }\n  else {\n    switch (name) {\n      case 'overview':\n        return this._overview;\n\n      case 'zoomview':\n        return this._zoomview;\n\n      default:\n        return null;\n    }\n  }\n};\n\nexport default ViewController;\n","/**\n * @file\n *\n * Defines the {@link ZoomController} class.\n *\n * @module zoom-controller\n */\n\n/**\n * Creates an object to control zoom levels in a {@link WaveformZoomView}.\n *\n * @class\n * @alias ZoomController\n *\n * @param {Peaks} peaks\n * @param {Array<Integer>} zoomLevels\n */\n\nfunction ZoomController(peaks, zoomLevels) {\n  this._peaks = peaks;\n  this._zoomLevels = zoomLevels;\n  this._zoomLevelIndex = 0;\n}\n\nZoomController.prototype.setZoomLevels = function(zoomLevels) {\n  this._zoomLevels = zoomLevels;\n  this.setZoom(0, true);\n};\n\n/**\n * Zoom in one level.\n */\n\nZoomController.prototype.zoomIn = function() {\n  this.setZoom(this._zoomLevelIndex - 1);\n};\n\n/**\n * Zoom out one level.\n */\n\nZoomController.prototype.zoomOut = function() {\n  this.setZoom(this._zoomLevelIndex + 1);\n};\n\n/**\n * Given a particular zoom level, triggers a resampling of the data in the\n * zoomed view.\n *\n * @param {number} zoomLevelIndex An index into the options.zoomLevels array.\n */\n\nZoomController.prototype.setZoom = function(zoomLevelIndex, forceUpdate) {\n  if (zoomLevelIndex >= this._zoomLevels.length) {\n    zoomLevelIndex = this._zoomLevels.length - 1;\n  }\n\n  if (zoomLevelIndex < 0) {\n    zoomLevelIndex = 0;\n  }\n\n  if (!forceUpdate && (zoomLevelIndex === this._zoomLevelIndex)) {\n    // Nothing to do.\n    return;\n  }\n\n  this._zoomLevelIndex = zoomLevelIndex;\n\n  const zoomview = this._peaks.views.getView('zoomview');\n\n  if (!zoomview) {\n    return;\n  }\n\n  zoomview.setZoom({ scale: this._zoomLevels[zoomLevelIndex] });\n};\n\n/**\n * Returns the current zoom level index.\n *\n * @returns {Number}\n */\n\nZoomController.prototype.getZoom = function() {\n  return this._zoomLevelIndex;\n};\n\n/**\n * Returns the current zoom level, in samples per pixel.\n *\n * @returns {Number}\n */\n\nZoomController.prototype.getZoomLevel = function() {\n  return this._zoomLevels[this._zoomLevelIndex];\n};\n\nexport default ZoomController;\n","/**\n * @file\n *\n * Defines the {@link WaveformBuilder} class.\n *\n * @module waveform-builder\n */\n\nimport { isArrayBuffer, isObject, isString } from './utils';\nimport WaveformData from 'waveform-data';\n\nconst isXhr2 = ('withCredentials' in new XMLHttpRequest());\n\n/**\n * Creates and returns a WaveformData object, either by requesting the\n * waveform data from the server, or by creating the waveform data using the\n * Web Audio API.\n *\n * @class\n * @alias WaveformBuilder\n *\n * @param {Peaks} peaks\n */\n\nfunction WaveformBuilder(peaks) {\n  this._peaks = peaks;\n}\n\n/**\n * Options for requesting remote waveform data.\n *\n * @typedef {Object} RemoteWaveformDataOptions\n * @global\n * @property {String=} arraybuffer\n * @property {String=} json\n */\n\n/**\n * Options for supplying local waveform data.\n *\n * @typedef {Object} LocalWaveformDataOptions\n * @global\n * @property {ArrayBuffer=} arraybuffer\n * @property {Object=} json\n */\n\n/**\n * Options for the Web Audio waveform builder.\n *\n * @typedef {Object} WaveformBuilderWebAudioOptions\n * @global\n * @property {AudioContext} audioContext\n * @property {AudioBuffer=} audioBuffer\n * @property {Number=} scale\n * @property {Boolean=} multiChannel\n */\n\n/**\n * Options for [WaveformBuilder.init]{@link WaveformBuilder#init}.\n *\n * @typedef {Object} WaveformBuilderInitOptions\n * @global\n * @property {RemoteWaveformDataOptions=} dataUri\n * @property {LocalWaveformDataOptions=} waveformData\n * @property {WaveformBuilderWebAudioOptions=} webAudio\n * @property {Boolean=} withCredentials\n * @property {Array<Number>=} zoomLevels\n */\n\n/**\n * Callback for receiving the waveform data.\n *\n * @callback WaveformBuilderInitCallback\n * @global\n * @param {Error} error\n * @param {WaveformData} waveformData\n */\n\n/**\n * Loads or creates the waveform data.\n *\n * @private\n * @param {WaveformBuilderInitOptions} options\n * @param {WaveformBuilderInitCallback} callback\n */\n\nWaveformBuilder.prototype.init = function(options, callback) {\n  if ((options.dataUri && (options.webAudio || options.audioContext)) ||\n      (options.waveformData && (options.webAudio || options.audioContext)) ||\n      (options.dataUri && options.waveformData)) {\n    // eslint-disable-next-line max-len\n    callback(new TypeError('Peaks.init(): You may only pass one source (webAudio, dataUri, or waveformData) to render waveform data.'));\n    return;\n  }\n\n  if (options.audioContext) {\n    // eslint-disable-next-line max-len\n    this._peaks._logger('Peaks.init(): The audioContext option is deprecated, please pass a webAudio object instead');\n\n    options.webAudio = {\n      audioContext: options.audioContext\n    };\n  }\n\n  if (options.dataUri) {\n    return this._getRemoteWaveformData(options, callback);\n  }\n  else if (options.waveformData) {\n    return this._buildWaveformFromLocalData(options, callback);\n  }\n  else if (options.webAudio) {\n    if (options.webAudio.audioBuffer) {\n      return this._buildWaveformDataFromAudioBuffer(options, callback);\n    }\n    else {\n      return this._buildWaveformDataUsingWebAudio(options, callback);\n    }\n  }\n  else {\n    // eslint-disable-next-line max-len\n    callback(new Error('Peaks.init(): You must pass an audioContext, or dataUri, or waveformData to render waveform data'));\n  }\n};\n\n/* eslint-disable max-len */\n\n/**\n * Fetches waveform data, based on the given options.\n *\n * @private\n * @param {Object} options\n * @param {String|Object} options.dataUri\n * @param {String} options.dataUri.arraybuffer Waveform data URL\n *   (binary format)\n * @param {String} options.dataUri.json Waveform data URL (JSON format)\n * @param {String} options.defaultUriFormat Either 'arraybuffer' (for binary\n *   data) or 'json'\n * @param {WaveformBuilderInitCallback} callback\n *\n * @see Refer to the <a href=\"https://github.com/bbc/audiowaveform/blob/master/doc/DataFormat.md\">data format documentation</a>\n *   for details of the binary and JSON waveform data formats.\n */\n\n/* eslint-enable max-len */\n\nWaveformBuilder.prototype._getRemoteWaveformData = function(options, callback) {\n  const self = this;\n\n  let dataUri = null;\n  let requestType = null;\n  let url;\n\n  if (isObject(options.dataUri)) {\n    dataUri = options.dataUri;\n  }\n  else if (isString(options.dataUri)) {\n    // Backward compatibility\n    dataUri = {};\n    dataUri[options.dataUriDefaultFormat || 'json'] = options.dataUri;\n  }\n  else {\n    callback(new TypeError('Peaks.init(): The dataUri option must be an object'));\n    return;\n  }\n\n  ['ArrayBuffer', 'JSON'].some(function(connector) {\n    if (window[connector]) {\n      requestType = connector.toLowerCase();\n      url = dataUri[requestType];\n\n      return Boolean(url);\n    }\n  });\n\n  if (!url) {\n    // eslint-disable-next-line max-len\n    callback(new Error('Peaks.init(): Unable to determine a compatible dataUri format for this browser'));\n    return;\n  }\n\n  self._xhr = self._createXHR(url, requestType, options.withCredentials, function(event) {\n    if (this.readyState !== 4) {\n      return;\n    }\n\n    if (this.status !== 200) {\n      callback(\n        new Error('Unable to fetch remote data. HTTP status ' + this.status)\n      );\n\n      return;\n    }\n\n    self._xhr = null;\n\n    const waveformData = WaveformData.create(event.target.response);\n\n    if (waveformData.channels !== 1 && waveformData.channels !== 2) {\n      callback(new Error('Peaks.init(): Only mono or stereo waveforms are currently supported'));\n      return;\n    }\n    else if (waveformData.bits !== 8) {\n      callback(new Error('Peaks.init(): 16-bit waveform data is not supported'));\n      return;\n    }\n\n    callback(null, waveformData);\n  },\n  function() {\n    callback(new Error('XHR failed'));\n  },\n  function() {\n    callback(new Error('XHR aborted'));\n  });\n\n  self._xhr.send();\n};\n\n/* eslint-disable max-len */\n\n/**\n * Creates a waveform from given data, based on the given options.\n *\n * @private\n * @param {Object} options\n * @param {Object} options.waveformData\n * @param {ArrayBuffer} options.waveformData.arraybuffer Waveform data (binary format)\n * @param {Object} options.waveformData.json Waveform data (JSON format)\n * @param {WaveformBuilderInitCallback} callback\n *\n * @see Refer to the <a href=\"https://github.com/bbc/audiowaveform/blob/master/doc/DataFormat.md\">data format documentation</a>\n *   for details of the binary and JSON waveform data formats.\n */\n\n/* eslint-enable max-len */\n\nWaveformBuilder.prototype._buildWaveformFromLocalData = function(options, callback) {\n  let waveformData = null;\n  let data = null;\n\n  if (isObject(options.waveformData)) {\n    waveformData = options.waveformData;\n  }\n  else {\n    callback(new Error('Peaks.init(): The waveformData option must be an object'));\n    return;\n  }\n\n  if (isObject(waveformData.json)) {\n    data = waveformData.json;\n  }\n  else if (isArrayBuffer(waveformData.arraybuffer)) {\n    data = waveformData.arraybuffer;\n  }\n\n  if (!data) {\n    // eslint-disable-next-line max-len\n    callback(new Error('Peaks.init(): Unable to determine a compatible waveformData format'));\n    return;\n  }\n\n  try {\n    const createdWaveformData = WaveformData.create(data);\n\n    if (createdWaveformData.channels !== 1 && createdWaveformData.channels !== 2) {\n      callback(new Error('Peaks.init(): Only mono or stereo waveforms are currently supported'));\n      return;\n    }\n    else if (createdWaveformData.bits !== 8) {\n      callback(new Error('Peaks.init(): 16-bit waveform data is not supported'));\n      return;\n    }\n\n    callback(null, createdWaveformData);\n  }\n  catch (err) {\n    callback(err);\n  }\n};\n\n/**\n * Creates waveform data using the Web Audio API.\n *\n * @private\n * @param {Object} options\n * @param {AudioContext} options.audioContext\n * @param {HTMLMediaElement} options.mediaElement\n * @param {WaveformBuilderInitCallback} callback\n */\n\nWaveformBuilder.prototype._buildWaveformDataUsingWebAudio = function(options, callback) {\n  const self = this;\n\n  const audioContext = window.AudioContext || window.webkitAudioContext;\n\n  if (!(options.webAudio.audioContext instanceof audioContext)) {\n    // eslint-disable-next-line max-len\n    callback(new TypeError('Peaks.init(): The webAudio.audioContext option must be a valid AudioContext'));\n    return;\n  }\n\n  const webAudioOptions = options.webAudio;\n\n  if (webAudioOptions.scale !== options.zoomLevels[0]) {\n    webAudioOptions.scale = options.zoomLevels[0];\n  }\n\n  // If the media element has already selected which source to play, its\n  // currentSrc attribute will contain the source media URL. Otherwise,\n  // we wait for a canplay event to tell us when the media is ready.\n\n  const mediaSourceUrl = self._peaks.options.mediaElement.currentSrc;\n\n  if (mediaSourceUrl) {\n    self._requestAudioAndBuildWaveformData(\n      mediaSourceUrl,\n      webAudioOptions,\n      options.withCredentials,\n      callback\n    );\n  }\n  else {\n    self._peaks.once('player.canplay', function() {\n      self._requestAudioAndBuildWaveformData(\n        self._peaks.options.mediaElement.currentSrc,\n        webAudioOptions,\n        options.withCredentials,\n        callback\n      );\n    });\n  }\n};\n\nWaveformBuilder.prototype._buildWaveformDataFromAudioBuffer = function(options, callback) {\n  const webAudioOptions = options.webAudio;\n\n  if (webAudioOptions.scale !== options.zoomLevels[0]) {\n    webAudioOptions.scale = options.zoomLevels[0];\n  }\n\n  const webAudioBuilderOptions = {\n    audio_buffer: webAudioOptions.audioBuffer,\n    split_channels: webAudioOptions.multiChannel,\n    scale: webAudioOptions.scale,\n    disable_worker: true\n  };\n\n  WaveformData.createFromAudio(webAudioBuilderOptions, callback);\n};\n\n/**\n * Fetches the audio content, based on the given options, and creates waveform\n * data using the Web Audio API.\n *\n * @private\n * @param {url} The media source URL\n * @param {WaveformBuilderWebAudioOptions} webAudio\n * @param {Boolean} withCredentials\n * @param {WaveformBuilderInitCallback} callback\n */\n\nWaveformBuilder.prototype._requestAudioAndBuildWaveformData = function(url,\n    webAudio, withCredentials, callback) {\n  const self = this;\n\n  if (!url) {\n    self._peaks._logger('Peaks.init(): The mediaElement src is invalid');\n    return;\n  }\n\n  self._xhr = self._createXHR(url, 'arraybuffer', withCredentials, function(event) {\n    if (this.readyState !== 4) {\n      return;\n    }\n\n    if (this.status !== 200) {\n      callback(\n        new Error('Unable to fetch remote data. HTTP status ' + this.status)\n      );\n\n      return;\n    }\n\n    self._xhr = null;\n\n    const webAudioBuilderOptions = {\n      audio_context: webAudio.audioContext,\n      array_buffer: event.target.response,\n      split_channels: webAudio.multiChannel,\n      scale: webAudio.scale\n    };\n\n    WaveformData.createFromAudio(webAudioBuilderOptions, callback);\n  },\n  function() {\n    callback(new Error('XHR failed'));\n  },\n  function() {\n    callback(new Error('XHR aborted'));\n  });\n\n  self._xhr.send();\n};\n\nWaveformBuilder.prototype.abort = function() {\n  if (this._xhr) {\n    this._xhr.abort();\n  }\n};\n\n/**\n * @private\n * @param {String} url\n * @param {String} requestType\n * @param {Boolean} withCredentials\n * @param {Function} onLoad\n * @param {Function} onError\n *\n * @returns {XMLHttpRequest}\n */\n\nWaveformBuilder.prototype._createXHR = function(url, requestType,\n    withCredentials, onLoad, onError, onAbort) {\n  const xhr = new XMLHttpRequest();\n\n  // open an XHR request to the data source file\n  xhr.open('GET', url, true);\n\n  if (isXhr2) {\n    try {\n      xhr.responseType = requestType;\n    }\n    catch (e) {\n      // Some browsers like Safari 6 do handle XHR2 but not the json\n      // response type, doing only a try/catch fails in IE9\n    }\n  }\n\n  xhr.onload = onLoad;\n  xhr.onerror = onError;\n\n  if (isXhr2 && withCredentials) {\n    xhr.withCredentials = true;\n  }\n\n  xhr.addEventListener('abort', onAbort);\n\n  return xhr;\n};\n\nexport default WaveformBuilder;\n","/**\n * @file\n *\n * Defines the {@link Peaks} class.\n *\n * @module main\n */\n\nimport EventEmitter from 'eventemitter3';\nimport CueEmitter from './cue-emitter';\nimport WaveformPoints from './waveform-points';\nimport WaveformSegments from './waveform-segments';\nimport KeyboardHandler from './keyboard-handler';\nimport MediaElementPlayer from './mediaelement-player';\nimport Player from './player';\nimport { createPointMarker, createSegmentMarker, createSegmentLabel } from './marker-factories';\nimport Scrollbar from './scrollbar';\nimport ViewController from './view-controller';\nimport ZoomController from './zoom-controller';\nimport WaveformBuilder from './waveform-builder';\nimport {\n  isHTMLElement, isFunction, isInAscendingOrder, isObject,\n  objectHasProperty,\n  extend\n} from './utils';\n\n/**\n * Initialises a new Peaks instance with default option settings.\n *\n * @class\n * @alias Peaks\n *\n * @param {Object} opts Configuration options\n */\n\nfunction Peaks() {\n  EventEmitter.call(this);\n\n  // Set default options\n  this.options = {\n    zoomLevels:              [512, 1024, 2048, 4096],\n    waveformCache:           true,\n\n    mediaElement:            null,\n    mediaUrl:                null,\n\n    dataUri:                 null,\n    dataUriDefaultFormat:    'json',\n    withCredentials:         false,\n\n    waveformData:            null,\n    webAudio:                null,\n\n    nudgeIncrement:          1.0,\n\n    pointMarkerColor:        '#39cccc',\n\n    createSegmentMarker:     createSegmentMarker,\n    createSegmentLabel:      createSegmentLabel,\n    createPointMarker:       createPointMarker,\n\n    // eslint-disable-next-line no-console\n    logger:                  console.error.bind(console)\n  };\n\n  return this;\n}\n\nPeaks.prototype = Object.create(EventEmitter.prototype);\n\nconst defaultViewOptions = {\n  playheadColor:       '#111111',\n  playheadTextColor:   '#aaaaaa',\n  axisGridlineColor:   '#cccccc',\n  showAxisLabels:      true,\n  axisLabelColor:      '#aaaaaa',\n  fontFamily:          'sans-serif',\n  fontSize:            11,\n  fontStyle:           'normal',\n  timeLabelPrecision:  2\n};\n\nconst defaultZoomviewOptions = {\n  // showPlayheadTime:    true,\n  playheadClickTolerance: 3,\n  waveformColor:          'rgba(0, 225, 128, 1)',\n  wheelMode:              'none'\n  // zoomAdapter:         'static'\n};\n\nconst defaultOverviewOptions = {\n  // showPlayheadTime:    false,\n  waveformColor:          'rgba(0, 0, 0, 0.2)',\n  highlightColor:         '#aaaaaa',\n  highlightStrokeColor:   'transparent',\n  highlightOpacity:       0.3,\n  highlightOffset:        11,\n  highlightCornerRadius:  2\n};\n\nconst defaultSegmentOptions = {\n  overlay:                   false,\n  markers:                   true,\n  startMarkerColor:          '#aaaaaa',\n  endMarkerColor:            '#aaaaaa',\n  waveformColor:             '#0074d9',\n  overlayColor:              '#ff0000',\n  overlayOpacity:            0.3,\n  overlayBorderColor:        '#ff0000',\n  overlayBorderWidth:        2,\n  overlayCornerRadius:       5,\n  overlayOffset:             25,\n  overlayLabelAlign:         'left',\n  overlayLabelVerticalAlign: 'top',\n  overlayLabelPadding:       8,\n  overlayLabelColor:         '#000000',\n  overlayFontFamily:         'sans-serif',\n  overlayFontSize:           12,\n  overlayFontStyle:          'normal'\n};\n\nconst defaultScrollbarOptions = {\n  color: '#888888',\n  minWidth: 50\n};\n\nfunction getOverviewOptions(opts) {\n  const overviewOptions = {};\n\n  if (opts.overview && opts.overview.showPlayheadTime) {\n    overviewOptions.showPlayheadTime = opts.overview.showPlayheadTime;\n  }\n\n  const optNames = [\n    'container',\n    'waveformColor',\n    'playedWaveformColor',\n    'playheadColor',\n    'playheadTextColor',\n    'formatPlayheadTime',\n    'timeLabelPrecision',\n    'axisGridlineColor',\n    'showAxisLabels',\n    'axisLabelColor',\n    'formatAxisTime',\n    'fontFamily',\n    'fontSize',\n    'fontStyle',\n    'highlightColor',\n    'highlightStrokeColor',\n    'highlightOpacity',\n    'highlightCornerRadius',\n    'highlightOffset'\n  ];\n\n  optNames.forEach(function(optName) {\n    if (opts.overview && objectHasProperty(opts.overview, optName)) {\n      overviewOptions[optName] = opts.overview[optName];\n    }\n    else if (objectHasProperty(opts, optName)) {\n      overviewOptions[optName] = opts[optName];\n    }\n    else if (!objectHasProperty(overviewOptions, optName)) {\n      if (objectHasProperty(defaultOverviewOptions, optName)) {\n        overviewOptions[optName] = defaultOverviewOptions[optName];\n      }\n      else if (objectHasProperty(defaultViewOptions, optName)) {\n        overviewOptions[optName] = defaultViewOptions[optName];\n      }\n    }\n  });\n\n  return overviewOptions;\n}\n\nfunction getZoomviewOptions(opts) {\n  const zoomviewOptions = {};\n\n  if (opts.showPlayheadTime) {\n    zoomviewOptions.showPlayheadTime = opts.showPlayheadTime;\n  }\n  else if (opts.zoomview && opts.zoomview.showPlayheadTime) {\n    zoomviewOptions.showPlayheadTime = opts.zoomview.showPlayheadTime;\n  }\n\n  const optNames = [\n    'container',\n    'waveformColor',\n    'playedWaveformColor',\n    'playheadColor',\n    'playheadTextColor',\n    'formatPlayheadTime',\n    'playheadClickTolerance',\n    'timeLabelPrecision',\n    'axisGridlineColor',\n    'showAxisLabels',\n    'axisLabelColor',\n    'formatAxisTime',\n    'fontFamily',\n    'fontSize',\n    'fontStyle',\n    'wheelMode'\n  ];\n\n  optNames.forEach(function(optName) {\n    if (opts.zoomview && objectHasProperty(opts.zoomview, optName)) {\n      zoomviewOptions[optName] = opts.zoomview[optName];\n    }\n    else if (objectHasProperty(opts, optName)) {\n      zoomviewOptions[optName] = opts[optName];\n    }\n    else if (!objectHasProperty(zoomviewOptions, optName)) {\n      if (objectHasProperty(defaultZoomviewOptions, optName)) {\n        zoomviewOptions[optName] = defaultZoomviewOptions[optName];\n      }\n      else if (objectHasProperty(defaultViewOptions, optName)) {\n        zoomviewOptions[optName] = defaultViewOptions[optName];\n      }\n    }\n  });\n\n  return zoomviewOptions;\n}\n\nfunction getScrollbarOptions(opts) {\n  if (!objectHasProperty(opts, 'scrollbar')) {\n    return null;\n  }\n\n  const scrollbarOptions = {};\n\n  const optNames = [\n    'container',\n    'color',\n    'minWidth'\n  ];\n\n  optNames.forEach(function(optName) {\n    if (objectHasProperty(opts.scrollbar, optName)) {\n      scrollbarOptions[optName] = opts.scrollbar[optName];\n    }\n    else {\n      scrollbarOptions[optName] = defaultScrollbarOptions[optName];\n    }\n  });\n\n  return scrollbarOptions;\n}\n\nfunction extendOptions(to, from) {\n  for (const key in from) {\n    if (objectHasProperty(from, key) &&\n        objectHasProperty(to, key)) {\n      to[key] = from[key];\n    }\n  }\n\n  return to;\n}\n\nfunction addSegmentOptions(options, opts) {\n  options.segmentOptions = {};\n\n  extend(options.segmentOptions, defaultSegmentOptions);\n\n  if (opts.segmentOptions) {\n    extendOptions(options.segmentOptions, opts.segmentOptions);\n  }\n\n  options.zoomview.segmentOptions = {};\n  extend(options.zoomview.segmentOptions, options.segmentOptions);\n\n  if (opts.zoomview && opts.zoomview.segmentOptions) {\n    extendOptions(options.zoomview.segmentOptions, opts.zoomview.segmentOptions);\n  }\n\n  options.overview.segmentOptions = {};\n  extend(options.overview.segmentOptions, options.segmentOptions);\n\n  if (opts.overview && opts.overview.segmentOptions) {\n    extendOptions(options.overview.segmentOptions, opts.overview.segmentOptions);\n  }\n}\n\nfunction checkContainerElements(options) {\n  const zoomviewContainer = options.zoomview.container;\n  const overviewContainer = options.overview.container;\n\n  if (!isHTMLElement(zoomviewContainer) &&\n      !isHTMLElement(overviewContainer)) {\n    // eslint-disable-next-line max-len\n    return new TypeError('Peaks.init(): The zoomview and/or overview container options must be valid HTML elements');\n  }\n\n  if (zoomviewContainer &&\n      (zoomviewContainer.clientWidth  <= 0 ||\n       zoomviewContainer.clientHeight <= 0)) {\n    // eslint-disable-next-line max-len\n    return new Error('Peaks.init(): Please ensure that the zoomview container is visible and has non-zero width and height');\n  }\n\n  if (overviewContainer &&\n      (overviewContainer.clientWidth  <= 0 ||\n       overviewContainer.clientHeight <= 0)) {\n    // eslint-disable-next-line max-len\n    return new Error('Peaks.init(): Please ensure that the overview container is visible and has non-zero width and height');\n  }\n}\n\n/**\n * Creates and initialises a new Peaks instance with the given options.\n *\n * @param {Object} opts Configuration options\n *\n * @return {Peaks}\n */\n\nPeaks.init = function(opts, callback) {\n  const instance = new Peaks();\n\n  let err = instance._setOptions(opts);\n\n  if (err) {\n    callback(err);\n    return;\n  }\n\n  err = checkContainerElements(instance.options);\n\n  if (err) {\n    callback(err);\n    return;\n  }\n\n  let scrollbarContainer = null;\n\n  if (instance.options.scrollbar) {\n    scrollbarContainer = instance.options.scrollbar.container;\n\n    if (!isHTMLElement(scrollbarContainer)) {\n      // eslint-disable-next-line max-len\n      callback(new TypeError('Peaks.init(): The scrollbar container option must be a valid HTML element'));\n      return;\n    }\n\n    if (scrollbarContainer.clientWidth <= 0) {\n      // eslint-disable-next-line max-len\n      callback(new TypeError('Peaks.init(): Please ensure that the scrollbar container is visible and has non-zero width'));\n      return;\n    }\n  }\n\n  if (opts.keyboard) {\n    instance._keyboardHandler = new KeyboardHandler(instance);\n  }\n\n  const player = opts.player ?\n    opts.player :\n    new MediaElementPlayer(instance.options.mediaElement);\n\n  instance.player = new Player(instance, player);\n  instance.segments = new WaveformSegments(instance);\n  instance.points = new WaveformPoints(instance);\n  instance.zoom = new ZoomController(instance, instance.options.zoomLevels);\n  instance.views = new ViewController(instance);\n\n  // Setup the UI components\n  instance._waveformBuilder = new WaveformBuilder(instance);\n\n  instance.player.init(instance)\n    .then(function() {\n      instance._waveformBuilder.init(instance.options, function(err, waveformData) {\n        if (err) {\n          if (callback) {\n            callback(err);\n          }\n\n          return;\n        }\n\n        err = checkContainerElements(instance.options);\n\n        if (err) {\n          if (callback) {\n            callback(err);\n          }\n\n          return;\n        }\n\n        instance._waveformBuilder = null;\n        instance._waveformData = waveformData;\n\n        const zoomviewContainer = instance.options.zoomview.container;\n        const overviewContainer = instance.options.overview.container;\n\n        if (overviewContainer) {\n          instance.views.createOverview(overviewContainer);\n        }\n\n        if (zoomviewContainer) {\n          instance.views.createZoomview(zoomviewContainer);\n        }\n\n        if (scrollbarContainer) {\n          instance.createScrollbar(scrollbarContainer);\n        }\n\n        instance._addWindowResizeHandler();\n\n        if (opts.segments) {\n          instance.segments.add(opts.segments);\n        }\n\n        if (opts.points) {\n          instance.points.add(opts.points);\n        }\n\n        if (opts.emitCueEvents) {\n          instance._cueEmitter = new CueEmitter(instance);\n        }\n\n        // Allow applications to attach event handlers before emitting events,\n        // when initialising with local waveform data.\n\n        setTimeout(function() {\n          instance.emit('peaks.ready');\n        }, 0);\n\n        callback(null, instance);\n      });\n    })\n    .catch(function(err) {\n      if (callback) {\n        callback(err);\n      }\n    });\n\n  return instance;\n};\n\nPeaks.prototype._setOptions = function(opts) {\n  if (!isObject(opts)) {\n    return new TypeError('Peaks.init(): The options parameter should be an object');\n  }\n\n  if (!opts.player) {\n    if (!opts.mediaElement) {\n      return new Error('Peaks.init(): Missing mediaElement option');\n    }\n\n    if (!(opts.mediaElement instanceof HTMLMediaElement)) {\n      // eslint-disable-next-line max-len\n      return new TypeError('Peaks.init(): The mediaElement option should be an HTMLMediaElement');\n    }\n  }\n\n  if (opts.logger && !isFunction(opts.logger)) {\n    // eslint-disable-next-line max-len\n    return new TypeError('Peaks.init(): The logger option should be a function');\n  }\n\n  if (opts.segments && !Array.isArray(opts.segments)) {\n    // eslint-disable-next-line max-len\n    return new TypeError('Peaks.init(): options.segments must be an array of segment objects');\n  }\n\n  if (opts.points && !Array.isArray(opts.points)) {\n    // eslint-disable-next-line max-len\n    return new TypeError('Peaks.init(): options.points must be an array of point objects');\n  }\n\n  extendOptions(this.options, opts);\n\n  this.options.overview = getOverviewOptions(opts);\n  this.options.zoomview = getZoomviewOptions(opts);\n  this.options.scrollbar = getScrollbarOptions(opts);\n\n  addSegmentOptions(this.options, opts);\n\n  if (!Array.isArray(this.options.zoomLevels)) {\n    return new TypeError('Peaks.init(): The zoomLevels option should be an array');\n  }\n  else if (this.options.zoomLevels.length === 0) {\n    return new Error('Peaks.init(): The zoomLevels array must not be empty');\n  }\n  else {\n    if (!isInAscendingOrder(this.options.zoomLevels)) {\n      return new Error('Peaks.init(): The zoomLevels array must be sorted in ascending order');\n    }\n  }\n\n  this._logger = this.options.logger;\n};\n\n/**\n * Remote waveform data options for [Peaks.setSource]{@link Peaks#setSource}.\n *\n * @typedef {Object} RemoteWaveformDataOptions\n * @global\n * @property {String=} arraybuffer\n * @property {String=} json\n */\n\n/**\n * Local waveform data options for [Peaks.setSource]{@link Peaks#setSource}.\n *\n * @typedef {Object} LocalWaveformDataOptions\n * @global\n * @property {ArrayBuffer=} arraybuffer\n * @property {Object=} json\n */\n\n/**\n * Web Audio options for [Peaks.setSource]{@link Peaks#setSource}.\n *\n * @typedef {Object} WebAudioOptions\n * @global\n * @property {AudioContext=} audioContext\n * @property {AudioBuffer=} audioBuffer\n * @property {Number=} scale\n * @property {Boolean=} multiChannel\n */\n\n/**\n * Options for [Peaks.setSource]{@link Peaks#setSource}.\n *\n * @typedef {Object} PeaksSetSourceOptions\n * @global\n * @property {String=} mediaUrl\n * @property {RemoteWaveformDataOptions=} dataUri\n * @property {LocalWaveformDataOptions=} waveformData\n * @property {WebAudioOptions=} webAudio\n * @property {Boolean=} withCredentials\n * @property {Array<Number>=} zoomLevels\n */\n\n/**\n * Changes the audio or video media source associated with the {@link Peaks}\n * instance.\n *\n * @see SetSourceHandler\n *\n * @param {PeaksSetSourceOptions} options\n * @param {Function} callback\n */\n\nPeaks.prototype.setSource = function(options, callback) {\n  const self = this;\n\n  self.player._setSource(options)\n    .then(function() {\n      if (!options.zoomLevels) {\n        options.zoomLevels = self.options.zoomLevels;\n      }\n\n      self._waveformBuilder = new WaveformBuilder(self);\n\n      self._waveformBuilder.init(options, function(err, waveformData) {\n        if (err) {\n          callback(err);\n          return;\n        }\n\n        self._waveformBuilder = null;\n        self._waveformData = waveformData;\n\n        ['overview', 'zoomview'].forEach(function(viewName) {\n          const view = self.views.getView(viewName);\n\n          if (view) {\n            view.setWaveformData(waveformData);\n          }\n        });\n\n        self.zoom.setZoomLevels(options.zoomLevels);\n\n        callback();\n      });\n    })\n    .catch(function(err) {\n      callback(err);\n    });\n};\n\nPeaks.prototype.getWaveformData = function() {\n  return this._waveformData;\n};\n\nPeaks.prototype.createScrollbar = function(container) {\n  const waveformData = this.getWaveformData();\n\n  this._scrollbar = new Scrollbar(\n    waveformData,\n    container,\n    this\n  );\n\n  return this._scrollbar;\n};\n\nPeaks.prototype._addWindowResizeHandler = function() {\n  this._onResize = this._onResize.bind(this);\n  window.addEventListener('resize', this._onResize);\n};\n\nPeaks.prototype._onResize = function() {\n  this.emit('window_resize');\n};\n\nPeaks.prototype._removeWindowResizeHandler = function() {\n  window.removeEventListener('resize', this._onResize);\n};\n\n/**\n * Cleans up a Peaks instance after use.\n */\n\nPeaks.prototype.destroy = function() {\n  this._removeWindowResizeHandler();\n\n  if (this._waveformBuilder) {\n    this._waveformBuilder.abort();\n  }\n\n  if (this._keyboardHandler) {\n    this._keyboardHandler.destroy();\n  }\n\n  if (this.views) {\n    this.views.destroy();\n  }\n\n  if (this._scrollbar) {\n    this._scrollbar.destroy();\n    this._scrollbar = null;\n  }\n\n  if (this.player) {\n    this.player.destroy();\n  }\n\n  if (this._cueEmitter) {\n    this._cueEmitter.destroy();\n  }\n};\n\nexport default Peaks;\n"],"names":["has","Object","prototype","hasOwnProperty","prefix","Events","create","__proto__","EE","fn","context","once","addListener","emitter","event","TypeError","listener","evt","_events","_eventsCount","push","clearEvent","EventEmitter","eventNames","names","events","name","call","slice","getOwnPropertySymbols","concat","listeners","handlers","i","l","length","ee","Array","listenerCount","emit","a1","a2","a3","a4","a5","len","arguments","args","removeListener","undefined","apply","j","on","removeAllListeners","off","prefixed","module","exports","Cue","time","type","id","POINT","SEGMENT_START","SEGMENT_END","sorter","a","b","zeroPad","number","precision","toString","formatTime","result","fractionSeconds","Math","floor","pow","seconds","minutes","hours","join","roundUpToNearest","value","multiple","multiplier","roundedUp","ceil","clamp","min","max","objectHasProperty","object","field","extend","to","from","key","isInAscendingOrder","array","isNumber","isFinite","Infinity","isValidTime","Number","isObject","_typeof","isArray","isString","isArrayBuffer","includes","isNullOrUndefined","isFunction","isBoolean","isHTMLElement","HTMLElement","isLinearGradientColor","linearGradientStart","linearGradientEnd","linearGradientColorStops","getMarkerObject","obj","parent","Konva","Layer","isHeadless","test","navigator","userAgent","windowIsVisible","webdriver","document","visibilityState","requestAnimationFrame","window","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame","cancelAnimationFrame","mozCancelAnimationFrame","webkitCancelAnimationFrame","msCancelAnimationFrame","eventTypes","forward","reverse","EVENT_TYPE_POINT","EVENT_TYPE_SEGMENT_ENTER","EVENT_TYPE_SEGMENT_EXIT","getPointOrSegment","peaks","cue","points","getPoint","segments","getSegment","Error","CueEmitter","_cues","_peaks","_previousTime","_updateCues","bind","_onPlaying","onPlaying","_onSeeked","onSeeked","_onTimeUpdate","onTimeUpdate","_onAnimationFrame","onAnimationFrame","_rAFHandle","_activeSegments","_attachEventHandlers","self","getPoints","getSegments","forEach","point","segment","startTime","endTime","sort","player","getCurrentTime","_updateActiveSegments","_onUpdate","previousTime","isForward","start","end","step","marker","eventType","isPlaying","isSeeking","getSegmentIdComparator","compareSegmentIds","activeSegments","getSegmentsAtTime","find","_detachEventHandlers","destroy","pointOptions","invalidOptions","setDefaultPointOptions","options","labelText","editable","validatePointOptions","updating","RangeError","color","Point","_setUserData","indexOf","defineProperties","enumerable","get","_id","_time","_labelText","_color","_editable","update","isVisible","_setTime","WaveformPoints","_points","_pointsById","_pointIdCounter","_getNextPointId","_addPoint","_createPoint","filter","add","arrayArgs","map","_findPoint","predicate","indexes","_removeIndexes","removed","index","itemRemoved","splice","_removePoints","remove","p","removeById","pointId","removeByTime","removeAll","segmentOptions","setDefaultSegmentOptions","globalSegmentOptions","overlay","overlayColor","waveformColor","borderColor","overlayBorderColor","validateSegmentOptions","Segment","_startTime","_endTime","_borderColor","_setStartTime","_setEndTime","WaveformSegments","_segments","_segmentsById","_segmentIdCounter","_getNextSegmentId","_addSegment","_createSegment","_getSortedSegments","findPreviousSegment","sortedSegments","findIndex","s","findNextSegment","_findSegment","_removeSegments","segmentId","nodes","SPACE","TAB","LEFT_ARROW","RIGHT_ARROW","keys","KeyboardHandler","eventEmitter","_handleKeyEvent","addEventListener","handleKeyEvent","target","nodeName","preventDefault","keyCode","shiftKey","removeEventListener","mediaElementHasSource","mediaElement","src","querySelector","MediaElementPlayer","_mediaElement","_addMediaListener","callback","_listeners","init","_eventEmitter","_duration","getDuration","error","_interval","Promise","resolve","reject","eventHandler","readyState","HTMLMediaElement","HAVE_NOTHING","load","play","pause","paused","seeking","currentTime","duration","seek","SetSourceHandler","_playerCanPlayHandler","_playerErrorHandler","setSource","_options","_callback","_resolve","_reject","setAttribute","mediaUrl","_reset","err","setSourceHandler","getAllPropertiesFrom","adapter","allProperties","getOwnPropertyNames","getPrototypeOf","validateAdapter","publicAdapterMethods","method","Player","_playingSegment","_segment","_loop","_playSegmentTimerCallback","_adapter","_logger","playSegment","loop","_setSource","DefaultPointMarker","group","handleWidth","handleHeight","handleX","view","_label","Text","x","y","text","textAlign","fontFamily","fontSize","fontStyle","fill","draggable","_handle","Rect","width","height","_line","Line","stroke","strokeWidth","layer","hide","fitToView","bindEventHandlers","setX","getWidth","show","getHeight","timeUpdated","setText","DefaultSegmentMarker","_this","startMarker","xPosition","handleLineColor","handleColor","_handleLineOne","_handleLineTwo","_handleLineSingle","visible","setTimeout","focusedSegmentShape","segmentShapes","_segmentShapes","_i","_Object$entries","entries","_Object$entries$_i","_slicedToArray","_endMarker","segmentShapeWidth","_overlay","markerInfo","getMarkerInfo","updateMarkersSmall","body","style","cursor","draw","endMarkerHandleLineSingle","startMarkerHandleLineSingle","newHandleWidth","endMarker","attrs","endMarkerHandleLines","line","startMarkerHandleLines","segmentShape","_startMarker","_marker","endMarkerGroupChildren","_group","children","startMarkerGroupChildren","child","_i2","_Object$entries2","_Object$entries2$_i","startHandleX","endHandleX","createSegmentMarker","createSegmentLabel","createPointMarker","Scrollbar","waveformData","container","_waveformData","_container","scrollbar","_zoomview","views","getView","_dragBoundFunc","_onScrollboxDragStart","_onScrollboxDragMove","_onScrollboxDragEnd","_onZoomviewDisplaying","_onScrollbarClick","_onWindowResize","_width","clientWidth","_height","_stage","Stage","_layer","_scrollboxX","_minScrollboxWidth","minWidth","_offsetY","_scrollbox","Group","dragBoundFunc","_scrollboxRect","cornerRadius","_setScrollboxWidth","_scrollboxWidth","pixelsToTime","_getScrollbarRange","pos","_dragging","range","_updateWaveform","_updateScrollbarWidthAndPosition","getStartTime","zoomviewRange","getPixelLength","scrollBoxPos","timeToPixels","layerX","offset","updateWaveform","fitToContainer","clientHeight","HighlightLayer","_view","_offset","highlightOffset","highlightColor","listening","_highlightRect","_strokeColor","highlightStrokeColor","_opacity","highlightOpacity","_cornerRadius","highlightCornerRadius","addToStage","stage","showHighlight","_createHighlightRect","_update","startOffset","endOffset","setAttrs","opacity","removeHighlight","updateHighlight","MouseDragHandler","_handlers","_mouseDown","_mouseUp","_mouseMove","_lastMouseClientX","button","touches","clientX","onMouseDown","mouseDownPosX","_getMousePosX","capture","passive","changedTouches","onMouseMove","mousePosX","cancelable","onMouseUp","containerPos","getContainer","getBoundingClientRect","left","isDragging","PlayheadLayer","_player","_playheadPixel","_playheadLineAnimation","_playheadVisible","_playheadColor","playheadColor","_playheadTextColor","playheadTextColor","_playheadFontFamily","playheadFontFamily","_playheadFontSize","playheadFontSize","_playheadFontStyle","playheadFontStyle","_playheadLayer","_createPlayhead","showPlayheadTime","_createPlayheadText","zoomLevelChanged","pixelsPerSecond","_useAnimation","_start","stop","_playheadLine","_playheadText","_playheadGroup","align","updatePlayheadTime","_syncPlayhead","pixelIndex","frameOffset","getFrameOffset","playheadX","playheadTextWidth","getTextWidth","playheadPosChanged","lastPlayheadPosition","Animation","playheadPosition","getPlayheadOffset","getPlayheadPixel","updatePlayheadText","PointMarker","_point","_draggable","_onDragStart","onDragStart","_onDragMove","onDragMove","_onDragEnd","onDragEnd","_onMouseEnter","onMouseEnter","_onMouseLeave","onMouseLeave","_bindDefaultEventHandlers","addToLayer","getX","getAbsolutePosition","destroyChildren","defaultFontFamily","defaultFontSize","defaultFontShape","PointsLayer","allowEditing","_allowEditing","_pointMarkers","_onPointsDrag","_onPointMarkerDragStart","_onPointMarkerDragMove","_onPointMarkerDragEnd","_pointMarkerDragBoundFunc","_onPointMarkerMouseEnter","_onPointMarkerMouseLeave","_onPointsUpdate","_onPointsAdd","_onPointsRemove","_onPointsRemoveAll","enableEditing","enable","frameStartTime","frameEndTime","getEndTime","pointMarker","_removePoint","_updatePoint","pointMarkerOffset","pointMarkerX","removeChildren","_createPointMarker","pointMarkerColor","getName","_addPointMarker","markerX","pixelOffsetToTime","_dragPointMarker","updatePoints","_removeInvisiblePoints","_findOrAddPointMarker","setVisible","OverlaySegmentMarker","viewHeight","overlayOffset","overlayRectHeight","SegmentMarker","_segmentShape","moveToTop","isStartMarker","WaveformShape","shapeOptions","startY","endY","fillLinearGradientStartPointY","fillLinearGradientEndPointY","fillLinearGradientColorStops","_shape","Shape","sceneFunc","_sceneFunc","setSegment","setWaveformColor","_drawWaveform","getWaveformData","startPixels","endPixels","limit","channels","waveformTop","waveformHeight","_drawChannel","channel","top","amplitude","amplitudeScale","getAmplitudeScale","lineX","lineY","beginPath","min_sample","scaleY","lineTo","max_sample","closePath","fillShape","handler","scale","SegmentShape","isSegmentDraggingEnabled","getViewOptions","_overlayOffset","_waveformShape","_onMouseDown","_onMouseUp","_onSegmentDragStart","_onSegmentDragMove","_onSegmentDragEnd","_onSegmentMarkerDragStart","_onSegmentMarkerDragMove","_onSegmentMarkerDragEnd","_segmentMarkerDragBoundFunc","segmentStartOffset","timeToPixelOffset","segmentEndOffset","clipX","clipY","clipWidth","clipHeight","overlayBorderWidth","overlayOpacity","overlayCornerRadius","_overlayRect","_overlayText","overlayFontFamily","overlayFontSize","overlayFontStyle","overlayLabelColor","overlayLabelAlign","verticalAlign","overlayLabelVerticalAlign","padding","overlayLabelPadding","_createMarkers","getStartMarker","getEndMarker","bordercolor","labelColor","createOverlayMarker","isEditingEnabled","markers","startMarkerColor","endMarkerColor","segmentClicked","eventName","_moveToTop","enableSegmentDragging","_setPreviousAndNextSegments","getSegmentDragMode","_nextSegment","_previousSegment","_dragStartX","_dragStartTime","_dragEndTime","offsetX","timeOffset","segmentDuration","dragMode","minSegmentWidth","getMinSegmentDragWidth","minSegmentDuration","previousSegmentUpdated","nextSegmentUpdated","previousSegmentEndX","previousSegmentEndTime","minPreviousSegmentEndTime","nextSegmentStartX","nextSegmentStartTime","maxNextSegmentStartTime","segmentMarker","_startMarkerX","_endMarkerX","_segmentStartMarkerDragMove","_segmentEndMarkerDragMove","startMarkerX","endMarkerX","upperLimit","lowerLimit","previousSegmentVisible","prevSegmentEndX","nextSegmentVisible","SegmentsLayer","_onSegmentsUpdate","_onSegmentsAdd","_onSegmentsRemove","_onSegmentsRemoveAll","_onSegmentsDragged","_removeSegment","_updateSegment","_addSegmentShape","_createSegmentShape","updateSegments","_removeInvisibleSegments","_findOrAddSegmentShape","WaveformAxis","_axisGridlineColor","axisGridlineColor","_axisLabelColor","axisLabelColor","_showAxisLabels","showAxisLabels","formatAxisTime","_formatAxisTime","_axisLabelFont","_buildFontString","_axisShape","_drawAxis","_getAxisLabelScale","baseSecs","steps","minSpacing","secs","pixels","currentFrameStartTime","markerHeight","axisLabelIntervalSecs","firstAxisLabelSecs","axisLabelOffsetSecs","axisLabelOffsetPixels","setAttr","moveTo","label","labelWidth","measureText","labelX","labelY","fillText","WaveformOverview","_originalWaveformData","_viewOptions","overview","_onPause","_amplitudeScale","_timeLabelPrecision","timeLabelPrecision","_enableSeek","formatPlayheadTime","_formatPlayheadTime","_data","resample","showWarnings","_resizeTimeoutId","_waveformColor","_playedWaveformColor","playedWaveformColor","_createWaveform","_segmentsLayer","_pointsLayer","_highlightLayer","_createAxisLabels","_createMouseDragHandler","_onClick","_onDblClick","_onContextMenu","_mouseDragHandler","_seek","_getDuration","enableSeek","_clickHandler","emitViewEvent","getAttr","preventViewEvent","clickEvent","clearTimeout","setWidth","setWaveformData","_playedWaveformShape","_playedSegment","_unplayedSegment","_waveformLayer","sample_rate","setAmplitudeScale","_createWaveformShapes","_destroyPlayedWaveformShape","_axisLayer","_axis","removeHighlightRect","playheadTime","setPlayedWaveformColor","setTimeLabelPrecision","enableMarkerEditing","setHeight","WaveformZoomView","zoomview","_enableWaveformCache","waveformCache","_initWaveformCache","_onKeyboardLeft","_onKeyboardRight","_onKeyboardShiftLeft","_onKeyboardShiftRight","_enableAutoScroll","_enableSegmentDragging","_segmentDragMode","_minSegmentDragWidth","_playheadClickTolerance","playheadClickTolerance","_pixelLength","initialZoomLevel","zoom","getZoomLevel","_zoomLevelAuto","_zoomLevelSeconds","_resampleData","_frameOffset","_onWheel","_onWheelCaptureVerticalScroll","setWheelMode","wheelMode","Map","set","_waveformScales","_seeking","playheadOffset","abs","_segmentIsDraggable","initialFrameOffset","mouseDownX","diff","newFrameOffset","mode","_wheelMode","captureVerticalScroll","_captureVerticalScroll","wheelEvent","delta","deltaY","deltaX","deltaMode","WheelEvent","DOM_DELTA_PAGE","setSegmentDragMode","_keyboardScroll","direction","large","increment","nudgeIncrement","scrollWaveform","_drawWaveformLayer","endThreshold","round","_getScale","isAutoScale","setZoom","apexTime","playheadOffsetPixels","prevScale","_scale","apexPixel","sourceWaveform","setStartTime","scrollAmount","playheadPixel","enableAutoScroll","setMinSegmentDragWidth","resampleOptions","ViewController","_overview","createOverview","createZoomview","destroyOverview","destroyZoomview","ZoomController","zoomLevels","_zoomLevels","_zoomLevelIndex","setZoomLevels","zoomIn","zoomOut","zoomLevelIndex","forceUpdate","getZoom","isXhr2","XMLHttpRequest","WaveformBuilder","dataUri","webAudio","audioContext","_getRemoteWaveformData","_buildWaveformFromLocalData","audioBuffer","_buildWaveformDataFromAudioBuffer","_buildWaveformDataUsingWebAudio","requestType","url","dataUriDefaultFormat","some","connector","toLowerCase","Boolean","_xhr","_createXHR","withCredentials","status","WaveformData","response","bits","send","data","json","arraybuffer","createdWaveformData","AudioContext","webkitAudioContext","webAudioOptions","mediaSourceUrl","currentSrc","_requestAudioAndBuildWaveformData","webAudioBuilderOptions","audio_buffer","split_channels","multiChannel","disable_worker","createFromAudio","audio_context","array_buffer","abort","onLoad","onError","onAbort","xhr","open","responseType","e","onload","onerror","Peaks","logger","console","defaultViewOptions","defaultZoomviewOptions","defaultOverviewOptions","defaultSegmentOptions","defaultScrollbarOptions","getOverviewOptions","opts","overviewOptions","optNames","optName","getZoomviewOptions","zoomviewOptions","getScrollbarOptions","scrollbarOptions","extendOptions","addSegmentOptions","checkContainerElements","zoomviewContainer","overviewContainer","instance","_setOptions","scrollbarContainer","keyboard","_keyboardHandler","_waveformBuilder","then","createScrollbar","_addWindowResizeHandler","emitCueEvents","_cueEmitter","catch","viewName","_scrollbar","_onResize","_removeWindowResizeHandler"],"mappings":"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"}